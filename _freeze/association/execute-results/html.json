{
  "hash": "437027347f93bec1697a737b6c156a4c",
  "result": {
    "engine": "knitr",
    "markdown": "# Association: Correlation and Contingency\n\n\n\n\n\n::: {.callout-important} \n## Incomplete\nYou are reading a work in progress. This page is a dumping ground for ideas. Sections maybe missing, or contain a list of points to include.\n:::\n\n\n\n\n## Overview\n\nno explanatory variables\n\n### Correlation\n\n-   two continuous variables\n\n-   neither is an explanatory variable, i.e., there is not a causal relationship\n    between the two variables\n    \n-   you want to know if there is a correlation between the two variables\n\n-   the correlation coefficient is a measure of the strength and direction of\n    the linear association between two variables and ranges from -1 to 1\n    \n-   A correlation coefficient of 1 indicates a perfect positive association \n    between the variables meaning the highest score in one variable are \n    associated with the *highest* scores in the other.\n\n-   A correlation coefficient of -1 indicates a perfect negative association \n    between the variables meaning the highest scores in one variable are \n    associated with the *lowest* scores in the other.\n    \nTODO Add a figure of the different correlation coefficients\n    \n-   we estimate the population correlation coefficient, $\\rho$ (pronounced rho), \n    with the sample correlation coefficient, $r$ and test whether it \n    is significantly different from zero because a correlation coefficient of\n    0 means association.\n\n-   Pearson's correlation coefficient, is a parametric measure which \n    assumes the variables are normally distributed and that any correlation\n    is linear.\n\n-   Spearman's rank correlation coefficient, is a non-parametric measure\n    which does not assume the variables are normally distributed\n    \n-   we use `cor.test()` in R.\n\n### Contingency Chi-squared\n\n-   two categorical variables\n\n-   neither is an explanatory variable, i.e., there is not a causal relationship\n    between the two variables\n    \n-   we count the number of observations in each caetory of each variable\n\n-   you want to know if there is an association between the two variables \n\n\n-   another way of describing this is that we test whether the proportion of \n    observations falling in to each category of one variable is the same for \n    each category of the other variable.\n    \n-   we use a chi-squared test to test whether the observed counts are significantly\n    different from the expected counts if there was no association between the \n    variables.    \n    \n### Reporting\n\n\n1.  the significance of effect - whether the association is significant\n    different from zero\n\n2.  the direction of effect\n    \n    -   correlation whether $r$ is positive or negative\n    -   which categories have higher than expected values\n\n3.  the magnitude of effect\n\nWe do not put a line of best fit on a scatter plot accompanying a correlation \nbecause such a line implies a causal relationship. \n\n\n\nWe will explore all of these ideas with an examples.\n\n## ðŸŽ¬ Your turn!\n\nIf you want to code along you will need to start a new [RStudio\nproject](workflow_rstudio.html#rstudio-projects), add a `data-raw`\nfolder and open a new script. You will also need to load the\n**`tidyverse`** package [@tidyverse].\n\n## Correlation\n\nHigh quality images of the internal structure of wheat seeds were taken with a \nsoft X-ray technique. Seven measurements determined from the images:\n\n-   Area\n-   Perimeter\n-   Compactness\n-   Kernel length\n-   Kernel width\n-   Asymmetry coefficient\n-   Length of kernel groove\n\nResearch were interested in the correlation between compactness and\nkernel width\n\nThe data are in [seeds-dataset.xlsx](data-raw/seeds-dataset.xlsx).\n\n### Import and explore\n\nThe data are in an excel file so we will need the **`readxl`** [@readxl] package.\n\nLoad the package:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n:::\n\n\n\n\nFind out the names of the sheets in the excel file:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexcel_sheets(\"data-raw/seeds-dataset.xlsx\")\n## [1] \"seeds_dataset\"\n```\n:::\n\n\n\nThere is only one sheet called `seeds_dataset`. \n\nImport the data:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseeds <- read_excel(\"data-raw/seeds-dataset.xlsx\",\n                    sheet = \"seeds_dataset\")\n```\n:::\n\n\n\n\n\nNote that we could have omitted the `sheet` argument because there is only one \nsheet in the Excel file. However, it is good practice to be explicit. \n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; \"><table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> area </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> perimeter </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> compactness </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> kernal_length </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> kernel_width </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> asymmetry_coef </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> groove_length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 15.26 </td>\n   <td style=\"text-align:right;\"> 14.84 </td>\n   <td style=\"text-align:right;\"> 0.8710 </td>\n   <td style=\"text-align:right;\"> 5.763 </td>\n   <td style=\"text-align:right;\"> 3.312 </td>\n   <td style=\"text-align:right;\"> 2.2210 </td>\n   <td style=\"text-align:right;\"> 5.220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.88 </td>\n   <td style=\"text-align:right;\"> 14.57 </td>\n   <td style=\"text-align:right;\"> 0.8811 </td>\n   <td style=\"text-align:right;\"> 5.554 </td>\n   <td style=\"text-align:right;\"> 3.333 </td>\n   <td style=\"text-align:right;\"> 1.0180 </td>\n   <td style=\"text-align:right;\"> 4.956 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.29 </td>\n   <td style=\"text-align:right;\"> 14.09 </td>\n   <td style=\"text-align:right;\"> 0.9050 </td>\n   <td style=\"text-align:right;\"> 5.291 </td>\n   <td style=\"text-align:right;\"> 3.337 </td>\n   <td style=\"text-align:right;\"> 2.6990 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.84 </td>\n   <td style=\"text-align:right;\"> 13.94 </td>\n   <td style=\"text-align:right;\"> 0.8955 </td>\n   <td style=\"text-align:right;\"> 5.324 </td>\n   <td style=\"text-align:right;\"> 3.379 </td>\n   <td style=\"text-align:right;\"> 2.2590 </td>\n   <td style=\"text-align:right;\"> 4.805 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.14 </td>\n   <td style=\"text-align:right;\"> 14.99 </td>\n   <td style=\"text-align:right;\"> 0.9034 </td>\n   <td style=\"text-align:right;\"> 5.658 </td>\n   <td style=\"text-align:right;\"> 3.562 </td>\n   <td style=\"text-align:right;\"> 1.3550 </td>\n   <td style=\"text-align:right;\"> 5.175 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.38 </td>\n   <td style=\"text-align:right;\"> 14.21 </td>\n   <td style=\"text-align:right;\"> 0.8951 </td>\n   <td style=\"text-align:right;\"> 5.386 </td>\n   <td style=\"text-align:right;\"> 3.312 </td>\n   <td style=\"text-align:right;\"> 2.4620 </td>\n   <td style=\"text-align:right;\"> 4.956 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.69 </td>\n   <td style=\"text-align:right;\"> 14.49 </td>\n   <td style=\"text-align:right;\"> 0.8799 </td>\n   <td style=\"text-align:right;\"> 5.563 </td>\n   <td style=\"text-align:right;\"> 3.259 </td>\n   <td style=\"text-align:right;\"> 3.5860 </td>\n   <td style=\"text-align:right;\"> 5.219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.10 </td>\n   <td style=\"text-align:right;\"> 0.8911 </td>\n   <td style=\"text-align:right;\"> 5.420 </td>\n   <td style=\"text-align:right;\"> 3.302 </td>\n   <td style=\"text-align:right;\"> 2.7000 </td>\n   <td style=\"text-align:right;\"> 5.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.63 </td>\n   <td style=\"text-align:right;\"> 15.46 </td>\n   <td style=\"text-align:right;\"> 0.8747 </td>\n   <td style=\"text-align:right;\"> 6.053 </td>\n   <td style=\"text-align:right;\"> 3.465 </td>\n   <td style=\"text-align:right;\"> 2.0400 </td>\n   <td style=\"text-align:right;\"> 5.877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.44 </td>\n   <td style=\"text-align:right;\"> 15.25 </td>\n   <td style=\"text-align:right;\"> 0.8880 </td>\n   <td style=\"text-align:right;\"> 5.884 </td>\n   <td style=\"text-align:right;\"> 3.505 </td>\n   <td style=\"text-align:right;\"> 1.9690 </td>\n   <td style=\"text-align:right;\"> 5.533 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.26 </td>\n   <td style=\"text-align:right;\"> 14.85 </td>\n   <td style=\"text-align:right;\"> 0.8696 </td>\n   <td style=\"text-align:right;\"> 5.714 </td>\n   <td style=\"text-align:right;\"> 3.242 </td>\n   <td style=\"text-align:right;\"> 4.5430 </td>\n   <td style=\"text-align:right;\"> 5.314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.03 </td>\n   <td style=\"text-align:right;\"> 14.16 </td>\n   <td style=\"text-align:right;\"> 0.8796 </td>\n   <td style=\"text-align:right;\"> 5.438 </td>\n   <td style=\"text-align:right;\"> 3.201 </td>\n   <td style=\"text-align:right;\"> 1.7170 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.89 </td>\n   <td style=\"text-align:right;\"> 14.02 </td>\n   <td style=\"text-align:right;\"> 0.8880 </td>\n   <td style=\"text-align:right;\"> 5.439 </td>\n   <td style=\"text-align:right;\"> 3.199 </td>\n   <td style=\"text-align:right;\"> 3.9860 </td>\n   <td style=\"text-align:right;\"> 4.738 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.78 </td>\n   <td style=\"text-align:right;\"> 14.06 </td>\n   <td style=\"text-align:right;\"> 0.8759 </td>\n   <td style=\"text-align:right;\"> 5.479 </td>\n   <td style=\"text-align:right;\"> 3.156 </td>\n   <td style=\"text-align:right;\"> 3.1360 </td>\n   <td style=\"text-align:right;\"> 4.872 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.74 </td>\n   <td style=\"text-align:right;\"> 14.05 </td>\n   <td style=\"text-align:right;\"> 0.8744 </td>\n   <td style=\"text-align:right;\"> 5.482 </td>\n   <td style=\"text-align:right;\"> 3.114 </td>\n   <td style=\"text-align:right;\"> 2.9320 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.59 </td>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 0.8993 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n   <td style=\"text-align:right;\"> 3.333 </td>\n   <td style=\"text-align:right;\"> 4.1850 </td>\n   <td style=\"text-align:right;\"> 4.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.99 </td>\n   <td style=\"text-align:right;\"> 13.83 </td>\n   <td style=\"text-align:right;\"> 0.9183 </td>\n   <td style=\"text-align:right;\"> 5.119 </td>\n   <td style=\"text-align:right;\"> 3.383 </td>\n   <td style=\"text-align:right;\"> 5.2340 </td>\n   <td style=\"text-align:right;\"> 4.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.69 </td>\n   <td style=\"text-align:right;\"> 14.75 </td>\n   <td style=\"text-align:right;\"> 0.9058 </td>\n   <td style=\"text-align:right;\"> 5.527 </td>\n   <td style=\"text-align:right;\"> 3.514 </td>\n   <td style=\"text-align:right;\"> 1.5990 </td>\n   <td style=\"text-align:right;\"> 5.046 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.70 </td>\n   <td style=\"text-align:right;\"> 14.21 </td>\n   <td style=\"text-align:right;\"> 0.9153 </td>\n   <td style=\"text-align:right;\"> 5.205 </td>\n   <td style=\"text-align:right;\"> 3.466 </td>\n   <td style=\"text-align:right;\"> 1.7670 </td>\n   <td style=\"text-align:right;\"> 4.649 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.72 </td>\n   <td style=\"text-align:right;\"> 13.57 </td>\n   <td style=\"text-align:right;\"> 0.8686 </td>\n   <td style=\"text-align:right;\"> 5.226 </td>\n   <td style=\"text-align:right;\"> 3.049 </td>\n   <td style=\"text-align:right;\"> 4.1020 </td>\n   <td style=\"text-align:right;\"> 4.914 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.16 </td>\n   <td style=\"text-align:right;\"> 14.40 </td>\n   <td style=\"text-align:right;\"> 0.8584 </td>\n   <td style=\"text-align:right;\"> 5.658 </td>\n   <td style=\"text-align:right;\"> 3.129 </td>\n   <td style=\"text-align:right;\"> 3.0720 </td>\n   <td style=\"text-align:right;\"> 5.176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.26 </td>\n   <td style=\"text-align:right;\"> 0.8722 </td>\n   <td style=\"text-align:right;\"> 5.520 </td>\n   <td style=\"text-align:right;\"> 3.168 </td>\n   <td style=\"text-align:right;\"> 2.6880 </td>\n   <td style=\"text-align:right;\"> 5.219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.88 </td>\n   <td style=\"text-align:right;\"> 14.90 </td>\n   <td style=\"text-align:right;\"> 0.8988 </td>\n   <td style=\"text-align:right;\"> 5.618 </td>\n   <td style=\"text-align:right;\"> 3.507 </td>\n   <td style=\"text-align:right;\"> 0.7651 </td>\n   <td style=\"text-align:right;\"> 5.091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.08 </td>\n   <td style=\"text-align:right;\"> 13.23 </td>\n   <td style=\"text-align:right;\"> 0.8664 </td>\n   <td style=\"text-align:right;\"> 5.099 </td>\n   <td style=\"text-align:right;\"> 2.936 </td>\n   <td style=\"text-align:right;\"> 1.4150 </td>\n   <td style=\"text-align:right;\"> 4.961 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.01 </td>\n   <td style=\"text-align:right;\"> 14.76 </td>\n   <td style=\"text-align:right;\"> 0.8657 </td>\n   <td style=\"text-align:right;\"> 5.789 </td>\n   <td style=\"text-align:right;\"> 3.245 </td>\n   <td style=\"text-align:right;\"> 1.7910 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.19 </td>\n   <td style=\"text-align:right;\"> 15.16 </td>\n   <td style=\"text-align:right;\"> 0.8849 </td>\n   <td style=\"text-align:right;\"> 5.833 </td>\n   <td style=\"text-align:right;\"> 3.421 </td>\n   <td style=\"text-align:right;\"> 0.9030 </td>\n   <td style=\"text-align:right;\"> 5.307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.02 </td>\n   <td style=\"text-align:right;\"> 13.76 </td>\n   <td style=\"text-align:right;\"> 0.8641 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 3.026 </td>\n   <td style=\"text-align:right;\"> 3.3730 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.74 </td>\n   <td style=\"text-align:right;\"> 13.67 </td>\n   <td style=\"text-align:right;\"> 0.8564 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 2.956 </td>\n   <td style=\"text-align:right;\"> 2.5040 </td>\n   <td style=\"text-align:right;\"> 4.869 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.18 </td>\n   <td style=\"text-align:right;\"> 0.8820 </td>\n   <td style=\"text-align:right;\"> 5.541 </td>\n   <td style=\"text-align:right;\"> 3.221 </td>\n   <td style=\"text-align:right;\"> 2.7540 </td>\n   <td style=\"text-align:right;\"> 5.038 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.45 </td>\n   <td style=\"text-align:right;\"> 14.02 </td>\n   <td style=\"text-align:right;\"> 0.8604 </td>\n   <td style=\"text-align:right;\"> 5.516 </td>\n   <td style=\"text-align:right;\"> 3.065 </td>\n   <td style=\"text-align:right;\"> 3.5310 </td>\n   <td style=\"text-align:right;\"> 5.097 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.16 </td>\n   <td style=\"text-align:right;\"> 13.82 </td>\n   <td style=\"text-align:right;\"> 0.8662 </td>\n   <td style=\"text-align:right;\"> 5.454 </td>\n   <td style=\"text-align:right;\"> 2.975 </td>\n   <td style=\"text-align:right;\"> 0.8551 </td>\n   <td style=\"text-align:right;\"> 5.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.49 </td>\n   <td style=\"text-align:right;\"> 14.94 </td>\n   <td style=\"text-align:right;\"> 0.8724 </td>\n   <td style=\"text-align:right;\"> 5.757 </td>\n   <td style=\"text-align:right;\"> 3.371 </td>\n   <td style=\"text-align:right;\"> 3.4120 </td>\n   <td style=\"text-align:right;\"> 5.228 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.09 </td>\n   <td style=\"text-align:right;\"> 14.41 </td>\n   <td style=\"text-align:right;\"> 0.8529 </td>\n   <td style=\"text-align:right;\"> 5.717 </td>\n   <td style=\"text-align:right;\"> 3.186 </td>\n   <td style=\"text-align:right;\"> 3.9200 </td>\n   <td style=\"text-align:right;\"> 5.299 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.94 </td>\n   <td style=\"text-align:right;\"> 14.17 </td>\n   <td style=\"text-align:right;\"> 0.8728 </td>\n   <td style=\"text-align:right;\"> 5.585 </td>\n   <td style=\"text-align:right;\"> 3.150 </td>\n   <td style=\"text-align:right;\"> 2.1240 </td>\n   <td style=\"text-align:right;\"> 5.012 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.05 </td>\n   <td style=\"text-align:right;\"> 14.68 </td>\n   <td style=\"text-align:right;\"> 0.8779 </td>\n   <td style=\"text-align:right;\"> 5.712 </td>\n   <td style=\"text-align:right;\"> 3.328 </td>\n   <td style=\"text-align:right;\"> 2.1290 </td>\n   <td style=\"text-align:right;\"> 5.360 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.12 </td>\n   <td style=\"text-align:right;\"> 15.00 </td>\n   <td style=\"text-align:right;\"> 0.9000 </td>\n   <td style=\"text-align:right;\"> 5.709 </td>\n   <td style=\"text-align:right;\"> 3.485 </td>\n   <td style=\"text-align:right;\"> 2.2700 </td>\n   <td style=\"text-align:right;\"> 5.443 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.20 </td>\n   <td style=\"text-align:right;\"> 15.27 </td>\n   <td style=\"text-align:right;\"> 0.8734 </td>\n   <td style=\"text-align:right;\"> 5.826 </td>\n   <td style=\"text-align:right;\"> 3.464 </td>\n   <td style=\"text-align:right;\"> 2.8230 </td>\n   <td style=\"text-align:right;\"> 5.527 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17.08 </td>\n   <td style=\"text-align:right;\"> 15.38 </td>\n   <td style=\"text-align:right;\"> 0.9079 </td>\n   <td style=\"text-align:right;\"> 5.832 </td>\n   <td style=\"text-align:right;\"> 3.683 </td>\n   <td style=\"text-align:right;\"> 2.9560 </td>\n   <td style=\"text-align:right;\"> 5.484 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.80 </td>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 0.8823 </td>\n   <td style=\"text-align:right;\"> 5.656 </td>\n   <td style=\"text-align:right;\"> 3.288 </td>\n   <td style=\"text-align:right;\"> 3.1120 </td>\n   <td style=\"text-align:right;\"> 5.309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 14.17 </td>\n   <td style=\"text-align:right;\"> 0.8944 </td>\n   <td style=\"text-align:right;\"> 5.397 </td>\n   <td style=\"text-align:right;\"> 3.298 </td>\n   <td style=\"text-align:right;\"> 6.6850 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.54 </td>\n   <td style=\"text-align:right;\"> 13.85 </td>\n   <td style=\"text-align:right;\"> 0.8871 </td>\n   <td style=\"text-align:right;\"> 5.348 </td>\n   <td style=\"text-align:right;\"> 3.156 </td>\n   <td style=\"text-align:right;\"> 2.5870 </td>\n   <td style=\"text-align:right;\"> 5.178 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.50 </td>\n   <td style=\"text-align:right;\"> 13.85 </td>\n   <td style=\"text-align:right;\"> 0.8852 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n   <td style=\"text-align:right;\"> 3.158 </td>\n   <td style=\"text-align:right;\"> 2.2490 </td>\n   <td style=\"text-align:right;\"> 5.176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.16 </td>\n   <td style=\"text-align:right;\"> 13.55 </td>\n   <td style=\"text-align:right;\"> 0.9009 </td>\n   <td style=\"text-align:right;\"> 5.138 </td>\n   <td style=\"text-align:right;\"> 3.201 </td>\n   <td style=\"text-align:right;\"> 2.4610 </td>\n   <td style=\"text-align:right;\"> 4.783 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.50 </td>\n   <td style=\"text-align:right;\"> 14.86 </td>\n   <td style=\"text-align:right;\"> 0.8820 </td>\n   <td style=\"text-align:right;\"> 5.877 </td>\n   <td style=\"text-align:right;\"> 3.396 </td>\n   <td style=\"text-align:right;\"> 4.7110 </td>\n   <td style=\"text-align:right;\"> 5.528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.11 </td>\n   <td style=\"text-align:right;\"> 14.54 </td>\n   <td style=\"text-align:right;\"> 0.8986 </td>\n   <td style=\"text-align:right;\"> 5.579 </td>\n   <td style=\"text-align:right;\"> 3.462 </td>\n   <td style=\"text-align:right;\"> 3.1280 </td>\n   <td style=\"text-align:right;\"> 5.180 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.80 </td>\n   <td style=\"text-align:right;\"> 14.04 </td>\n   <td style=\"text-align:right;\"> 0.8794 </td>\n   <td style=\"text-align:right;\"> 5.376 </td>\n   <td style=\"text-align:right;\"> 3.155 </td>\n   <td style=\"text-align:right;\"> 1.5600 </td>\n   <td style=\"text-align:right;\"> 4.961 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.36 </td>\n   <td style=\"text-align:right;\"> 14.76 </td>\n   <td style=\"text-align:right;\"> 0.8861 </td>\n   <td style=\"text-align:right;\"> 5.701 </td>\n   <td style=\"text-align:right;\"> 3.393 </td>\n   <td style=\"text-align:right;\"> 1.3670 </td>\n   <td style=\"text-align:right;\"> 5.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.99 </td>\n   <td style=\"text-align:right;\"> 14.56 </td>\n   <td style=\"text-align:right;\"> 0.8883 </td>\n   <td style=\"text-align:right;\"> 5.570 </td>\n   <td style=\"text-align:right;\"> 3.377 </td>\n   <td style=\"text-align:right;\"> 2.9580 </td>\n   <td style=\"text-align:right;\"> 5.175 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.79 </td>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 0.8819 </td>\n   <td style=\"text-align:right;\"> 5.545 </td>\n   <td style=\"text-align:right;\"> 3.291 </td>\n   <td style=\"text-align:right;\"> 2.7040 </td>\n   <td style=\"text-align:right;\"> 5.111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.86 </td>\n   <td style=\"text-align:right;\"> 14.67 </td>\n   <td style=\"text-align:right;\"> 0.8676 </td>\n   <td style=\"text-align:right;\"> 5.678 </td>\n   <td style=\"text-align:right;\"> 3.258 </td>\n   <td style=\"text-align:right;\"> 2.1290 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.43 </td>\n   <td style=\"text-align:right;\"> 14.40 </td>\n   <td style=\"text-align:right;\"> 0.8751 </td>\n   <td style=\"text-align:right;\"> 5.585 </td>\n   <td style=\"text-align:right;\"> 3.272 </td>\n   <td style=\"text-align:right;\"> 3.9750 </td>\n   <td style=\"text-align:right;\"> 5.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.78 </td>\n   <td style=\"text-align:right;\"> 14.91 </td>\n   <td style=\"text-align:right;\"> 0.8923 </td>\n   <td style=\"text-align:right;\"> 5.674 </td>\n   <td style=\"text-align:right;\"> 3.434 </td>\n   <td style=\"text-align:right;\"> 5.5930 </td>\n   <td style=\"text-align:right;\"> 5.136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.49 </td>\n   <td style=\"text-align:right;\"> 14.61 </td>\n   <td style=\"text-align:right;\"> 0.8538 </td>\n   <td style=\"text-align:right;\"> 5.715 </td>\n   <td style=\"text-align:right;\"> 3.113 </td>\n   <td style=\"text-align:right;\"> 4.1160 </td>\n   <td style=\"text-align:right;\"> 5.396 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.33 </td>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 0.8831 </td>\n   <td style=\"text-align:right;\"> 5.504 </td>\n   <td style=\"text-align:right;\"> 3.199 </td>\n   <td style=\"text-align:right;\"> 3.3280 </td>\n   <td style=\"text-align:right;\"> 5.224 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 14.60 </td>\n   <td style=\"text-align:right;\"> 0.8557 </td>\n   <td style=\"text-align:right;\"> 5.741 </td>\n   <td style=\"text-align:right;\"> 3.113 </td>\n   <td style=\"text-align:right;\"> 1.4810 </td>\n   <td style=\"text-align:right;\"> 5.487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.03 </td>\n   <td style=\"text-align:right;\"> 14.77 </td>\n   <td style=\"text-align:right;\"> 0.8658 </td>\n   <td style=\"text-align:right;\"> 5.702 </td>\n   <td style=\"text-align:right;\"> 3.212 </td>\n   <td style=\"text-align:right;\"> 1.9330 </td>\n   <td style=\"text-align:right;\"> 5.439 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.46 </td>\n   <td style=\"text-align:right;\"> 14.35 </td>\n   <td style=\"text-align:right;\"> 0.8818 </td>\n   <td style=\"text-align:right;\"> 5.388 </td>\n   <td style=\"text-align:right;\"> 3.377 </td>\n   <td style=\"text-align:right;\"> 2.8020 </td>\n   <td style=\"text-align:right;\"> 5.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.92 </td>\n   <td style=\"text-align:right;\"> 14.43 </td>\n   <td style=\"text-align:right;\"> 0.9006 </td>\n   <td style=\"text-align:right;\"> 5.384 </td>\n   <td style=\"text-align:right;\"> 3.412 </td>\n   <td style=\"text-align:right;\"> 1.1420 </td>\n   <td style=\"text-align:right;\"> 5.088 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.38 </td>\n   <td style=\"text-align:right;\"> 14.77 </td>\n   <td style=\"text-align:right;\"> 0.8857 </td>\n   <td style=\"text-align:right;\"> 5.662 </td>\n   <td style=\"text-align:right;\"> 3.419 </td>\n   <td style=\"text-align:right;\"> 1.9990 </td>\n   <td style=\"text-align:right;\"> 5.222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.11 </td>\n   <td style=\"text-align:right;\"> 13.47 </td>\n   <td style=\"text-align:right;\"> 0.8392 </td>\n   <td style=\"text-align:right;\"> 5.159 </td>\n   <td style=\"text-align:right;\"> 3.032 </td>\n   <td style=\"text-align:right;\"> 1.5020 </td>\n   <td style=\"text-align:right;\"> 4.519 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11.42 </td>\n   <td style=\"text-align:right;\"> 12.86 </td>\n   <td style=\"text-align:right;\"> 0.8683 </td>\n   <td style=\"text-align:right;\"> 5.008 </td>\n   <td style=\"text-align:right;\"> 2.850 </td>\n   <td style=\"text-align:right;\"> 2.7000 </td>\n   <td style=\"text-align:right;\"> 4.607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11.23 </td>\n   <td style=\"text-align:right;\"> 12.63 </td>\n   <td style=\"text-align:right;\"> 0.8840 </td>\n   <td style=\"text-align:right;\"> 4.902 </td>\n   <td style=\"text-align:right;\"> 2.879 </td>\n   <td style=\"text-align:right;\"> 2.2690 </td>\n   <td style=\"text-align:right;\"> 4.703 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.36 </td>\n   <td style=\"text-align:right;\"> 13.19 </td>\n   <td style=\"text-align:right;\"> 0.8923 </td>\n   <td style=\"text-align:right;\"> 5.076 </td>\n   <td style=\"text-align:right;\"> 3.042 </td>\n   <td style=\"text-align:right;\"> 3.2200 </td>\n   <td style=\"text-align:right;\"> 4.605 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.22 </td>\n   <td style=\"text-align:right;\"> 13.84 </td>\n   <td style=\"text-align:right;\"> 0.8680 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 3.070 </td>\n   <td style=\"text-align:right;\"> 4.1570 </td>\n   <td style=\"text-align:right;\"> 5.088 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.78 </td>\n   <td style=\"text-align:right;\"> 13.57 </td>\n   <td style=\"text-align:right;\"> 0.8716 </td>\n   <td style=\"text-align:right;\"> 5.262 </td>\n   <td style=\"text-align:right;\"> 3.026 </td>\n   <td style=\"text-align:right;\"> 1.1760 </td>\n   <td style=\"text-align:right;\"> 4.782 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.88 </td>\n   <td style=\"text-align:right;\"> 13.50 </td>\n   <td style=\"text-align:right;\"> 0.8879 </td>\n   <td style=\"text-align:right;\"> 5.139 </td>\n   <td style=\"text-align:right;\"> 3.119 </td>\n   <td style=\"text-align:right;\"> 2.3520 </td>\n   <td style=\"text-align:right;\"> 4.607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.34 </td>\n   <td style=\"text-align:right;\"> 14.37 </td>\n   <td style=\"text-align:right;\"> 0.8726 </td>\n   <td style=\"text-align:right;\"> 5.630 </td>\n   <td style=\"text-align:right;\"> 3.190 </td>\n   <td style=\"text-align:right;\"> 1.3130 </td>\n   <td style=\"text-align:right;\"> 5.150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.01 </td>\n   <td style=\"text-align:right;\"> 14.29 </td>\n   <td style=\"text-align:right;\"> 0.8625 </td>\n   <td style=\"text-align:right;\"> 5.609 </td>\n   <td style=\"text-align:right;\"> 3.158 </td>\n   <td style=\"text-align:right;\"> 2.2170 </td>\n   <td style=\"text-align:right;\"> 5.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.37 </td>\n   <td style=\"text-align:right;\"> 14.39 </td>\n   <td style=\"text-align:right;\"> 0.8726 </td>\n   <td style=\"text-align:right;\"> 5.569 </td>\n   <td style=\"text-align:right;\"> 3.153 </td>\n   <td style=\"text-align:right;\"> 1.4640 </td>\n   <td style=\"text-align:right;\"> 5.300 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.73 </td>\n   <td style=\"text-align:right;\"> 13.75 </td>\n   <td style=\"text-align:right;\"> 0.8458 </td>\n   <td style=\"text-align:right;\"> 5.412 </td>\n   <td style=\"text-align:right;\"> 2.882 </td>\n   <td style=\"text-align:right;\"> 3.5330 </td>\n   <td style=\"text-align:right;\"> 5.067 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n\n\nThese data are formatted usefully for analysis using correlation and plotting.\nEach row is a different seed and the columns are the variables we are interested. \nThis means that the first values in each column are related - they are all from \nthe same seed\n\nIn the first instance, it is sensible to create a rough plot of our data\n(See @fig-seeds-rough). Plotting data early helps us in multiple ways:\n\n-   it helps identify whether there extreme values\n-   it allows us to see if the association is roughly linear\n-   it tells us whether any association positive or negative\n\nScatter plots (`geom_point()`) are a good choice for exploratory\nplotting with data like these.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = seeds,\n       aes(x = compactness, y = kernel_width)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![A default scatter plot of compactness and kernel width in seeds demonstrates an approximately linear positive association them the variables.](association_files/figure-html/fig-seeds-rough-1.png){#fig-seeds-rough width=576}\n:::\n:::\n\n\n\n\nThe figure suggests that there is a positive correlation between `compactness` and\n`kernel_width` and that correlation is roughly linear.\n\n\n### Check assumptions\n\nWe can see from @fig-seeds-rough that the relationship between `compactness` and\n`kernel_width` is roughly linear. This is a good sign for using Pearson's\ncorrelation coefficient.\n\nOur next check is to use common sense: both variables are continuous and\nwe would expect them to be normally distributed. We can then plot histograms\nto examine the distributions (See @fig-hist).\n\n\n\n\n::: {#fig-hist .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nggplot(data = seeds, aes(x = compactness)) +\n  geom_histogram(bins = 12)\n\nggplot(data = seeds, aes(x = kernel_width)) +\n  geom_histogram(bins = 12)\n\n```\n\n::: {.cell-output-display}\n![Compactness](association_files/figure-html/fig-hist-1.png){#fig-hist-1 width=576}\n:::\n\n::: {.cell-output-display}\n![Kernel width](association_files/figure-html/fig-hist-2.png){#fig-hist-2 width=576}\n:::\n\nThe distributions of the two variables are slightly skewed but do not seem too different from a normal distribution. We will continue with the Pearson's correlation coefficient.\n:::\n\n\n\nThe distributions of the two variables are slightly skewed but do not seem too \ndifferent from a normal distribution. \n\nFinally, we can use the Shapiro-Wilk test to test for normality.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(seeds$compactness)\n## \n## \tShapiro-Wilk normality test\n## \n## data:  seeds$compactness\n## W = 0.99484, p-value = 0.9937\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(seeds$kernel_width)\n## \n## \tShapiro-Wilk normality test\n## \n## data:  seeds$kernel_width\n## W = 0.98989, p-value = 0.8486\n```\n:::\n\n\n\n\n\nThe *p*-values are greater than 0.05 so these tests of the normality\nassumption are not significant. Note that \"not significant\" means not\nsignificantly different from a normal distribution. It does not mean\ndefinitely normally distributed.\n\nIt is not unreasonable to continue with the Pearson's correlation coefficient. \nHowever, later we will also use the Spearman's rank correlation coefficient, a non-parametric method which has fewer assumptions. Spearman's rank correlation \nis a more conservative approach.\n\n\n### Do a Pearson's correlation test with `cor.test()`\n\nWe can carry out a Pearson's correlation test with `cor.test()`  like this:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(data = seeds, ~ compactness + kernel_width)\n## \n## \tPearson's product-moment correlation\n## \n## data:  compactness and kernel_width\n## t = 7.3738, df = 68, p-value = 2.998e-10\n## alternative hypothesis: true correlation is not equal to 0\n## 95 percent confidence interval:\n##  0.5117537 0.7794620\n## sample estimates:\n##       cor \n## 0.6665731\n```\n:::\n\n\n\n\nA variable is not being explained in this case so we do not need to include\na response variable. Pearsonâ€™s is the default test so we do not need to specify\nit.\n\nWhat do all these results mean?\n\nThe last line gives the correlation coefficient, $r$, that has been estimated \nfrom the data. Here, $r$ = 0.67 \nwhich is a moderate positive correlation.\n\nThe fifth line tells you what test has been done: \n`alternative hypothesis: true correlation is not equal to 0`. That is $H_0$ is \nthat $\\rho = 0$ \n\nThe forth line gives the test result:\n`t = 7.3738, df = 68, p-value = 2.998e-10`\n\nThe $p$-value is very much less than 0.05 so we can reject the null hypothesis \nand conclude there is a significant positive correlation between `compactness` \nand `kernel_width`.\n\n### Report\n\nThere was a significant positive correlation ($r$ = 0.67) between compactness and kernel width (Pearson's: *t* = 7.374; *df* = 68; *p*-value < 0.0001). See @fig-correlation-pears.\n\n\n::: {#fig-correlation-pears}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = seeds,\n       aes(x = compactness, y = kernel_width)) +\n  geom_point() +\n  scale_y_continuous(name = \"Diameter (mm)\") +\n    scale_x_continuous(name = \"Compactness\") +\n  annotate(\"text\", x = 0.85,  y = 3.6, \n           label = expression(italic(r)~\"= 0.67; \"~italic(p)~\"< 0.001\")) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](association_files/figure-html/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\n\n\n\n**Correlation between compactness and kernel width of wheat seeds**. High\nquality images of the internal structure of wheat seeds were taken with a \nsoft X-ray technique and the compactness and kernel width of the seeds were\ndetermined. There was a significant positive correlation ($r$ = 0.67) between compactness \nand kernel width (Pearson's: *t* = 7.374; *df* = 68; *p*-value < 0.0001). Note:\naxes do not start at 0. Data analysis was conducted in R [@R-core] with\ntidyverse packages [@tidyverse].\n\n:::\n\n### Spearman's rank correlation coefficient\n\nTODO\n\n\n\n## Contingency Chi-squared test\n\nResearchers were interested in whether different pig breeds had the same \nfood preferences. They offered individuals of three breads, Welsh, Tamworth \nand Essex a choice of three foods: cabbage, sugar beet and swede and recorded\nthe number of individuals that chose each food. The data are shown in @tbl-food-pref.\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {#tbl-food-pref .cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Food preferences of three pig breeds</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> welsh </th>\n   <th style=\"text-align:right;\"> tamworth </th>\n   <th style=\"text-align:right;\"> essex </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> cabbage </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sugarbeet </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> swede </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n\nWe donâ€™t know what proportion of food are expected to be preferred but do \nexpect it to be same for each breed if there is no association between breed\nand food preference. The null hypothesis is that the proportion of foods taken \nby each breed is the same.\n\nFor a contingency chi squared test, the inbuilt chi-squared test can be used \nbut we need to to structure our data as a 3 x 3 table. The `matrix()` function \nis useful here and we can label the rows and columns to help us interpret the \nresults.\n\nPut the data into a matrix:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create the data\nfood_pref <- matrix(c(11, 19, 22,\n                      21, 16, 8,\n                      7, 12, 11),\n                    nrow = 3,\n                    byrow = TRUE)\nfood_pref\n##      [,1] [,2] [,3]\n## [1,]   11   19   22\n## [2,]   21   16    8\n## [3,]    7   12   11\n```\n:::\n\n\n\n\nThe `byrow` and `nrow` arguments allow us to lay out the data in the matrix as \nwe need.\nTo name the rows and columns we can use the `dimnames()` function. We need\nto create a \"list\" object to hold the names of the rows and columns and then\nassign this to the matrix object. The names of rows are columns are called the \n\"dimension names\" in a matrix.\n\nMake a list for the two vectors of names:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \n\nvars <- list(food = c(\"cabbage\",\n                      \"sugarbeet\",\n                      \"swede\"),\n             breed = c(\"welsh\",\n                       \"tamworth\",\n                       \"essex\"))\n\n```\n:::\n\n\n\n\nThe vectors can be of different lengths in a list which would be important if \nwe had four breeds and only two foods, for example.\n\nNow assign the list to the dimension names in the matrix:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndimnames(food_pref) <- vars\n\nfood_pref\n##            breed\n## food        welsh tamworth essex\n##   cabbage      11       19    22\n##   sugarbeet    21       16     8\n##   swede         7       12    11\n```\n:::\n\n\n\n\nThe data are now in a form that can be used in the `chisq.test()` function:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(food_pref)\n## \n## \tPearson's Chi-squared test\n## \n## data:  food_pref\n## X-squared = 10.64, df = 4, p-value = 0.03092\n```\n:::\n\n\n\nThe test is significant since the *p*-value is less than 0.05. We have evidence \nof a preference for particular foods by different breeds. But in what way? We need to know the â€œdirection of the effectâ€ *i.e.,* Who likes what?\n\nThe `chisq.test()` function has a `residuals` argument that can be used to\ncalculate the residuals. These are the differences between the observed and\nexpected values. The expected values are the values that would be expected if\nthere was no association between the rows and columns. The residuals are\nstandardised.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(food_pref)$residuals\n##            breed\n## food             welsh    tamworth      essex\n##   cabbage   -1.2433504 -0.05564283  1.2722209\n##   sugarbeet  1.9317656 -0.16014783 -1.7125943\n##   swede     -0.7289731  0.26939742  0.4225344\n```\n:::\n\n\n\nWhere the residuals are positive, the observed value is greater than the\nexpected value and where they are negative, the observed value is less than the\nexpected value. Our results show the Welsh pigs much prefer sugarbeet and strongly\ndislike cabbage. The Essex pigs prefer cabbage and dislike sugarbeet and the \nEssex pigs slightly prefer swede but have less strong likes and dislikes.\n\n\nThe degrees of freedom are: (rows - 1)(cols - 1) = 2 * 2 = 4.\n\n\n### Report\n\nDifferent pig breeds showed a significant preference for the different \nfood types ($\\chi^2$ = 10.64; *df* = 4; *p* = 0.031) with Essex much preferring \ncabbage and disliking sugarbeet, Welsh showing a strong preference for \nsugarbeet and a dislike of cabbage and Tamworth showing no clear preference.\n\n\n\n## Summary\n\nTODO",
    "supporting": [
      "association_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}