{
  "hash": "aa41cbe3c4afcac6c80cd3466a880fca",
  "result": {
    "engine": "knitr",
    "markdown": "# Association: Correlation and Contingency\n\n\n\n\n\n::: {.callout-warning} \n## First draft\nYou are reading a work in progress. This page is a first draft but should be readable.\n:::\n\n\n\n\n## Overview\n\nUp to this point, we have focused on methods that examine how one\nvariable affects another. **Regression** allowed us to model a\nrelationship where one variable was explicitly treated as explanatory\nand the other as a response. Similarly, **ANOVA and two-sample tests**\ncompared groups to see if a categorical explanatory variable influenced\na numeric response.\n\nIn this chapter, we shift our focus to situations where **no causal\nrelationship is assumed**. Instead of asking whether one variable\npredicts another, we ask whether two variables are **associated** -\nwhether they tend to change together.\n\nWe will cover:\n\n-   **Pearson’s correlation**, which measures how strongly two\n    continuous variables change together in a linear way.\n-   **Spearman’s correlation**, a non-parametric alternative\n-   **Chi-square tests for contingency tables**, which assess whether\n    two categorical variables are related.\n\nUnlike regression, these methods do not imply that one variable\ninfluences the other - they simply measure the strength of an\nassociation. This allows us to explore patterns in data when no clear\nexplanatory-response relationship exists.\n\n### Correlation\n\nWhen working with two continuous variables, we may be interested in\nunderstanding how they are associated without assuming a\ncause-and-effect relationship. Unlike regression, where one variable is\ntreated as explanatory and the other as a response, correlation simply\nmeasures the strength and direction of their association.\n\nThe correlation coefficient quantifies this relationship on a scale from\n-1 to 1. A coefficient of 1 indicates a perfect positive association,\nmeaning that higher values in one variable are always linked to higher\nvalues in the other. Conversely, a coefficient of -1 represents a\nperfect negative association, where higher values in one variable are\nconsistently associated with lower values in the other. Most real-world\ncorrelations fall somewhere between these extremes, with values closer\nto 0 suggesting little to no linear relationship \n(@fig-correl-types).\n\nBy calculating the correlation coefficient, we can assess how strongly\ntwo variables move together, helping us uncover patterns in data without\nimplying causation.\n\n## Correlation Examples\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Scatter plots demonstrating different types of correlation. Left: A strong positive correlation (r ≈ 0.8), where higher values in one variable are associated with higher values in the other. Middle: A strong negative correlation (r ≈ -0.8), where higher values in one variable are associated with lower values in the other. Right: No correlation (r ≈ 0), indicating no clear pattern between the two variables.](association_files/figure-html/fig-correl-types-1.png){#fig-correl-types width=576}\n:::\n:::\n\n\n\n\nWe estimate the population correlation coefficient, $\\rho$ \n(pronounced rho), with the sample correlation coefficient, $r$ and \ntest whether it is significantly different from zero because a \ncorrelation coefficient of 0 means association.\n\nPearson's correlation coefficient, is a parametric measure which\nassumes the variables are normally distributed and that any\ncorrelation is linear.\n\nSpearman's rank correlation coefficient, is a non-parametric measure\nwhich does not assume the variables are normally distributed or a strict\nlinear association. It is also less sensitive to outliers.\n\nWe use `cor.test()` in R for both types of correlation.\n\n### Contingency Chi-squared\n\n-   two categorical variables\n\n-   neither is an explanatory variable, i.e., there is not a causal\n    relationship between the two variables\n\n-   we count the number of observations in each caetory of each variable\n\n-   you want to know if there is an association between the two\n    variables\n\n-   another way of describing this is that we test whether the\n    proportion of observations falling in to each category of one\n    variable is the same for each category of the other variable.\n\n-   we use a chi-squared test to test whether the observed counts are\n    significantly different from the expected counts if there was no\n    association between the variables.\n\n### Reporting\n\n1.  the significance of effect - whether the association is significant\n    different from zero\n\n2.  the direction of effect\n\n    -   correlation whether $r$ is positive or negative\n    -   which categories have higher than expected values\n\n3.  the magnitude of effect\n\nWe do not put a line of best fit on a scatter plot accompanying a\ncorrelation because such a line implies a causal relationship.\n\nWe will explore all of these ideas with an examples.\n\n## 🎬 Your turn!\n\nIf you want to code along you will need to start a new [RStudio\nproject](workflow_rstudio.html#rstudio-projects), add a `data-raw`\nfolder and open a new script. You will also need to load the\n**`tidyverse`** package [@tidyverse].\n\n## Correlation\n\nHigh quality images of the internal structure of wheat seeds were taken\nwith a soft X-ray technique. Seven measurements determined from the\nimages:\n\n-   Area\n-   Perimeter\n-   Compactness\n-   Kernel length\n-   Kernel width\n-   Asymmetry coefficient\n-   Length of kernel groove\n\nResearch were interested in the correlation between compactness and\nkernel width\n\nThe data are in [seeds-dataset.xlsx](data-raw/seeds-dataset.xlsx).\n\n### Import and explore\n\nThe data are in an excel file so we will need the **`readxl`** [@readxl]\npackage.\n\nLoad the package:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n:::\n\n\n\n\nFind out the names of the sheets in the excel file:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexcel_sheets(\"data-raw/seeds-dataset.xlsx\")\n## [1] \"seeds_dataset\"\n```\n:::\n\n\n\n\nThere is only one sheet called `seeds_dataset`.\n\nImport the data:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseeds <- read_excel(\"data-raw/seeds-dataset.xlsx\",\n                    sheet = \"seeds_dataset\")\n```\n:::\n\n\n\n\nNote that we could have omitted the `sheet` argument because there is\nonly one sheet in the Excel file. However, it is good practice to be\nexplicit.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; \"><table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> area </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> perimeter </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> compactness </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> kernal_length </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> kernel_width </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> asymmetry_coef </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> groove_length </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 15.26 </td>\n   <td style=\"text-align:right;\"> 14.84 </td>\n   <td style=\"text-align:right;\"> 0.8710 </td>\n   <td style=\"text-align:right;\"> 5.763 </td>\n   <td style=\"text-align:right;\"> 3.312 </td>\n   <td style=\"text-align:right;\"> 2.2210 </td>\n   <td style=\"text-align:right;\"> 5.220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.88 </td>\n   <td style=\"text-align:right;\"> 14.57 </td>\n   <td style=\"text-align:right;\"> 0.8811 </td>\n   <td style=\"text-align:right;\"> 5.554 </td>\n   <td style=\"text-align:right;\"> 3.333 </td>\n   <td style=\"text-align:right;\"> 1.0180 </td>\n   <td style=\"text-align:right;\"> 4.956 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.29 </td>\n   <td style=\"text-align:right;\"> 14.09 </td>\n   <td style=\"text-align:right;\"> 0.9050 </td>\n   <td style=\"text-align:right;\"> 5.291 </td>\n   <td style=\"text-align:right;\"> 3.337 </td>\n   <td style=\"text-align:right;\"> 2.6990 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.84 </td>\n   <td style=\"text-align:right;\"> 13.94 </td>\n   <td style=\"text-align:right;\"> 0.8955 </td>\n   <td style=\"text-align:right;\"> 5.324 </td>\n   <td style=\"text-align:right;\"> 3.379 </td>\n   <td style=\"text-align:right;\"> 2.2590 </td>\n   <td style=\"text-align:right;\"> 4.805 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.14 </td>\n   <td style=\"text-align:right;\"> 14.99 </td>\n   <td style=\"text-align:right;\"> 0.9034 </td>\n   <td style=\"text-align:right;\"> 5.658 </td>\n   <td style=\"text-align:right;\"> 3.562 </td>\n   <td style=\"text-align:right;\"> 1.3550 </td>\n   <td style=\"text-align:right;\"> 5.175 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.38 </td>\n   <td style=\"text-align:right;\"> 14.21 </td>\n   <td style=\"text-align:right;\"> 0.8951 </td>\n   <td style=\"text-align:right;\"> 5.386 </td>\n   <td style=\"text-align:right;\"> 3.312 </td>\n   <td style=\"text-align:right;\"> 2.4620 </td>\n   <td style=\"text-align:right;\"> 4.956 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.69 </td>\n   <td style=\"text-align:right;\"> 14.49 </td>\n   <td style=\"text-align:right;\"> 0.8799 </td>\n   <td style=\"text-align:right;\"> 5.563 </td>\n   <td style=\"text-align:right;\"> 3.259 </td>\n   <td style=\"text-align:right;\"> 3.5860 </td>\n   <td style=\"text-align:right;\"> 5.219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.10 </td>\n   <td style=\"text-align:right;\"> 0.8911 </td>\n   <td style=\"text-align:right;\"> 5.420 </td>\n   <td style=\"text-align:right;\"> 3.302 </td>\n   <td style=\"text-align:right;\"> 2.7000 </td>\n   <td style=\"text-align:right;\"> 5.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.63 </td>\n   <td style=\"text-align:right;\"> 15.46 </td>\n   <td style=\"text-align:right;\"> 0.8747 </td>\n   <td style=\"text-align:right;\"> 6.053 </td>\n   <td style=\"text-align:right;\"> 3.465 </td>\n   <td style=\"text-align:right;\"> 2.0400 </td>\n   <td style=\"text-align:right;\"> 5.877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.44 </td>\n   <td style=\"text-align:right;\"> 15.25 </td>\n   <td style=\"text-align:right;\"> 0.8880 </td>\n   <td style=\"text-align:right;\"> 5.884 </td>\n   <td style=\"text-align:right;\"> 3.505 </td>\n   <td style=\"text-align:right;\"> 1.9690 </td>\n   <td style=\"text-align:right;\"> 5.533 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.26 </td>\n   <td style=\"text-align:right;\"> 14.85 </td>\n   <td style=\"text-align:right;\"> 0.8696 </td>\n   <td style=\"text-align:right;\"> 5.714 </td>\n   <td style=\"text-align:right;\"> 3.242 </td>\n   <td style=\"text-align:right;\"> 4.5430 </td>\n   <td style=\"text-align:right;\"> 5.314 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.03 </td>\n   <td style=\"text-align:right;\"> 14.16 </td>\n   <td style=\"text-align:right;\"> 0.8796 </td>\n   <td style=\"text-align:right;\"> 5.438 </td>\n   <td style=\"text-align:right;\"> 3.201 </td>\n   <td style=\"text-align:right;\"> 1.7170 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.89 </td>\n   <td style=\"text-align:right;\"> 14.02 </td>\n   <td style=\"text-align:right;\"> 0.8880 </td>\n   <td style=\"text-align:right;\"> 5.439 </td>\n   <td style=\"text-align:right;\"> 3.199 </td>\n   <td style=\"text-align:right;\"> 3.9860 </td>\n   <td style=\"text-align:right;\"> 4.738 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.78 </td>\n   <td style=\"text-align:right;\"> 14.06 </td>\n   <td style=\"text-align:right;\"> 0.8759 </td>\n   <td style=\"text-align:right;\"> 5.479 </td>\n   <td style=\"text-align:right;\"> 3.156 </td>\n   <td style=\"text-align:right;\"> 3.1360 </td>\n   <td style=\"text-align:right;\"> 4.872 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.74 </td>\n   <td style=\"text-align:right;\"> 14.05 </td>\n   <td style=\"text-align:right;\"> 0.8744 </td>\n   <td style=\"text-align:right;\"> 5.482 </td>\n   <td style=\"text-align:right;\"> 3.114 </td>\n   <td style=\"text-align:right;\"> 2.9320 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.59 </td>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 0.8993 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n   <td style=\"text-align:right;\"> 3.333 </td>\n   <td style=\"text-align:right;\"> 4.1850 </td>\n   <td style=\"text-align:right;\"> 4.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.99 </td>\n   <td style=\"text-align:right;\"> 13.83 </td>\n   <td style=\"text-align:right;\"> 0.9183 </td>\n   <td style=\"text-align:right;\"> 5.119 </td>\n   <td style=\"text-align:right;\"> 3.383 </td>\n   <td style=\"text-align:right;\"> 5.2340 </td>\n   <td style=\"text-align:right;\"> 4.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.69 </td>\n   <td style=\"text-align:right;\"> 14.75 </td>\n   <td style=\"text-align:right;\"> 0.9058 </td>\n   <td style=\"text-align:right;\"> 5.527 </td>\n   <td style=\"text-align:right;\"> 3.514 </td>\n   <td style=\"text-align:right;\"> 1.5990 </td>\n   <td style=\"text-align:right;\"> 5.046 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.70 </td>\n   <td style=\"text-align:right;\"> 14.21 </td>\n   <td style=\"text-align:right;\"> 0.9153 </td>\n   <td style=\"text-align:right;\"> 5.205 </td>\n   <td style=\"text-align:right;\"> 3.466 </td>\n   <td style=\"text-align:right;\"> 1.7670 </td>\n   <td style=\"text-align:right;\"> 4.649 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.72 </td>\n   <td style=\"text-align:right;\"> 13.57 </td>\n   <td style=\"text-align:right;\"> 0.8686 </td>\n   <td style=\"text-align:right;\"> 5.226 </td>\n   <td style=\"text-align:right;\"> 3.049 </td>\n   <td style=\"text-align:right;\"> 4.1020 </td>\n   <td style=\"text-align:right;\"> 4.914 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.16 </td>\n   <td style=\"text-align:right;\"> 14.40 </td>\n   <td style=\"text-align:right;\"> 0.8584 </td>\n   <td style=\"text-align:right;\"> 5.658 </td>\n   <td style=\"text-align:right;\"> 3.129 </td>\n   <td style=\"text-align:right;\"> 3.0720 </td>\n   <td style=\"text-align:right;\"> 5.176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.26 </td>\n   <td style=\"text-align:right;\"> 0.8722 </td>\n   <td style=\"text-align:right;\"> 5.520 </td>\n   <td style=\"text-align:right;\"> 3.168 </td>\n   <td style=\"text-align:right;\"> 2.6880 </td>\n   <td style=\"text-align:right;\"> 5.219 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.88 </td>\n   <td style=\"text-align:right;\"> 14.90 </td>\n   <td style=\"text-align:right;\"> 0.8988 </td>\n   <td style=\"text-align:right;\"> 5.618 </td>\n   <td style=\"text-align:right;\"> 3.507 </td>\n   <td style=\"text-align:right;\"> 0.7651 </td>\n   <td style=\"text-align:right;\"> 5.091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.08 </td>\n   <td style=\"text-align:right;\"> 13.23 </td>\n   <td style=\"text-align:right;\"> 0.8664 </td>\n   <td style=\"text-align:right;\"> 5.099 </td>\n   <td style=\"text-align:right;\"> 2.936 </td>\n   <td style=\"text-align:right;\"> 1.4150 </td>\n   <td style=\"text-align:right;\"> 4.961 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.01 </td>\n   <td style=\"text-align:right;\"> 14.76 </td>\n   <td style=\"text-align:right;\"> 0.8657 </td>\n   <td style=\"text-align:right;\"> 5.789 </td>\n   <td style=\"text-align:right;\"> 3.245 </td>\n   <td style=\"text-align:right;\"> 1.7910 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.19 </td>\n   <td style=\"text-align:right;\"> 15.16 </td>\n   <td style=\"text-align:right;\"> 0.8849 </td>\n   <td style=\"text-align:right;\"> 5.833 </td>\n   <td style=\"text-align:right;\"> 3.421 </td>\n   <td style=\"text-align:right;\"> 0.9030 </td>\n   <td style=\"text-align:right;\"> 5.307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.02 </td>\n   <td style=\"text-align:right;\"> 13.76 </td>\n   <td style=\"text-align:right;\"> 0.8641 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 3.026 </td>\n   <td style=\"text-align:right;\"> 3.3730 </td>\n   <td style=\"text-align:right;\"> 4.825 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.74 </td>\n   <td style=\"text-align:right;\"> 13.67 </td>\n   <td style=\"text-align:right;\"> 0.8564 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 2.956 </td>\n   <td style=\"text-align:right;\"> 2.5040 </td>\n   <td style=\"text-align:right;\"> 4.869 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.11 </td>\n   <td style=\"text-align:right;\"> 14.18 </td>\n   <td style=\"text-align:right;\"> 0.8820 </td>\n   <td style=\"text-align:right;\"> 5.541 </td>\n   <td style=\"text-align:right;\"> 3.221 </td>\n   <td style=\"text-align:right;\"> 2.7540 </td>\n   <td style=\"text-align:right;\"> 5.038 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.45 </td>\n   <td style=\"text-align:right;\"> 14.02 </td>\n   <td style=\"text-align:right;\"> 0.8604 </td>\n   <td style=\"text-align:right;\"> 5.516 </td>\n   <td style=\"text-align:right;\"> 3.065 </td>\n   <td style=\"text-align:right;\"> 3.5310 </td>\n   <td style=\"text-align:right;\"> 5.097 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.16 </td>\n   <td style=\"text-align:right;\"> 13.82 </td>\n   <td style=\"text-align:right;\"> 0.8662 </td>\n   <td style=\"text-align:right;\"> 5.454 </td>\n   <td style=\"text-align:right;\"> 2.975 </td>\n   <td style=\"text-align:right;\"> 0.8551 </td>\n   <td style=\"text-align:right;\"> 5.056 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.49 </td>\n   <td style=\"text-align:right;\"> 14.94 </td>\n   <td style=\"text-align:right;\"> 0.8724 </td>\n   <td style=\"text-align:right;\"> 5.757 </td>\n   <td style=\"text-align:right;\"> 3.371 </td>\n   <td style=\"text-align:right;\"> 3.4120 </td>\n   <td style=\"text-align:right;\"> 5.228 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.09 </td>\n   <td style=\"text-align:right;\"> 14.41 </td>\n   <td style=\"text-align:right;\"> 0.8529 </td>\n   <td style=\"text-align:right;\"> 5.717 </td>\n   <td style=\"text-align:right;\"> 3.186 </td>\n   <td style=\"text-align:right;\"> 3.9200 </td>\n   <td style=\"text-align:right;\"> 5.299 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.94 </td>\n   <td style=\"text-align:right;\"> 14.17 </td>\n   <td style=\"text-align:right;\"> 0.8728 </td>\n   <td style=\"text-align:right;\"> 5.585 </td>\n   <td style=\"text-align:right;\"> 3.150 </td>\n   <td style=\"text-align:right;\"> 2.1240 </td>\n   <td style=\"text-align:right;\"> 5.012 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.05 </td>\n   <td style=\"text-align:right;\"> 14.68 </td>\n   <td style=\"text-align:right;\"> 0.8779 </td>\n   <td style=\"text-align:right;\"> 5.712 </td>\n   <td style=\"text-align:right;\"> 3.328 </td>\n   <td style=\"text-align:right;\"> 2.1290 </td>\n   <td style=\"text-align:right;\"> 5.360 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.12 </td>\n   <td style=\"text-align:right;\"> 15.00 </td>\n   <td style=\"text-align:right;\"> 0.9000 </td>\n   <td style=\"text-align:right;\"> 5.709 </td>\n   <td style=\"text-align:right;\"> 3.485 </td>\n   <td style=\"text-align:right;\"> 2.2700 </td>\n   <td style=\"text-align:right;\"> 5.443 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 16.20 </td>\n   <td style=\"text-align:right;\"> 15.27 </td>\n   <td style=\"text-align:right;\"> 0.8734 </td>\n   <td style=\"text-align:right;\"> 5.826 </td>\n   <td style=\"text-align:right;\"> 3.464 </td>\n   <td style=\"text-align:right;\"> 2.8230 </td>\n   <td style=\"text-align:right;\"> 5.527 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17.08 </td>\n   <td style=\"text-align:right;\"> 15.38 </td>\n   <td style=\"text-align:right;\"> 0.9079 </td>\n   <td style=\"text-align:right;\"> 5.832 </td>\n   <td style=\"text-align:right;\"> 3.683 </td>\n   <td style=\"text-align:right;\"> 2.9560 </td>\n   <td style=\"text-align:right;\"> 5.484 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.80 </td>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 0.8823 </td>\n   <td style=\"text-align:right;\"> 5.656 </td>\n   <td style=\"text-align:right;\"> 3.288 </td>\n   <td style=\"text-align:right;\"> 3.1120 </td>\n   <td style=\"text-align:right;\"> 5.309 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 14.17 </td>\n   <td style=\"text-align:right;\"> 0.8944 </td>\n   <td style=\"text-align:right;\"> 5.397 </td>\n   <td style=\"text-align:right;\"> 3.298 </td>\n   <td style=\"text-align:right;\"> 6.6850 </td>\n   <td style=\"text-align:right;\"> 5.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.54 </td>\n   <td style=\"text-align:right;\"> 13.85 </td>\n   <td style=\"text-align:right;\"> 0.8871 </td>\n   <td style=\"text-align:right;\"> 5.348 </td>\n   <td style=\"text-align:right;\"> 3.156 </td>\n   <td style=\"text-align:right;\"> 2.5870 </td>\n   <td style=\"text-align:right;\"> 5.178 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.50 </td>\n   <td style=\"text-align:right;\"> 13.85 </td>\n   <td style=\"text-align:right;\"> 0.8852 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n   <td style=\"text-align:right;\"> 3.158 </td>\n   <td style=\"text-align:right;\"> 2.2490 </td>\n   <td style=\"text-align:right;\"> 5.176 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.16 </td>\n   <td style=\"text-align:right;\"> 13.55 </td>\n   <td style=\"text-align:right;\"> 0.9009 </td>\n   <td style=\"text-align:right;\"> 5.138 </td>\n   <td style=\"text-align:right;\"> 3.201 </td>\n   <td style=\"text-align:right;\"> 2.4610 </td>\n   <td style=\"text-align:right;\"> 4.783 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.50 </td>\n   <td style=\"text-align:right;\"> 14.86 </td>\n   <td style=\"text-align:right;\"> 0.8820 </td>\n   <td style=\"text-align:right;\"> 5.877 </td>\n   <td style=\"text-align:right;\"> 3.396 </td>\n   <td style=\"text-align:right;\"> 4.7110 </td>\n   <td style=\"text-align:right;\"> 5.528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.11 </td>\n   <td style=\"text-align:right;\"> 14.54 </td>\n   <td style=\"text-align:right;\"> 0.8986 </td>\n   <td style=\"text-align:right;\"> 5.579 </td>\n   <td style=\"text-align:right;\"> 3.462 </td>\n   <td style=\"text-align:right;\"> 3.1280 </td>\n   <td style=\"text-align:right;\"> 5.180 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.80 </td>\n   <td style=\"text-align:right;\"> 14.04 </td>\n   <td style=\"text-align:right;\"> 0.8794 </td>\n   <td style=\"text-align:right;\"> 5.376 </td>\n   <td style=\"text-align:right;\"> 3.155 </td>\n   <td style=\"text-align:right;\"> 1.5600 </td>\n   <td style=\"text-align:right;\"> 4.961 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.36 </td>\n   <td style=\"text-align:right;\"> 14.76 </td>\n   <td style=\"text-align:right;\"> 0.8861 </td>\n   <td style=\"text-align:right;\"> 5.701 </td>\n   <td style=\"text-align:right;\"> 3.393 </td>\n   <td style=\"text-align:right;\"> 1.3670 </td>\n   <td style=\"text-align:right;\"> 5.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.99 </td>\n   <td style=\"text-align:right;\"> 14.56 </td>\n   <td style=\"text-align:right;\"> 0.8883 </td>\n   <td style=\"text-align:right;\"> 5.570 </td>\n   <td style=\"text-align:right;\"> 3.377 </td>\n   <td style=\"text-align:right;\"> 2.9580 </td>\n   <td style=\"text-align:right;\"> 5.175 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.79 </td>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 0.8819 </td>\n   <td style=\"text-align:right;\"> 5.545 </td>\n   <td style=\"text-align:right;\"> 3.291 </td>\n   <td style=\"text-align:right;\"> 2.7040 </td>\n   <td style=\"text-align:right;\"> 5.111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.86 </td>\n   <td style=\"text-align:right;\"> 14.67 </td>\n   <td style=\"text-align:right;\"> 0.8676 </td>\n   <td style=\"text-align:right;\"> 5.678 </td>\n   <td style=\"text-align:right;\"> 3.258 </td>\n   <td style=\"text-align:right;\"> 2.1290 </td>\n   <td style=\"text-align:right;\"> 5.351 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.43 </td>\n   <td style=\"text-align:right;\"> 14.40 </td>\n   <td style=\"text-align:right;\"> 0.8751 </td>\n   <td style=\"text-align:right;\"> 5.585 </td>\n   <td style=\"text-align:right;\"> 3.272 </td>\n   <td style=\"text-align:right;\"> 3.9750 </td>\n   <td style=\"text-align:right;\"> 5.144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.78 </td>\n   <td style=\"text-align:right;\"> 14.91 </td>\n   <td style=\"text-align:right;\"> 0.8923 </td>\n   <td style=\"text-align:right;\"> 5.674 </td>\n   <td style=\"text-align:right;\"> 3.434 </td>\n   <td style=\"text-align:right;\"> 5.5930 </td>\n   <td style=\"text-align:right;\"> 5.136 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.49 </td>\n   <td style=\"text-align:right;\"> 14.61 </td>\n   <td style=\"text-align:right;\"> 0.8538 </td>\n   <td style=\"text-align:right;\"> 5.715 </td>\n   <td style=\"text-align:right;\"> 3.113 </td>\n   <td style=\"text-align:right;\"> 4.1160 </td>\n   <td style=\"text-align:right;\"> 5.396 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.33 </td>\n   <td style=\"text-align:right;\"> 14.28 </td>\n   <td style=\"text-align:right;\"> 0.8831 </td>\n   <td style=\"text-align:right;\"> 5.504 </td>\n   <td style=\"text-align:right;\"> 3.199 </td>\n   <td style=\"text-align:right;\"> 3.3280 </td>\n   <td style=\"text-align:right;\"> 5.224 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.52 </td>\n   <td style=\"text-align:right;\"> 14.60 </td>\n   <td style=\"text-align:right;\"> 0.8557 </td>\n   <td style=\"text-align:right;\"> 5.741 </td>\n   <td style=\"text-align:right;\"> 3.113 </td>\n   <td style=\"text-align:right;\"> 1.4810 </td>\n   <td style=\"text-align:right;\"> 5.487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.03 </td>\n   <td style=\"text-align:right;\"> 14.77 </td>\n   <td style=\"text-align:right;\"> 0.8658 </td>\n   <td style=\"text-align:right;\"> 5.702 </td>\n   <td style=\"text-align:right;\"> 3.212 </td>\n   <td style=\"text-align:right;\"> 1.9330 </td>\n   <td style=\"text-align:right;\"> 5.439 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.46 </td>\n   <td style=\"text-align:right;\"> 14.35 </td>\n   <td style=\"text-align:right;\"> 0.8818 </td>\n   <td style=\"text-align:right;\"> 5.388 </td>\n   <td style=\"text-align:right;\"> 3.377 </td>\n   <td style=\"text-align:right;\"> 2.8020 </td>\n   <td style=\"text-align:right;\"> 5.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.92 </td>\n   <td style=\"text-align:right;\"> 14.43 </td>\n   <td style=\"text-align:right;\"> 0.9006 </td>\n   <td style=\"text-align:right;\"> 5.384 </td>\n   <td style=\"text-align:right;\"> 3.412 </td>\n   <td style=\"text-align:right;\"> 1.1420 </td>\n   <td style=\"text-align:right;\"> 5.088 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15.38 </td>\n   <td style=\"text-align:right;\"> 14.77 </td>\n   <td style=\"text-align:right;\"> 0.8857 </td>\n   <td style=\"text-align:right;\"> 5.662 </td>\n   <td style=\"text-align:right;\"> 3.419 </td>\n   <td style=\"text-align:right;\"> 1.9990 </td>\n   <td style=\"text-align:right;\"> 5.222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.11 </td>\n   <td style=\"text-align:right;\"> 13.47 </td>\n   <td style=\"text-align:right;\"> 0.8392 </td>\n   <td style=\"text-align:right;\"> 5.159 </td>\n   <td style=\"text-align:right;\"> 3.032 </td>\n   <td style=\"text-align:right;\"> 1.5020 </td>\n   <td style=\"text-align:right;\"> 4.519 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11.42 </td>\n   <td style=\"text-align:right;\"> 12.86 </td>\n   <td style=\"text-align:right;\"> 0.8683 </td>\n   <td style=\"text-align:right;\"> 5.008 </td>\n   <td style=\"text-align:right;\"> 2.850 </td>\n   <td style=\"text-align:right;\"> 2.7000 </td>\n   <td style=\"text-align:right;\"> 4.607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 11.23 </td>\n   <td style=\"text-align:right;\"> 12.63 </td>\n   <td style=\"text-align:right;\"> 0.8840 </td>\n   <td style=\"text-align:right;\"> 4.902 </td>\n   <td style=\"text-align:right;\"> 2.879 </td>\n   <td style=\"text-align:right;\"> 2.2690 </td>\n   <td style=\"text-align:right;\"> 4.703 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.36 </td>\n   <td style=\"text-align:right;\"> 13.19 </td>\n   <td style=\"text-align:right;\"> 0.8923 </td>\n   <td style=\"text-align:right;\"> 5.076 </td>\n   <td style=\"text-align:right;\"> 3.042 </td>\n   <td style=\"text-align:right;\"> 3.2200 </td>\n   <td style=\"text-align:right;\"> 4.605 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 13.22 </td>\n   <td style=\"text-align:right;\"> 13.84 </td>\n   <td style=\"text-align:right;\"> 0.8680 </td>\n   <td style=\"text-align:right;\"> 5.395 </td>\n   <td style=\"text-align:right;\"> 3.070 </td>\n   <td style=\"text-align:right;\"> 4.1570 </td>\n   <td style=\"text-align:right;\"> 5.088 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.78 </td>\n   <td style=\"text-align:right;\"> 13.57 </td>\n   <td style=\"text-align:right;\"> 0.8716 </td>\n   <td style=\"text-align:right;\"> 5.262 </td>\n   <td style=\"text-align:right;\"> 3.026 </td>\n   <td style=\"text-align:right;\"> 1.1760 </td>\n   <td style=\"text-align:right;\"> 4.782 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.88 </td>\n   <td style=\"text-align:right;\"> 13.50 </td>\n   <td style=\"text-align:right;\"> 0.8879 </td>\n   <td style=\"text-align:right;\"> 5.139 </td>\n   <td style=\"text-align:right;\"> 3.119 </td>\n   <td style=\"text-align:right;\"> 2.3520 </td>\n   <td style=\"text-align:right;\"> 4.607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.34 </td>\n   <td style=\"text-align:right;\"> 14.37 </td>\n   <td style=\"text-align:right;\"> 0.8726 </td>\n   <td style=\"text-align:right;\"> 5.630 </td>\n   <td style=\"text-align:right;\"> 3.190 </td>\n   <td style=\"text-align:right;\"> 1.3130 </td>\n   <td style=\"text-align:right;\"> 5.150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.01 </td>\n   <td style=\"text-align:right;\"> 14.29 </td>\n   <td style=\"text-align:right;\"> 0.8625 </td>\n   <td style=\"text-align:right;\"> 5.609 </td>\n   <td style=\"text-align:right;\"> 3.158 </td>\n   <td style=\"text-align:right;\"> 2.2170 </td>\n   <td style=\"text-align:right;\"> 5.132 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14.37 </td>\n   <td style=\"text-align:right;\"> 14.39 </td>\n   <td style=\"text-align:right;\"> 0.8726 </td>\n   <td style=\"text-align:right;\"> 5.569 </td>\n   <td style=\"text-align:right;\"> 3.153 </td>\n   <td style=\"text-align:right;\"> 1.4640 </td>\n   <td style=\"text-align:right;\"> 5.300 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12.73 </td>\n   <td style=\"text-align:right;\"> 13.75 </td>\n   <td style=\"text-align:right;\"> 0.8458 </td>\n   <td style=\"text-align:right;\"> 5.412 </td>\n   <td style=\"text-align:right;\"> 2.882 </td>\n   <td style=\"text-align:right;\"> 3.5330 </td>\n   <td style=\"text-align:right;\"> 5.067 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n\n\nThese data are formatted usefully for analysis using correlation and\nplotting. Each row is a different seed and the columns are the variables\nwe are interested. This means that the first values in each column are\nrelated - they are all from the same seed\n\nIn the first instance, it is sensible to create a rough plot of our data\n(See @fig-seeds-rough). Plotting data early helps us in multiple ways:\n\n-   it helps identify whether there extreme values\n-   it allows us to see if the association is roughly linear\n-   it tells us whether any association positive or negative\n\nScatter plots (`geom_point()`) are a good choice for exploratory\nplotting with data like these.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = seeds,\n       aes(x = compactness, y = kernel_width)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![A default scatter plot of compactness and kernel width in seeds demonstrates an approximately linear positive association between them.](association_files/figure-html/fig-seeds-rough-1.png){#fig-seeds-rough width=576}\n:::\n:::\n\n\n\n\nThe figure suggests that there is a positive correlation between\n`compactness` and `kernel_width` and that correlation is roughly linear.\n\n### Check assumptions\n\nWe can see from @fig-seeds-rough that the relationship between\n`compactness` and `kernel_width` is roughly linear. This is a good sign\nfor using Pearson's correlation coefficient.\n\nOur next check is to use common sense: both variables are continuous and\nwe would expect them to be normally distributed. We can then plot\nhistograms to examine the distributions (See @fig-hist).\n\n\n\n\n::: {#fig-hist .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nggplot(data = seeds, aes(x = compactness)) +\n  geom_histogram(bins = 12)\n\nggplot(data = seeds, aes(x = kernel_width)) +\n  geom_histogram(bins = 12)\n\n```\n\n::: {.cell-output-display}\n![Compactness](association_files/figure-html/fig-hist-1.png){#fig-hist-1 width=576}\n:::\n\n::: {.cell-output-display}\n![Kernel width](association_files/figure-html/fig-hist-2.png){#fig-hist-2 width=576}\n:::\n\nThe distributions of the two variables are slightly skewed but do not seem too different from a normal distribution. We will continue with the Pearson's correlation coefficient.\n:::\n\n\n\n\nThe distributions of the two variables are slightly skewed but do not\nseem too different from a normal distribution.\n\nFinally, we can use the Shapiro-Wilk test to test for normality.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(seeds$compactness)\n## \n## \tShapiro-Wilk normality test\n## \n## data:  seeds$compactness\n## W = 0.99484, p-value = 0.9937\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(seeds$kernel_width)\n## \n## \tShapiro-Wilk normality test\n## \n## data:  seeds$kernel_width\n## W = 0.98989, p-value = 0.8486\n```\n:::\n\n\n\n\nThe *p*-values are greater than 0.05 so these tests of the normality\nassumption are not significant. Note that \"not significant\" means not\nsignificantly different from a normal distribution. It does not mean\ndefinitely normally distributed.\n\nIt is not unreasonable to continue with the Pearson's correlation\ncoefficient. However, later we will also use the Spearman's rank\ncorrelation coefficient, a non-parametric method which has fewer\nassumptions. Spearman's rank correlation is a more conservative\napproach.\n\n### Do a Pearson's correlation test with `cor.test()`\n\nWe can carry out a Pearson's correlation test with `cor.test()` like\nthis:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(data = seeds, ~ compactness + kernel_width)\n## \n## \tPearson's product-moment correlation\n## \n## data:  compactness and kernel_width\n## t = 7.3738, df = 68, p-value = 2.998e-10\n## alternative hypothesis: true correlation is not equal to 0\n## 95 percent confidence interval:\n##  0.5117537 0.7794620\n## sample estimates:\n##       cor \n## 0.6665731\n```\n:::\n\n\n\n\nA variable is not being explained in this case so we do not need to\ninclude a response variable. Pearson’s is the default test so we do not\nneed to specify it.\n\nWhat do all these results mean?\n\nThe last line gives the correlation coefficient, $r$, that has been\nestimated from the data. Here, $r$ =\n0.67\nwhich is a moderate positive correlation.\n\nThe fifth line tells you what test has been done:\n`alternative hypothesis: true correlation is not equal to 0`. That is\n$H_0$ is that $\\rho = 0$\n\nThe forth line gives the test result:\n`t = 7.3738, df = 68, p-value = 2.998e-10`\n\nThe $p$-value is very much less than 0.05 so we can reject the null\nhypothesis and conclude there is a significant positive correlation\nbetween `compactness` and `kernel_width`.\n\n### Report\n\nThere was a significant positive correlation ($r$ =\n0.67)\nbetween compactness and kernel width (Pearson's: *t* = 7.374; *df* = 68;\n*p*-value < 0.0001). See @fig-correlation-pears.\n\n::: {#fig-correlation-pears}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = seeds,\n       aes(x = compactness, y = kernel_width)) +\n  geom_point() +\n  scale_y_continuous(name = \"Diameter (mm)\") +\n    scale_x_continuous(name = \"Compactness\") +\n  annotate(\"text\", x = 0.85,  y = 3.6, \n           label = expression(italic(r)~\"= 0.67; \"~italic(p)~\"< 0.001\")) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](association_files/figure-html/unnamed-chunk-12-1.png){width=576}\n:::\n:::\n\n\n\n\n**Correlation between compactness and kernel width of wheat seeds**.\nHigh quality images of the internal structure of wheat seeds were taken\nwith a soft X-ray technique and the compactness and kernel width of the\nseeds were determined. There was a significant positive correlation ($r$\n=\n0.67)\nbetween compactness and kernel width (Pearson's: *t* = 7.374; *df* = 68;\n*p*-value < 0.0001). Note: axes do not start at 0. Data analysis was\nconducted in R [@R-core] with tidyverse packages [@tidyverse].\n:::\n\n### Spearman's rank correlation coefficient\n\nResearchers are studying how systolic blood pressure (SBP) is \nassociated with kidney function in patients. Chronic high blood \npressure can damage the kidneys over time, leading to reduced function,\nwhich can be measured by estimated glomerular filtration rate (eGFR). \nSBP is measured in mmHg and represents the force of blood against \nartery walls when the heart beats. eGFR is estimated from from blood \ncreatine levels in mL/min/1.73m². Lower values indicate impaired kidney\nfiltration.\n\nThe data are in [blood-pressure-kidney-function.csv](data-raw/blood-pressure-kidney-function.csv).\n\n### Import and explore\n\nImport the data from a csv file:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbp_kidney <- read_csv(\"data-raw/blood-pressure-kidney-function.csv\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; \"><table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> SBP </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> eGFR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 112 </td>\n   <td style=\"text-align:right;\"> 48.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 38.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 116 </td>\n   <td style=\"text-align:right;\"> 50.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 33.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 148 </td>\n   <td style=\"text-align:right;\"> 37.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 127 </td>\n   <td style=\"text-align:right;\"> 34.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 113 </td>\n   <td style=\"text-align:right;\"> 53.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 169 </td>\n   <td style=\"text-align:right;\"> 2.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 123 </td>\n   <td style=\"text-align:right;\"> 35.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 118 </td>\n   <td style=\"text-align:right;\"> 50.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:right;\"> 28.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 111 </td>\n   <td style=\"text-align:right;\"> 54.8 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n\n\nThese data are formatted usefully for analysis using correlation and\nplotting. We will create a rough plot of our data\n(See @fig-kidney-rough). \n\nScatter plots (`geom_point()`) are a good choice for exploratory\nplotting with data like these.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = bp_kidney,\n       aes(x = SBP, y = eGFR)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![A default scatter plot of systolic blood pressure (SBP) and kidney function demonstrates a possible negative association between variables. It is not clear if the relationship is linear](association_files/figure-html/fig-kidney-rough-1.png){#fig-kidney-rough width=576}\n:::\n:::\n\n\n\n\nThe figure suggests that there is a negative association between\n`SBP` and `eGFR` but it is not clear if the association is linear.\n\nSpearman's rank correlation coefficient which does not assume a strict\nlinear association so maybe a better choice. In addition, we might \nexpect eGFR values to be to be skewed since indicators of disease often\nshow step changes in values.\n\n\n### Do a Spearman's rank correlation test with `cor.test()`\n\nWe can carry out a Spearman's rank correlation test with `cor.test()` \nlike this:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(data = bp_kidney, ~ SBP + eGFR, method = \"spearman\")\n## \n## \tSpearman's rank correlation rho\n## \n## data:  SBP and eGFR\n## S = 526, p-value = 0.001192\n## alternative hypothesis: true rho is not equal to 0\n## sample estimates:\n##        rho \n## -0.8391608\n```\n:::\n\n\n\n\nA variable is not being explained in this case so we do not need to\ninclude a response variable. Pearson’s is the default test so we need\nto specify `method = \"spearman\"`.\n\nWhat do all these results mean?\n\nThe last line gives the correlation coefficient, $r$, that has been\nestimated from the data. Here, $r$ =\n-0.8\nwhich is fairly strong negative correlation.\n\nThe fifth line tells you what test has been done:\n`alternative hypothesis: true rho is not equal to 0`. That is\n$H_0$ is that $\\rho = 0$\n\nThe forth line gives the test result:\n`S = 526, p-value = 0.001192`\n\nThe $p$-value is very much less than 0.05 so we can reject the null\nhypothesis and conclude there is a significant negative correlation\nbetween `SBP` and `eGFR`.\n\n### Report\n\n. \nSBP is measured in mmHg and represents the force of blood against \nartery walls when the heart beats. eGFR is measured in \n\nThere was a significant positive correlation ($r$ =\n-0.8)\nbetween systolic blood pressure and estimated glomerular filtration \nrate (Spearman's rank correlation: *S* = 526; *n* = 12;\n*p*-value = 0.0012). See @fig-correlation-spears.\n\n::: {#fig-correlation-spears}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = bp_kidney,\n       aes(x = SBP, y = eGFR)) +\n  geom_point() +\n  scale_y_continuous(name = \"Estimated GFR (mL/min/1.73m²)\",\n                     limits = c(0, 60),\n                     expand = c(0 , 0)) +\n  scale_x_continuous(name = \"Systolic blood pressure (mmHg)\") +\n  annotate(\"text\", x = 120,  y = 10, \n           label = expression(italic(r)~\"= -0.8; \"~italic(p)~\"= 0.0012\")) +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](association_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\n\n\n**Correlation between Systolic blood pressure and estimated glomerular filtration rate (eGFR)**.\nTwelve patients had their Systolic blood pressure determined and \nGFR estimated from blood creatine levels. There was a significant \nnegative correlation ($r$ =\n-0.8)\nbetween systolic blood pressure and eGFR (Spearman's rank correlation: \n*S* = 526; *n* = 12; *p*-value = 0.0012). Note: $x$-axis does not start\nat 0. Data analysis was conducted in R [@R-core] with tidyverse packages\n[@tidyverse].\n:::\n\n\n## Contingency Chi-squared test\n\nResearchers were interested in whether different pig breeds had the same\nfood preferences. They offered individuals of three breads, Welsh,\nTamworth and Essex a choice of three foods: cabbage, sugar beet and\nswede and recorded the number of individuals that chose each food. The\ndata are shown in @tbl-food-pref.\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {#tbl-food-pref .cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Food preferences of three pig breeds</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> welsh </th>\n   <th style=\"text-align:right;\"> tamworth </th>\n   <th style=\"text-align:right;\"> essex </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> cabbage </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sugarbeet </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> swede </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nWe don’t know what proportion of food are expected to be preferred but\ndo expect it to be same for each breed if there is no association\nbetween breed and food preference. The null hypothesis is that the\nproportion of foods taken by each breed is the same.\n\nFor a contingency chi squared test, the inbuilt chi-squared test can be\nused but we need to to structure our data as a 3 x 3 table. The\n`matrix()` function is useful here and we can label the rows and columns\nto help us interpret the results.\n\nPut the data into a matrix:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create the data\nfood_pref <- matrix(c(11, 19, 22,\n                      21, 16, 8,\n                      7, 12, 11),\n                    nrow = 3,\n                    byrow = TRUE)\nfood_pref\n##      [,1] [,2] [,3]\n## [1,]   11   19   22\n## [2,]   21   16    8\n## [3,]    7   12   11\n```\n:::\n\n\n\n\nThe `byrow` and `nrow` arguments allow us to lay out the data in the\nmatrix as we need. To name the rows and columns we can use the\n`dimnames()` function. We need to create a \"list\" object to hold the\nnames of the rows and columns and then assign this to the matrix object.\nThe names of rows are columns are called the \"dimension names\" in a\nmatrix.\n\nMake a list for the two vectors of names:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \n\nvars <- list(food = c(\"cabbage\",\n                      \"sugarbeet\",\n                      \"swede\"),\n             breed = c(\"welsh\",\n                       \"tamworth\",\n                       \"essex\"))\n\n```\n:::\n\n\n\n\nThe vectors can be of different lengths in a list which would be\nimportant if we had four breeds and only two foods, for example.\n\nNow assign the list to the dimension names in the matrix:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndimnames(food_pref) <- vars\n\nfood_pref\n##            breed\n## food        welsh tamworth essex\n##   cabbage      11       19    22\n##   sugarbeet    21       16     8\n##   swede         7       12    11\n```\n:::\n\n\n\n\nThe data are now in a form that can be used in the `chisq.test()`\nfunction:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(food_pref)\n## \n## \tPearson's Chi-squared test\n## \n## data:  food_pref\n## X-squared = 10.64, df = 4, p-value = 0.03092\n```\n:::\n\n\n\n\nThe test is significant since the *p*-value is less than 0.05. We have\nevidence of a preference for particular foods by different breeds. But\nin what way? We need to know the “direction of the effect” *i.e.,* Who\nlikes what?\n\nThe `chisq.test()` function has a `residuals` argument that can be used\nto calculate the residuals. These are the differences between the\nobserved and expected values. The expected values are the values that\nwould be expected if there was no association between the rows and\ncolumns. The residuals are standardised.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(food_pref)$residuals\n##            breed\n## food             welsh    tamworth      essex\n##   cabbage   -1.2433504 -0.05564283  1.2722209\n##   sugarbeet  1.9317656 -0.16014783 -1.7125943\n##   swede     -0.7289731  0.26939742  0.4225344\n```\n:::\n\n\n\n\nWhere the residuals are positive, the observed value is greater than the\nexpected value and where they are negative, the observed value is less\nthan the expected value. Our results show the Welsh pigs much prefer\nsugarbeet and strongly dislike cabbage. The Essex pigs prefer cabbage\nand dislike sugarbeet and the Essex pigs slightly prefer swede but have\nless strong likes and dislikes.\n\nThe degrees of freedom are: (rows - 1)(cols - 1) = 2 \\* 2 = 4.\n\n### Report\n\nDifferent pig breeds showed a significant preference for the different\nfood types ($\\chi^2$ = 10.64; *df* = 4; *p* = 0.031) with Essex much\npreferring cabbage and disliking sugarbeet, Welsh showing a strong\npreference for sugarbeet and a dislike of cabbage and Tamworth showing\nno clear preference.\n\n\n## Summary\n\n1.   Unlike regression, correlation and chi-square contingency tests \n     assess association between variable without implying causality.\n\n2.  Pearson’s Correlation measures the linear association between two\n    continuous variables (range: -1 to 1). Assumes normality.\n\n3.  Scatter plots help identify the strength and direction \n     of relationships and should not include a best-fit line.\n     \n4.  Before using Pearson’s correlation, we check the normality \n     assumptions using histograms and the Shapiro-Wilk test.\n     \n5.  Spearman’s rannk Correlation is a non-parametric alternative \n    that does not require normality and is less sensitive to outliers.\n\n6.   Chi-Square Contingency tests allow us to test for an association \n     between categorical variables.\n\n7.   We report the statistical significance, the direction of the \n     association and the magnitude of the association.\n\n8.  In R we use `cor.test()` is used for correlation tests and\n    `chisq.test()` for chi-squared contingency tests\n\n\n",
    "supporting": [
      "association_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}