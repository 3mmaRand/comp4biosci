{
  "hash": "5347a16931434e721928ae359d89225c",
  "result": {
    "engine": "knitr",
    "markdown": "# Single linear regression\n\n\n\n\n\n::: {.callout-tip} \n## Just needs proof reading\nYou are reading a work in progress. This page is compete but needs final proof reading.\n:::\n\n\n\n\n## Overview\n\nSingle linear regression is an appropriate way to analyse data when:\n\n-   You have two continuous variables\n-   One of the variables is explanatory and the other is a response.\n    That is, one variable, the $x$, \"causes\" the $y$.\n-   The explanatory variable has been chosen, set or manipulated and the\n    other variable is the measured response. This is sometimes described\n    as the $x$ being ‚Äúsampled without error‚Äù\n-   The response variable, $y$, is randomly sampled for each $x$ with a\n    normal distribution and those normal distributions have the same\n    variance.\n-   The relationship between the variables is linear\n\nApplying a single linear regression to data means putting a line of best\nfit through it. The intercept and the slope of the true population\nrelationship is estimated from the sample you have. We test whether\nthose two parameters differ significantly from zero.\n\n### Reporting\n\nReporting [the significance of effect, direction of effect, magnitude of\neffect](https://3mmarand.github.io/comp4biosci/what_statistical_model.html#reporting)\nfor a single linear regression means making the following clear to the\nreader:\n\n1.  the significance of effect - whether the slope is significantly\n    different from zero\n\n2.  the direction of effect - whether the slope is positive or negative\n\n3.  the magnitude of effect - the slope itself\n\nFigures should reflect what you have said in the statements. Ideally\nthey should show both the raw data and the statistical model:\n\nWe will explore all of these ideas with an example.\n\n## üé¨ Your turn!\n\nIf you want to code along you will need to start a new [RStudio\nproject](workflow_rstudio.html#rstudio-projects), add a `data-raw`\nfolder and open a new script. You will also need to load the\n**`tidyverse`** package [@tidyverse].\n\n## Single linear regression\n\nThree replicates water baths were set up at each of five temperatures\n(10, 11C, 12C, 13C, 14C). Ten Brine Shrimp (*Artemia salina*) were\nplaced in each and their average respiration rate per water bath was\nmeasured (in arbitrary units). The data are in\n[shrimp.txt](data-raw/shrimp.txt). In this scenario our null hypothesis,\n$H_0$, is that temparature has no effect on respiration rate. Another \nway of saying this is the slope of the line is zero. This is written \nas: $H_0: \\beta_1 = 0$. \n\n### Import and explore\n\nImport the data:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshrimp <- read_table(\"data-raw/shrimp.txt\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; \"><table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> temperature </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> respiration </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 11.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 9.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 11.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 12.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 11.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12.30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 15.95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 14.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 17.56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 15.56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 16.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 18.96 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 17.78 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n\n\nThese data are in tidy format [@Wickham2014-nl] - all the respiration\nvalues are in one column with another column indicating the water bath\ntemperature. There is only one water bath per row. This means they are\nwell formatted for analysis and plotting.\n\nIn the first instance, it is sensible to create a rough plot of our data\n(See @fig-shrimp-rough). Plotting data early helps us in multiple ways:\n\n-   it helps identify whether there missing or extreme values\n-   it allows us to see if the relationship is roughly linear\n-   it tells us whether any relationship positive or negative\n\nScatter plots (`geom_point()`) are a good choice for exploratory\nplotting with data like these.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = shrimp,\n       aes(x = temperature, y = respiration)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![A default scatter plot of the relationship between temperature and respiration rate in brine shrimp is enough for us to see that respiration rate seems to increase with temperature approximately linearly.](single_linear_regression_files/figure-html/fig-shrimp-rough-1.png){#fig-shrimp-rough width=576}\n:::\n:::\n\n\n\n\nThe figure suggests that respiration rate increases with temperature and\nthere are no particularly extreme values. We can also see that any\nrelationship is roughly linear.\n\n### Do a regression with `lm()`\n\nWe can create a single linear regression model like this:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- lm(data = shrimp, respiration ~ temperature)\n```\n:::\n\n\n\n\nAnd examine the model with:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(mod)\n## \n## Call:\n## lm(formula = respiration ~ temperature, data = shrimp)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -1.7880 -0.8780 -0.1773  0.9393  1.8620 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   4.8613     1.1703   4.154  0.00113 ** \n## temperature   0.9227     0.1126   8.194 1.72e-06 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 1.234 on 13 degrees of freedom\n## Multiple R-squared:  0.8378,\tAdjusted R-squared:  0.8253 \n## F-statistic: 67.13 on 1 and 13 DF,  p-value: 1.719e-06\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\nWhat do all these results mean?\n\nThe `Estimate` in the `Coefficients` table give:\n\n-   the `(Intercept)` known as $\\beta_0$, which is the value of the *y*\n    (the response) when the value of *x* (the explanatory) is zero.\n\n-   the slope labelled `temperature` known as $\\beta_1$, which is the\n    amount of *y* you add for each unit of *x*. `temperature` is\n    positive so respiration rate increases with temperature\n\n@fig-regression-lm-model shows the model and its parameters.\n\nThe *p*-values on each line are tests of whether that coefficient is\ndifferent from zero. Thus it is:\n\n`temperature  0.91850    0.09182  10.003 1.79e-07 ***`\n\nthat tells us the slope is significantly different from zero and thus\nthere *is* a significant relationship between temperature and\nrespiration rate.\n\nThe *F* value and *p*-value in the last line are a test of whether the\nmodel as a whole explains a significant amount of variation in the\nresponse variable. For a regression, this is exactly equivalent to the\ntest of the slope against zero and the two *p*-values will be the same.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![In a linear model, the first estimate is the intercept and the second estimate is the 'slope'.](single_linear_regression_files/figure-html/fig-regression-lm-model-1.png){#fig-regression-lm-model width=576}\n:::\n:::\n\n\n\n\n### Check assumptions\n\nCheck the assumptions: All general linear models assume the \"residuals\"\nare normally distributed and have \"homogeneity\" of variance.\n\nOur first check of these assumptions is to use common sense: respiration\nis a continuous variable and we would expect it to be normally\ndistributed thus we would expect the residuals to be normally\ndistributed\n\nWe then proceed by plotting residuals. The `plot()` function can be used\nto plot the residuals against the fitted values (See\n@fig-regression-plot1). This is a good way to check for homogeneity of\nvariance.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(mod, which = 1)\n```\n\n::: {.cell-output-display}\n![A plot of the residuals against the fitted values shows no obvious pattern as the points are roughly evenly distributed around the line. This is a good sign for the assumption of homogeneity of variance.](single_linear_regression_files/figure-html/fig-regression-plot1-1.png){#fig-regression-plot1 width=576}\n:::\n:::\n\n\n\n\nWe can also use a histogram to check for normality (See\n@fig-regression-plot2).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mapping = aes(x = mod$residuals)) + \n  geom_histogram(bins = 5)\n```\n\n::: {.cell-output-display}\n![A histogram of residuals is symetrical and seems consistent with a normal distribution. This is a good sign for the assumption of normally distributed residuals.](single_linear_regression_files/figure-html/fig-regression-plot2-1.png){#fig-regression-plot2 width=576}\n:::\n:::\n\n\n\n\nFinally, we can use the Shapiro-Wilk test to test for normality.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mod$residuals)\n## \n## \tShapiro-Wilk normality test\n## \n## data:  mod$residuals\n## W = 0.95115, p-value = 0.5428\n```\n:::\n\n\n\n\nThe p-value is greater than 0.05 so this test of the normality\nassumption is not significant. Note that \"not significant\" means not\nsignificantly different from a normal distribution. It does not mean\ndefinitely normally distributed.\n\nTaken together, these results suggest that the assumptions of normality\nand homogeneity of variance are not violated.\n\n### Report\n\nThe temperature explained a significant amount of the variation in\nrespiration rate (ANOVA: *F* = 67; *d.f*. = 1, 13; *p* \\< 0.001). The\nregression line is: Respiration rate = 4.86 + 0.92 \\* temperature.\nSee @fig-shrimp.\n\n::: {#fig-shrimp}\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = shrimp, \n                aes(x = temperature, y = respiration)) +\n  geom_point(size = 2) +   \n  geom_smooth(method = \"lm\", \n              se = FALSE,\n              colour = \"black\") +\n  scale_x_continuous(expand = c(0,0),\n                     limits = c(0, 15.5),\n                      name = \"Temperature (C)\") +\n  scale_y_continuous(expand = c(0,0), \n                     limits = c(0, 20),\n                     name = \"Respiration (units)\") +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](single_linear_regression_files/figure-html/unnamed-chunk-12-1.png){width=576}\n:::\n:::\n\n\n\n\n**Respiration rate of *Artemia salina* increases with temperature**.\nThree replicate water baths were set up at each of five temperatures\n(10, 11C, 12C, 13C, 14C). Ten Brine Shrimp (*Artemia salina*) were\nplaced in each and their average respiration rate per water bath was\nmeasured. There was a significant effect of altering water bath\ntemperature on the average respiration rate (ANOVA: *F* = 67; *d.f*. =\n1, 13; *p* \\< 0.001). The regression line is: Respiration rate =\n4.86 + 0.92 \\* temperature. Data analysis was conducted in R\n[@R-core] with tidyverse packages [@tidyverse].\n:::\n\n## Summary\n\n1.  Single linear regression is an appropriate when you have one\n    continuous explanatory variable and one continuous response and the\n    relationship between the two is linear.\n\n2.  Applying a single linear regression to data means putting a line of\n    best fit through it. We estimate the **coefficients** (also called \n    the **parameters**) of the model. These are the intercept, $\\beta_0$,\n    and the slope, $\\beta_1$. We test whether the parameters differ\n    significantly from zero\n\n3.  We can use `lm()` to a linear regression.\n\n4.  In the output of `lm()` the coefficients are listed in a table in the\n    Estimates column. The *p*-value for each coefficient is in the test \n    of whether it differs from zero. At the bottom of the output there \n    is a test of the model *overall*. In a single linear regression this\n    is exactly the same as the test of the $\\beta_1$ and the p-values are \n    identical. The R-squared value is the proportion of the variance\n    in the response variable that is explained by the model.\n\n5.  The assumptions of the general linear model are that the residuals\n    are normally distributed and have homogeneity of variance. A\n    residual is the difference between the predicted value and the\n    observed value.\n\n6.  We examine a histogram of the residuals and use the Shapiro-Wilk\n    normality test to check the normality assumption. We check the\n    variance of the residuals is the same for all fitted values with a\n    residuals vs fitted plot.\n\n7.  If the assumptions are not met, we might need to transform the data\n    or use a different type of model.\n\n8.  When reporting the results of a regression we give the significance,\n    direction and size of the effect. Often we give the equation of the\n    best fitting line. A Figure should show the data and the line of\n    best fit.\n",
    "supporting": [
      "single_linear_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}