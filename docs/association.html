<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>18&nbsp; Association: Correlation and Contingency – Computational Analysis for Bioscientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./goodness-of-fit.html" rel="next">
<link href="./two-way-anova.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2ee26349945d0c4eadaece612797c059.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-7a3e59189d9f0ecca6f4f741a2329820.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2ee26349945d0c4eadaece612797c059.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-235ce19765b56125a6539188bd174cdb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-45c5d498b08e9400af60c638f13658fe.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-235ce19765b56125a6539188bd174cdb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical-analysis-1.html">Statistical Analysis in R - Part 1</a></li><li class="breadcrumb-item"><a href="./association.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Analysis for Bioscientists</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/3mmaRand/comp4biosci" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About this book</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./what-they-forgot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What they forgot to teach you about computers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-and-os.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Machines and operating systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./file-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding file systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organising-work.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Organising your work</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./getting-started-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with data analysis in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ideas-about-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ideas about data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about-R-and-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">About R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first-steps-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">First Steps in RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Workflow in RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import-to-report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">From importing to reporting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./recording-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Recording experiemental data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistical-analysis-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Analysis in R - Part 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logic-hyopthesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The logic of hyothesis testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence-intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what-statistical-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">What is a statistical model?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./single-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Single linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-sample-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Two-Sample tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one-way-anova-and-kw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">One-way ANOVA and Kruskal-Wallis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Two-way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./association.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goodness-of-fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Goodness of fit</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./working-with-gel-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Gel data in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PCR-product-verification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Agarose gels for PCR product verfication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./molecular-weight-from-western-blot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Finding the molecular weight of proteins migrated on a western blot</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./in-development.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">In development</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26C-food-fuel-prac2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title"><em>Pseudomonas putida</em> grown in two soil types at two temperatures</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./keyboard-shortcuts-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Keyboard short cuts and other tips</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">18.1</span> Overview</a>
  <ul class="collapse">
<li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">18.1.1</span> Correlation</a></li>
  </ul>
</li>
  <li>
<a href="#correlation-examples" id="toc-correlation-examples" class="nav-link" data-scroll-target="#correlation-examples"><span class="header-section-number">18.2</span> Correlation Examples</a>
  <ul class="collapse">
<li><a href="#contingency-chi-squared" id="toc-contingency-chi-squared" class="nav-link" data-scroll-target="#contingency-chi-squared"><span class="header-section-number">18.2.1</span> Contingency Chi-squared</a></li>
  <li><a href="#reporting" id="toc-reporting" class="nav-link" data-scroll-target="#reporting"><span class="header-section-number">18.2.2</span> Reporting</a></li>
  </ul>
</li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn"><span class="header-section-number">18.3</span> 🎬 Your turn!</a></li>
  <li>
<a href="#correlation-1" id="toc-correlation-1" class="nav-link" data-scroll-target="#correlation-1"><span class="header-section-number">18.4</span> Correlation</a>
  <ul class="collapse">
<li><a href="#import-and-explore" id="toc-import-and-explore" class="nav-link" data-scroll-target="#import-and-explore"><span class="header-section-number">18.4.1</span> Import and explore</a></li>
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">18.4.2</span> Check assumptions</a></li>
  <li><a href="#do-a-pearsons-correlation-test-with-cor.test" id="toc-do-a-pearsons-correlation-test-with-cor.test" class="nav-link" data-scroll-target="#do-a-pearsons-correlation-test-with-cor.test"><span class="header-section-number">18.4.3</span> Do a Pearson’s correlation test with <code>cor.test()</code></a></li>
  <li><a href="#report" id="toc-report" class="nav-link" data-scroll-target="#report"><span class="header-section-number">18.4.4</span> Report</a></li>
  <li><a href="#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient" class="nav-link" data-scroll-target="#spearmans-rank-correlation-coefficient"><span class="header-section-number">18.4.5</span> Spearman’s rank correlation coefficient</a></li>
  <li><a href="#import-and-explore-1" id="toc-import-and-explore-1" class="nav-link" data-scroll-target="#import-and-explore-1"><span class="header-section-number">18.4.6</span> Import and explore</a></li>
  <li><a href="#do-a-spearmans-rank-correlation-test-with-cor.test" id="toc-do-a-spearmans-rank-correlation-test-with-cor.test" class="nav-link" data-scroll-target="#do-a-spearmans-rank-correlation-test-with-cor.test"><span class="header-section-number">18.4.7</span> Do a Spearman’s rank correlation test with <code>cor.test()</code></a></li>
  <li><a href="#report-1" id="toc-report-1" class="nav-link" data-scroll-target="#report-1"><span class="header-section-number">18.4.8</span> Report</a></li>
  </ul>
</li>
  <li>
<a href="#contingency-chi-squared-test" id="toc-contingency-chi-squared-test" class="nav-link" data-scroll-target="#contingency-chi-squared-test"><span class="header-section-number">18.5</span> Contingency Chi-squared test</a>
  <ul class="collapse">
<li><a href="#report-2" id="toc-report-2" class="nav-link" data-scroll-target="#report-2"><span class="header-section-number">18.5.1</span> Report</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">18.6</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/association.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://github.com/3mmaRand/comp4biosci/issues/new
?title={{< meta title >}}
&amp;body={{< meta book.site-url >}}{{< meta book.html.page-url-path >}}
"><i class="bi bi-bug"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical-analysis-1.html">Statistical Analysis in R - Part 1</a></li><li class="breadcrumb-item"><a href="./association.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-association" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Draft
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are reading a live document. This page is a draft but is mainly complete should be readable.</p>
</div>
</div>
<section id="overview" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">18.1</span> Overview</h2>
<p>Up to this point, we have focused on methods that examine how one variable affects another. <strong>Regression</strong> allowed us to model a relationship where one variable was explicitly treated as explanatory and the other as a response. Similarly, <strong>ANOVA and two-sample tests</strong> compared groups to see if a categorical explanatory variable influenced a numeric response.</p>
<p>In this chapter, we shift our focus to situations where <strong>no causal relationship is assumed</strong>. Instead of asking whether one variable predicts another, we ask whether two variables are <strong>associated</strong> - whether they tend to change together.</p>
<p>We will cover:</p>
<ul>
<li>
<strong>Pearson’s correlation</strong>, which measures how strongly two continuous variables change together in a linear way.</li>
<li>
<strong>Spearman’s correlation</strong>, a non-parametric alternative</li>
<li>
<strong>Chi-square tests for contingency tables</strong>, which assess whether two categorical variables are related.</li>
</ul>
<p>Unlike regression, these methods do not imply that one variable influences the other - they simply measure the strength of an association. This allows us to explore patterns in data when no clear explanatory-response relationship exists.</p>
<section id="correlation" class="level3" data-number="18.1.1"><h3 data-number="18.1.1" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">18.1.1</span> Correlation</h3>
<p>When working with two continuous variables, we may be interested in understanding how they are associated without assuming a cause-and-effect relationship. Unlike regression, where one variable is treated as explanatory and the other as a response, correlation simply measures the strength and direction of their association.</p>
<p>The correlation coefficient quantifies this relationship on a scale from -1 to 1. A coefficient of 1 indicates a perfect positive association, meaning that higher values in one variable are always linked to higher values in the other. Conversely, a coefficient of -1 represents a perfect negative association, where higher values in one variable are consistently associated with lower values in the other. Most real-world correlations fall somewhere between these extremes, with values closer to 0 suggesting little to no linear relationship (<a href="#fig-correl-types" class="quarto-xref">Figure&nbsp;<span>18.1</span></a>).</p>
<p>By calculating the correlation coefficient, we can assess how strongly two variables move together, helping us uncover patterns in data without implying causation.</p>
</section></section><section id="correlation-examples" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="correlation-examples">
<span class="header-section-number">18.2</span> Correlation Examples</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-correl-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correl-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="association_files/figure-html/fig-correl-types-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;18.1: Scatter plots demonstrating different types of correlation. Left: A strong positive correlation (r ≈ 0.8), where higher values in one variable are associated with higher values in the other. Middle: A strong negative correlation (r ≈ -0.8), where higher values in one variable are associated with lower values in the other. Right: No correlation (r ≈ 0), indicating no clear pattern between the two variables."><img src="association_files/figure-html/fig-correl-types-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correl-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.1: Scatter plots demonstrating different types of correlation. Left: A strong positive correlation (r ≈ 0.8), where higher values in one variable are associated with higher values in the other. Middle: A strong negative correlation (r ≈ -0.8), where higher values in one variable are associated with lower values in the other. Right: No correlation (r ≈ 0), indicating no clear pattern between the two variables.
</figcaption></figure>
</div>
</div>
</div>
<p>We estimate the population correlation coefficient, <span class="math inline">\(\rho\)</span> (pronounced rho), with the sample correlation coefficient, <span class="math inline">\(r\)</span> and test whether it is significantly different from zero because a correlation coefficient of 0 means association.</p>
<p>Pearson’s correlation coefficient, is a parametric measure which assumes the variables are normally distributed and that any correlation is linear.</p>
<p>Spearman’s rank correlation coefficient, is a non-parametric measure which does not assume the variables are normally distributed or a strict linear association. It is also less sensitive to outliers.</p>
<p>We use <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> in R for both types of correlation.</p>
<section id="contingency-chi-squared" class="level3" data-number="18.2.1"><h3 data-number="18.2.1" class="anchored" data-anchor-id="contingency-chi-squared">
<span class="header-section-number">18.2.1</span> Contingency Chi-squared</h3>
<ul>
<li><p>two categorical variables</p></li>
<li><p>neither is an explanatory variable, i.e., there is not a causal relationship between the two variables</p></li>
<li><p>we count the number of observations in each caetory of each variable</p></li>
<li><p>you want to know if there is an association between the two variables</p></li>
<li><p>another way of describing this is that we test whether the proportion of observations falling in to each category of one variable is the same for each category of the other variable.</p></li>
<li><p>we use a chi-squared test to test whether the observed counts are significantly different from the expected counts if there was no association between the variables.</p></li>
</ul></section><section id="reporting" class="level3" data-number="18.2.2"><h3 data-number="18.2.2" class="anchored" data-anchor-id="reporting">
<span class="header-section-number">18.2.2</span> Reporting</h3>
<ol type="1">
<li><p>the significance of effect - whether the association is significant different from zero</p></li>
<li>
<p>the direction of effect</p>
<ul>
<li>correlation whether <span class="math inline">\(r\)</span> is positive or negative</li>
<li>which categories have higher than expected values</li>
</ul>
</li>
<li><p>the magnitude of effect</p></li>
</ol>
<p>We do not put a line of best fit on a scatter plot accompanying a correlation because such a line implies a causal relationship.</p>
<p>We will explore all of these ideas with an examples.</p>
</section></section><section id="your-turn" class="level2" data-number="18.3"><h2 data-number="18.3" class="anchored" data-anchor-id="your-turn">
<span class="header-section-number">18.3</span> 🎬 Your turn!</h2>
<p>If you want to code along you will need to start a new <a href="workflow_rstudio.html#rstudio-projects">RStudio project</a>, add a <code>data-raw</code> folder and open a new script. You will also need to load the <strong><code>tidyverse</code></strong> package <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>.</p>
</section><section id="correlation-1" class="level2" data-number="18.4"><h2 data-number="18.4" class="anchored" data-anchor-id="correlation-1">
<span class="header-section-number">18.4</span> Correlation</h2>
<p>High quality images of the internal structure of wheat seeds were taken with a soft X-ray technique. Seven measurements determined from the images:</p>
<ul>
<li>Area</li>
<li>Perimeter</li>
<li>Compactness</li>
<li>Kernel length</li>
<li>Kernel width</li>
<li>Asymmetry coefficient</li>
<li>Length of kernel groove</li>
</ul>
<p>Research were interested in the correlation between compactness and kernel width</p>
<p>The data are in <a href="data-raw/seeds-dataset.xlsx">seeds-dataset.xlsx</a>.</p>
<section id="import-and-explore" class="level3" data-number="18.4.1"><h3 data-number="18.4.1" class="anchored" data-anchor-id="import-and-explore">
<span class="header-section-number">18.4.1</span> Import and explore</h3>
<p>The data are in an excel file so we will need the <strong><code>readxl</code></strong> <span class="citation" data-cites="readxl">(<a href="references.html#ref-readxl" role="doc-biblioref">Wickham and Bryan 2025</a>)</span> package.</p>
<p>Load the package:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find out the names of the sheets in the excel file:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">"data-raw/seeds-dataset.xlsx"</span><span class="op">)</span></span>
<span><span class="co">## [1] "seeds_dataset"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is only one sheet called <code>seeds_dataset</code>.</p>
<p>Import the data:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data-raw/seeds-dataset.xlsx"</span>,</span>
<span>                    sheet <span class="op">=</span> <span class="st">"seeds_dataset"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that we could have omitted the <code>sheet</code> argument because there is only one sheet in the Excel file. However, it is good practice to be explicit.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">area</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perimeter</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">compactness</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">kernal_length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">kernel_width</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">asymmetry_coef</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">groove_length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">15.26</td>
<td style="text-align: right;">14.84</td>
<td style="text-align: right;">0.8710</td>
<td style="text-align: right;">5.763</td>
<td style="text-align: right;">3.312</td>
<td style="text-align: right;">2.2210</td>
<td style="text-align: right;">5.220</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.88</td>
<td style="text-align: right;">14.57</td>
<td style="text-align: right;">0.8811</td>
<td style="text-align: right;">5.554</td>
<td style="text-align: right;">3.333</td>
<td style="text-align: right;">1.0180</td>
<td style="text-align: right;">4.956</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.29</td>
<td style="text-align: right;">14.09</td>
<td style="text-align: right;">0.9050</td>
<td style="text-align: right;">5.291</td>
<td style="text-align: right;">3.337</td>
<td style="text-align: right;">2.6990</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">13.94</td>
<td style="text-align: right;">0.8955</td>
<td style="text-align: right;">5.324</td>
<td style="text-align: right;">3.379</td>
<td style="text-align: right;">2.2590</td>
<td style="text-align: right;">4.805</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.14</td>
<td style="text-align: right;">14.99</td>
<td style="text-align: right;">0.9034</td>
<td style="text-align: right;">5.658</td>
<td style="text-align: right;">3.562</td>
<td style="text-align: right;">1.3550</td>
<td style="text-align: right;">5.175</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.38</td>
<td style="text-align: right;">14.21</td>
<td style="text-align: right;">0.8951</td>
<td style="text-align: right;">5.386</td>
<td style="text-align: right;">3.312</td>
<td style="text-align: right;">2.4620</td>
<td style="text-align: right;">4.956</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.69</td>
<td style="text-align: right;">14.49</td>
<td style="text-align: right;">0.8799</td>
<td style="text-align: right;">5.563</td>
<td style="text-align: right;">3.259</td>
<td style="text-align: right;">3.5860</td>
<td style="text-align: right;">5.219</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.10</td>
<td style="text-align: right;">0.8911</td>
<td style="text-align: right;">5.420</td>
<td style="text-align: right;">3.302</td>
<td style="text-align: right;">2.7000</td>
<td style="text-align: right;">5.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.63</td>
<td style="text-align: right;">15.46</td>
<td style="text-align: right;">0.8747</td>
<td style="text-align: right;">6.053</td>
<td style="text-align: right;">3.465</td>
<td style="text-align: right;">2.0400</td>
<td style="text-align: right;">5.877</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.44</td>
<td style="text-align: right;">15.25</td>
<td style="text-align: right;">0.8880</td>
<td style="text-align: right;">5.884</td>
<td style="text-align: right;">3.505</td>
<td style="text-align: right;">1.9690</td>
<td style="text-align: right;">5.533</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.26</td>
<td style="text-align: right;">14.85</td>
<td style="text-align: right;">0.8696</td>
<td style="text-align: right;">5.714</td>
<td style="text-align: right;">3.242</td>
<td style="text-align: right;">4.5430</td>
<td style="text-align: right;">5.314</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.03</td>
<td style="text-align: right;">14.16</td>
<td style="text-align: right;">0.8796</td>
<td style="text-align: right;">5.438</td>
<td style="text-align: right;">3.201</td>
<td style="text-align: right;">1.7170</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.89</td>
<td style="text-align: right;">14.02</td>
<td style="text-align: right;">0.8880</td>
<td style="text-align: right;">5.439</td>
<td style="text-align: right;">3.199</td>
<td style="text-align: right;">3.9860</td>
<td style="text-align: right;">4.738</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.78</td>
<td style="text-align: right;">14.06</td>
<td style="text-align: right;">0.8759</td>
<td style="text-align: right;">5.479</td>
<td style="text-align: right;">3.156</td>
<td style="text-align: right;">3.1360</td>
<td style="text-align: right;">4.872</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.74</td>
<td style="text-align: right;">14.05</td>
<td style="text-align: right;">0.8744</td>
<td style="text-align: right;">5.482</td>
<td style="text-align: right;">3.114</td>
<td style="text-align: right;">2.9320</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.59</td>
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">0.8993</td>
<td style="text-align: right;">5.351</td>
<td style="text-align: right;">3.333</td>
<td style="text-align: right;">4.1850</td>
<td style="text-align: right;">4.781</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.99</td>
<td style="text-align: right;">13.83</td>
<td style="text-align: right;">0.9183</td>
<td style="text-align: right;">5.119</td>
<td style="text-align: right;">3.383</td>
<td style="text-align: right;">5.2340</td>
<td style="text-align: right;">4.781</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.69</td>
<td style="text-align: right;">14.75</td>
<td style="text-align: right;">0.9058</td>
<td style="text-align: right;">5.527</td>
<td style="text-align: right;">3.514</td>
<td style="text-align: right;">1.5990</td>
<td style="text-align: right;">5.046</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.70</td>
<td style="text-align: right;">14.21</td>
<td style="text-align: right;">0.9153</td>
<td style="text-align: right;">5.205</td>
<td style="text-align: right;">3.466</td>
<td style="text-align: right;">1.7670</td>
<td style="text-align: right;">4.649</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.72</td>
<td style="text-align: right;">13.57</td>
<td style="text-align: right;">0.8686</td>
<td style="text-align: right;">5.226</td>
<td style="text-align: right;">3.049</td>
<td style="text-align: right;">4.1020</td>
<td style="text-align: right;">4.914</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.16</td>
<td style="text-align: right;">14.40</td>
<td style="text-align: right;">0.8584</td>
<td style="text-align: right;">5.658</td>
<td style="text-align: right;">3.129</td>
<td style="text-align: right;">3.0720</td>
<td style="text-align: right;">5.176</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.26</td>
<td style="text-align: right;">0.8722</td>
<td style="text-align: right;">5.520</td>
<td style="text-align: right;">3.168</td>
<td style="text-align: right;">2.6880</td>
<td style="text-align: right;">5.219</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.88</td>
<td style="text-align: right;">14.90</td>
<td style="text-align: right;">0.8988</td>
<td style="text-align: right;">5.618</td>
<td style="text-align: right;">3.507</td>
<td style="text-align: right;">0.7651</td>
<td style="text-align: right;">5.091</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.08</td>
<td style="text-align: right;">13.23</td>
<td style="text-align: right;">0.8664</td>
<td style="text-align: right;">5.099</td>
<td style="text-align: right;">2.936</td>
<td style="text-align: right;">1.4150</td>
<td style="text-align: right;">4.961</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.01</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">0.8657</td>
<td style="text-align: right;">5.789</td>
<td style="text-align: right;">3.245</td>
<td style="text-align: right;">1.7910</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.19</td>
<td style="text-align: right;">15.16</td>
<td style="text-align: right;">0.8849</td>
<td style="text-align: right;">5.833</td>
<td style="text-align: right;">3.421</td>
<td style="text-align: right;">0.9030</td>
<td style="text-align: right;">5.307</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.02</td>
<td style="text-align: right;">13.76</td>
<td style="text-align: right;">0.8641</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">3.026</td>
<td style="text-align: right;">3.3730</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.74</td>
<td style="text-align: right;">13.67</td>
<td style="text-align: right;">0.8564</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">2.956</td>
<td style="text-align: right;">2.5040</td>
<td style="text-align: right;">4.869</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.18</td>
<td style="text-align: right;">0.8820</td>
<td style="text-align: right;">5.541</td>
<td style="text-align: right;">3.221</td>
<td style="text-align: right;">2.7540</td>
<td style="text-align: right;">5.038</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.45</td>
<td style="text-align: right;">14.02</td>
<td style="text-align: right;">0.8604</td>
<td style="text-align: right;">5.516</td>
<td style="text-align: right;">3.065</td>
<td style="text-align: right;">3.5310</td>
<td style="text-align: right;">5.097</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.16</td>
<td style="text-align: right;">13.82</td>
<td style="text-align: right;">0.8662</td>
<td style="text-align: right;">5.454</td>
<td style="text-align: right;">2.975</td>
<td style="text-align: right;">0.8551</td>
<td style="text-align: right;">5.056</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.49</td>
<td style="text-align: right;">14.94</td>
<td style="text-align: right;">0.8724</td>
<td style="text-align: right;">5.757</td>
<td style="text-align: right;">3.371</td>
<td style="text-align: right;">3.4120</td>
<td style="text-align: right;">5.228</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.09</td>
<td style="text-align: right;">14.41</td>
<td style="text-align: right;">0.8529</td>
<td style="text-align: right;">5.717</td>
<td style="text-align: right;">3.186</td>
<td style="text-align: right;">3.9200</td>
<td style="text-align: right;">5.299</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.94</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">0.8728</td>
<td style="text-align: right;">5.585</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">2.1240</td>
<td style="text-align: right;">5.012</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.05</td>
<td style="text-align: right;">14.68</td>
<td style="text-align: right;">0.8779</td>
<td style="text-align: right;">5.712</td>
<td style="text-align: right;">3.328</td>
<td style="text-align: right;">2.1290</td>
<td style="text-align: right;">5.360</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.12</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">0.9000</td>
<td style="text-align: right;">5.709</td>
<td style="text-align: right;">3.485</td>
<td style="text-align: right;">2.2700</td>
<td style="text-align: right;">5.443</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.20</td>
<td style="text-align: right;">15.27</td>
<td style="text-align: right;">0.8734</td>
<td style="text-align: right;">5.826</td>
<td style="text-align: right;">3.464</td>
<td style="text-align: right;">2.8230</td>
<td style="text-align: right;">5.527</td>
</tr>
<tr class="even">
<td style="text-align: right;">17.08</td>
<td style="text-align: right;">15.38</td>
<td style="text-align: right;">0.9079</td>
<td style="text-align: right;">5.832</td>
<td style="text-align: right;">3.683</td>
<td style="text-align: right;">2.9560</td>
<td style="text-align: right;">5.484</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.80</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">0.8823</td>
<td style="text-align: right;">5.656</td>
<td style="text-align: right;">3.288</td>
<td style="text-align: right;">3.1120</td>
<td style="text-align: right;">5.309</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">0.8944</td>
<td style="text-align: right;">5.397</td>
<td style="text-align: right;">3.298</td>
<td style="text-align: right;">6.6850</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.54</td>
<td style="text-align: right;">13.85</td>
<td style="text-align: right;">0.8871</td>
<td style="text-align: right;">5.348</td>
<td style="text-align: right;">3.156</td>
<td style="text-align: right;">2.5870</td>
<td style="text-align: right;">5.178</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">13.85</td>
<td style="text-align: right;">0.8852</td>
<td style="text-align: right;">5.351</td>
<td style="text-align: right;">3.158</td>
<td style="text-align: right;">2.2490</td>
<td style="text-align: right;">5.176</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.16</td>
<td style="text-align: right;">13.55</td>
<td style="text-align: right;">0.9009</td>
<td style="text-align: right;">5.138</td>
<td style="text-align: right;">3.201</td>
<td style="text-align: right;">2.4610</td>
<td style="text-align: right;">4.783</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">14.86</td>
<td style="text-align: right;">0.8820</td>
<td style="text-align: right;">5.877</td>
<td style="text-align: right;">3.396</td>
<td style="text-align: right;">4.7110</td>
<td style="text-align: right;">5.528</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.11</td>
<td style="text-align: right;">14.54</td>
<td style="text-align: right;">0.8986</td>
<td style="text-align: right;">5.579</td>
<td style="text-align: right;">3.462</td>
<td style="text-align: right;">3.1280</td>
<td style="text-align: right;">5.180</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.80</td>
<td style="text-align: right;">14.04</td>
<td style="text-align: right;">0.8794</td>
<td style="text-align: right;">5.376</td>
<td style="text-align: right;">3.155</td>
<td style="text-align: right;">1.5600</td>
<td style="text-align: right;">4.961</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.36</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">0.8861</td>
<td style="text-align: right;">5.701</td>
<td style="text-align: right;">3.393</td>
<td style="text-align: right;">1.3670</td>
<td style="text-align: right;">5.132</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.99</td>
<td style="text-align: right;">14.56</td>
<td style="text-align: right;">0.8883</td>
<td style="text-align: right;">5.570</td>
<td style="text-align: right;">3.377</td>
<td style="text-align: right;">2.9580</td>
<td style="text-align: right;">5.175</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.79</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">0.8819</td>
<td style="text-align: right;">5.545</td>
<td style="text-align: right;">3.291</td>
<td style="text-align: right;">2.7040</td>
<td style="text-align: right;">5.111</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.86</td>
<td style="text-align: right;">14.67</td>
<td style="text-align: right;">0.8676</td>
<td style="text-align: right;">5.678</td>
<td style="text-align: right;">3.258</td>
<td style="text-align: right;">2.1290</td>
<td style="text-align: right;">5.351</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">14.40</td>
<td style="text-align: right;">0.8751</td>
<td style="text-align: right;">5.585</td>
<td style="text-align: right;">3.272</td>
<td style="text-align: right;">3.9750</td>
<td style="text-align: right;">5.144</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.78</td>
<td style="text-align: right;">14.91</td>
<td style="text-align: right;">0.8923</td>
<td style="text-align: right;">5.674</td>
<td style="text-align: right;">3.434</td>
<td style="text-align: right;">5.5930</td>
<td style="text-align: right;">5.136</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.49</td>
<td style="text-align: right;">14.61</td>
<td style="text-align: right;">0.8538</td>
<td style="text-align: right;">5.715</td>
<td style="text-align: right;">3.113</td>
<td style="text-align: right;">4.1160</td>
<td style="text-align: right;">5.396</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.33</td>
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">0.8831</td>
<td style="text-align: right;">5.504</td>
<td style="text-align: right;">3.199</td>
<td style="text-align: right;">3.3280</td>
<td style="text-align: right;">5.224</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">14.60</td>
<td style="text-align: right;">0.8557</td>
<td style="text-align: right;">5.741</td>
<td style="text-align: right;">3.113</td>
<td style="text-align: right;">1.4810</td>
<td style="text-align: right;">5.487</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.03</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">0.8658</td>
<td style="text-align: right;">5.702</td>
<td style="text-align: right;">3.212</td>
<td style="text-align: right;">1.9330</td>
<td style="text-align: right;">5.439</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.46</td>
<td style="text-align: right;">14.35</td>
<td style="text-align: right;">0.8818</td>
<td style="text-align: right;">5.388</td>
<td style="text-align: right;">3.377</td>
<td style="text-align: right;">2.8020</td>
<td style="text-align: right;">5.044</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.92</td>
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">0.9006</td>
<td style="text-align: right;">5.384</td>
<td style="text-align: right;">3.412</td>
<td style="text-align: right;">1.1420</td>
<td style="text-align: right;">5.088</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.38</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">0.8857</td>
<td style="text-align: right;">5.662</td>
<td style="text-align: right;">3.419</td>
<td style="text-align: right;">1.9990</td>
<td style="text-align: right;">5.222</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.11</td>
<td style="text-align: right;">13.47</td>
<td style="text-align: right;">0.8392</td>
<td style="text-align: right;">5.159</td>
<td style="text-align: right;">3.032</td>
<td style="text-align: right;">1.5020</td>
<td style="text-align: right;">4.519</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.42</td>
<td style="text-align: right;">12.86</td>
<td style="text-align: right;">0.8683</td>
<td style="text-align: right;">5.008</td>
<td style="text-align: right;">2.850</td>
<td style="text-align: right;">2.7000</td>
<td style="text-align: right;">4.607</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.23</td>
<td style="text-align: right;">12.63</td>
<td style="text-align: right;">0.8840</td>
<td style="text-align: right;">4.902</td>
<td style="text-align: right;">2.879</td>
<td style="text-align: right;">2.2690</td>
<td style="text-align: right;">4.703</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.36</td>
<td style="text-align: right;">13.19</td>
<td style="text-align: right;">0.8923</td>
<td style="text-align: right;">5.076</td>
<td style="text-align: right;">3.042</td>
<td style="text-align: right;">3.2200</td>
<td style="text-align: right;">4.605</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.22</td>
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">0.8680</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">3.070</td>
<td style="text-align: right;">4.1570</td>
<td style="text-align: right;">5.088</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.78</td>
<td style="text-align: right;">13.57</td>
<td style="text-align: right;">0.8716</td>
<td style="text-align: right;">5.262</td>
<td style="text-align: right;">3.026</td>
<td style="text-align: right;">1.1760</td>
<td style="text-align: right;">4.782</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.88</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">0.8879</td>
<td style="text-align: right;">5.139</td>
<td style="text-align: right;">3.119</td>
<td style="text-align: right;">2.3520</td>
<td style="text-align: right;">4.607</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.34</td>
<td style="text-align: right;">14.37</td>
<td style="text-align: right;">0.8726</td>
<td style="text-align: right;">5.630</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">1.3130</td>
<td style="text-align: right;">5.150</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.01</td>
<td style="text-align: right;">14.29</td>
<td style="text-align: right;">0.8625</td>
<td style="text-align: right;">5.609</td>
<td style="text-align: right;">3.158</td>
<td style="text-align: right;">2.2170</td>
<td style="text-align: right;">5.132</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.37</td>
<td style="text-align: right;">14.39</td>
<td style="text-align: right;">0.8726</td>
<td style="text-align: right;">5.569</td>
<td style="text-align: right;">3.153</td>
<td style="text-align: right;">1.4640</td>
<td style="text-align: right;">5.300</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.73</td>
<td style="text-align: right;">13.75</td>
<td style="text-align: right;">0.8458</td>
<td style="text-align: right;">5.412</td>
<td style="text-align: right;">2.882</td>
<td style="text-align: right;">3.5330</td>
<td style="text-align: right;">5.067</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These data are formatted usefully for analysis using correlation and plotting. Each row is a different seed and the columns are the variables we are interested. This means that the first values in each column are related - they are all from the same seed</p>
<p>In the first instance, it is sensible to create a rough plot of our data (See <a href="#fig-seeds-rough" class="quarto-xref">Figure&nbsp;<span>18.2</span></a>). Plotting data early helps us in multiple ways:</p>
<ul>
<li>it helps identify whether there extreme values</li>
<li>it allows us to see if the association is roughly linear</li>
<li>it tells us whether any association positive or negative</li>
</ul>
<p>Scatter plots (<code>geom_point()</code>) are a good choice for exploratory plotting with data like these.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span>, y <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-seeds-rough" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-seeds-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="association_files/figure-html/fig-seeds-rough-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;18.2: A default scatter plot of compactness and kernel width in seeds demonstrates an approximately linear positive association between them."><img src="association_files/figure-html/fig-seeds-rough-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seeds-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.2: A default scatter plot of compactness and kernel width in seeds demonstrates an approximately linear positive association between them.
</figcaption></figure>
</div>
</div>
</div>
<p>The figure suggests that there is a positive correlation between <code>compactness</code> and <code>kernel_width</code> and that correlation is roughly linear.</p>
</section><section id="check-assumptions" class="level3" data-number="18.4.2"><h3 data-number="18.4.2" class="anchored" data-anchor-id="check-assumptions">
<span class="header-section-number">18.4.2</span> Check assumptions</h3>
<p>We can see from <a href="#fig-seeds-rough" class="quarto-xref">Figure&nbsp;<span>18.2</span></a> that the relationship between <code>compactness</code> and <code>kernel_width</code> is roughly linear. This is a good sign for using Pearson’s correlation coefficient.</p>
<p>Our next check is to use common sense: both variables are continuous and we would expect them to be normally distributed. We can then plot histograms to examine the distributions (See <a href="#fig-hist" class="quarto-xref">Figure&nbsp;<span>18.3</span></a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hist" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-hist-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="association_files/figure-html/fig-hist-1.png" class="lightbox" data-gallery="fig-hist" title="Figure&nbsp;18.3&nbsp;(a): Compactness"><img src="association_files/figure-html/fig-hist-1.png" class="img-fluid figure-img" data-ref-parent="fig-hist" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Compactness
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-hist-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hist-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="association_files/figure-html/fig-hist-2.png" class="lightbox" data-gallery="fig-hist" title="Figure&nbsp;18.3&nbsp;(b): Kernel width"><img src="association_files/figure-html/fig-hist-2.png" class="img-fluid figure-img" data-ref-parent="fig-hist" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Kernel width
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.3: The distributions of the two variables are slightly skewed but do not seem too different from a normal distribution. We will continue with the Pearson’s correlation coefficient.
</figcaption></figure>
</div>
<p>The distributions of the two variables are slightly skewed but do not seem too different from a normal distribution.</p>
<p>Finally, we can use the Shapiro-Wilk test to test for normality.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">$</span><span class="va">compactness</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  seeds$compactness</span></span>
<span><span class="co">## W = 0.99484, p-value = 0.9937</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">$</span><span class="va">kernel_width</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  seeds$kernel_width</span></span>
<span><span class="co">## W = 0.98989, p-value = 0.8486</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>p</em>-values are greater than 0.05 so these tests of the normality assumption are not significant. Note that “not significant” means not significantly different from a normal distribution. It does not mean definitely normally distributed.</p>
<p>It is not unreasonable to continue with the Pearson’s correlation coefficient. However, later we will also use the Spearman’s rank correlation coefficient, a non-parametric method which has fewer assumptions. Spearman’s rank correlation is a more conservative approach.</p>
</section><section id="do-a-pearsons-correlation-test-with-cor.test" class="level3" data-number="18.4.3"><h3 data-number="18.4.3" class="anchored" data-anchor-id="do-a-pearsons-correlation-test-with-cor.test">
<span class="header-section-number">18.4.3</span> Do a Pearson’s correlation test with <code>cor.test()</code>
</h3>
<p>We can carry out a Pearson’s correlation test with <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> like this:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="op">~</span> <span class="va">compactness</span> <span class="op">+</span> <span class="va">kernel_width</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's product-moment correlation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  compactness and kernel_width</span></span>
<span><span class="co">## t = 7.3738, df = 68, p-value = 2.998e-10</span></span>
<span><span class="co">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.5117537 0.7794620</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##       cor </span></span>
<span><span class="co">## 0.6665731</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A variable is not being explained in this case so we do not need to include a response variable. Pearson’s is the default test so we do not need to specify it.</p>
<p>What do all these results mean?</p>
<p>The last line gives the correlation coefficient, <span class="math inline">\(r\)</span>, that has been estimated from the data. Here, <span class="math inline">\(r\)</span> = 0.67 which is a moderate positive correlation.</p>
<p>The fifth line tells you what test has been done: <code>alternative hypothesis: true correlation is not equal to 0</code>. That is <span class="math inline">\(H_0\)</span> is that <span class="math inline">\(\rho = 0\)</span></p>
<p>The forth line gives the test result: <code>t = 7.3738, df = 68, p-value = 2.998e-10</code></p>
<p>The <span class="math inline">\(p\)</span>-value is very much less than 0.05 so we can reject the null hypothesis and conclude there is a significant positive correlation between <code>compactness</code> and <code>kernel_width</code>.</p>
</section><section id="report" class="level3" data-number="18.4.4"><h3 data-number="18.4.4" class="anchored" data-anchor-id="report">
<span class="header-section-number">18.4.4</span> Report</h3>
<p>There was a significant positive correlation (<span class="math inline">\(r\)</span> = 0.67) between compactness and kernel width (Pearson’s: <em>t</em> = 7.374; <em>df</em> = 68; <em>p</em>-value &lt; 0.0001). See <a href="#fig-correlation-pears" class="quarto-xref">Figure&nbsp;<span>18.4</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span>, y <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Diameter (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Compactness"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.85</span>,  y <span class="op">=</span> <span class="fl">3.6</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">~</span><span class="st">"= 0.67; "</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">~</span><span class="st">"&lt; 0.001"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-correlation-pears" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-pears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="association_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;18.4: Correlation between compactness and kernel width of wheat seeds. High quality images of the internal structure of wheat seeds were taken with a soft X-ray technique and the compactness and kernel width of the seeds were determined. There was a significant positive correlation (r = 0.67) between compactness and kernel width (Pearson’s: t = 7.374; df = 68; p-value < 0.0001). Note: axes do not start at 0. Data analysis was conducted in R [@R-core] with tidyverse packages [@tidyverse]."><img src="association_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="576"></a></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-pears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.4: <strong>Correlation between compactness and kernel width of wheat seeds</strong>. High quality images of the internal structure of wheat seeds were taken with a soft X-ray technique and the compactness and kernel width of the seeds were determined. There was a significant positive correlation (<span class="math inline">\(r\)</span> = 0.67) between compactness and kernel width (Pearson’s: <em>t</em> = 7.374; <em>df</em> = 68; <em>p</em>-value &lt; 0.0001). Note: axes do not start at 0. Data analysis was conducted in R <span class="citation" data-cites="R-core">(<a href="references.html#ref-R-core" role="doc-biblioref">R Core Team 2025</a>)</span> with tidyverse packages <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>.
</figcaption></figure>
</div>
</section><section id="spearmans-rank-correlation-coefficient" class="level3" data-number="18.4.5"><h3 data-number="18.4.5" class="anchored" data-anchor-id="spearmans-rank-correlation-coefficient">
<span class="header-section-number">18.4.5</span> Spearman’s rank correlation coefficient</h3>
<p>Researchers are studying how systolic blood pressure (SBP) is associated with kidney function in patients. Chronic high blood pressure can damage the kidneys over time, leading to reduced function, which can be measured by estimated glomerular filtration rate (eGFR). SBP is measured in mmHg and represents the force of blood against artery walls when the heart beats. eGFR is estimated from from blood creatine levels in mL/min/1.73m². Lower values indicate impaired kidney filtration.</p>
<p>The data are in <a href="data-raw/blood-pressure-kidney-function.csv">blood-pressure-kidney-function.csv</a>.</p>
</section><section id="import-and-explore-1" class="level3" data-number="18.4.6"><h3 data-number="18.4.6" class="anchored" data-anchor-id="import-and-explore-1">
<span class="header-section-number">18.4.6</span> Import and explore</h3>
<p>Import the data from a csv file:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bp_kidney</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data-raw/blood-pressure-kidney-function.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">SBP</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">eGFR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">112</td>
<td style="text-align: right;">48.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">160</td>
<td style="text-align: right;">38.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">116</td>
<td style="text-align: right;">50.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">130</td>
<td style="text-align: right;">33.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">148</td>
<td style="text-align: right;">37.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">127</td>
<td style="text-align: right;">34.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">113</td>
<td style="text-align: right;">53.9</td>
</tr>
<tr class="even">
<td style="text-align: right;">169</td>
<td style="text-align: right;">2.9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">123</td>
<td style="text-align: right;">35.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">118</td>
<td style="text-align: right;">50.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">162</td>
<td style="text-align: right;">28.7</td>
</tr>
<tr class="even">
<td style="text-align: right;">111</td>
<td style="text-align: right;">54.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These data are formatted usefully for analysis using correlation and plotting. We will create a rough plot of our data (See <a href="#fig-kidney-rough" class="quarto-xref">Figure&nbsp;<span>18.5</span></a>).</p>
<p>Scatter plots (<code>geom_point()</code>) are a good choice for exploratory plotting with data like these.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">bp_kidney</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">SBP</span>, y <span class="op">=</span> <span class="va">eGFR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kidney-rough" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-kidney-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="association_files/figure-html/fig-kidney-rough-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;18.5: A default scatter plot of systolic blood pressure (SBP) and kidney function demonstrates a possible negative association between variables. It is not clear if the relationship is linear"><img src="association_files/figure-html/fig-kidney-rough-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kidney-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.5: A default scatter plot of systolic blood pressure (SBP) and kidney function demonstrates a possible negative association between variables. It is not clear if the relationship is linear
</figcaption></figure>
</div>
</div>
</div>
<p>The figure suggests that there is a negative association between <code>SBP</code> and <code>eGFR</code> but it is not clear if the association is linear.</p>
<p>Spearman’s rank correlation coefficient which does not assume a strict linear association so maybe a better choice. In addition, we might expect eGFR values to be to be skewed since indicators of disease often show step changes in values.</p>
</section><section id="do-a-spearmans-rank-correlation-test-with-cor.test" class="level3" data-number="18.4.7"><h3 data-number="18.4.7" class="anchored" data-anchor-id="do-a-spearmans-rank-correlation-test-with-cor.test">
<span class="header-section-number">18.4.7</span> Do a Spearman’s rank correlation test with <code>cor.test()</code>
</h3>
<p>We can carry out a Spearman’s rank correlation test with <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> like this:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bp_kidney</span>, <span class="op">~</span> <span class="va">SBP</span> <span class="op">+</span> <span class="va">eGFR</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Spearman's rank correlation rho</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  SBP and eGFR</span></span>
<span><span class="co">## S = 526, p-value = 0.001192</span></span>
<span><span class="co">## alternative hypothesis: true rho is not equal to 0</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##        rho </span></span>
<span><span class="co">## -0.8391608</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A variable is not being explained in this case so we do not need to include a response variable. Pearson’s is the default test so we need to specify <code>method = "spearman"</code>.</p>
<p>What do all these results mean?</p>
<p>The last line gives the correlation coefficient, <span class="math inline">\(r\)</span>, that has been estimated from the data. Here, <span class="math inline">\(r\)</span> = -0.8 which is fairly strong negative correlation.</p>
<p>The fifth line tells you what test has been done: <code>alternative hypothesis: true rho is not equal to 0</code>. That is <span class="math inline">\(H_0\)</span> is that <span class="math inline">\(\rho = 0\)</span></p>
<p>The forth line gives the test result: <code>S = 526, p-value = 0.001192</code></p>
<p>The <span class="math inline">\(p\)</span>-value is very much less than 0.05 so we can reject the null hypothesis and conclude there is a significant negative correlation between <code>SBP</code> and <code>eGFR</code>.</p>
</section><section id="report-1" class="level3" data-number="18.4.8"><h3 data-number="18.4.8" class="anchored" data-anchor-id="report-1">
<span class="header-section-number">18.4.8</span> Report</h3>
<p>. SBP is measured in mmHg and represents the force of blood against artery walls when the heart beats. eGFR is measured in</p>
<p>There was a significant positive correlation (<span class="math inline">\(r\)</span> = -0.8) between systolic blood pressure and estimated glomerular filtration rate (Spearman’s rank correlation: <em>S</em> = 526; <em>n</em> = 12; <em>p</em>-value = 0.0012). See <a href="#fig-correlation-spears" class="quarto-xref">Figure&nbsp;<span>18.6</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">bp_kidney</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">SBP</span>, y <span class="op">=</span> <span class="va">eGFR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Estimated GFR (mL/min/1.73m²)"</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">60</span><span class="op">)</span>,</span>
<span>                     expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Systolic blood pressure (mmHg)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">120</span>,  y <span class="op">=</span> <span class="fl">10</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">~</span><span class="st">"= -0.8; "</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">~</span><span class="st">"= 0.0012"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-correlation-spears" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-spears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="association_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;18.6: Correlation between Systolic blood pressure and estimated glomerular filtration rate (eGFR). Twelve patients had their Systolic blood pressure determined and GFR estimated from blood creatine levels. There was a significant negative correlation (r = -0.8) between systolic blood pressure and eGFR (Spearman’s rank correlation: S = 526; n = 12; p-value = 0.0012). Note: x-axis does not start at 0. Data analysis was conducted in R [@R-core] with tidyverse packages [@tidyverse]."><img src="association_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="576"></a></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-spears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18.6: <strong>Correlation between Systolic blood pressure and estimated glomerular filtration rate (eGFR)</strong>. Twelve patients had their Systolic blood pressure determined and GFR estimated from blood creatine levels. There was a significant negative correlation (<span class="math inline">\(r\)</span> = -0.8) between systolic blood pressure and eGFR (Spearman’s rank correlation: <em>S</em> = 526; <em>n</em> = 12; <em>p</em>-value = 0.0012). Note: <span class="math inline">\(x\)</span>-axis does not start at 0. Data analysis was conducted in R <span class="citation" data-cites="R-core">(<a href="references.html#ref-R-core" role="doc-biblioref">R Core Team 2025</a>)</span> with tidyverse packages <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>.
</figcaption></figure>
</div>
</section></section><section id="contingency-chi-squared-test" class="level2" data-number="18.5"><h2 data-number="18.5" class="anchored" data-anchor-id="contingency-chi-squared-test">
<span class="header-section-number">18.5</span> Contingency Chi-squared test</h2>
<p>Researchers were interested in whether different pig breeds had the same food preferences. They offered individuals of three breads, Welsh, Tamworth and Essex a choice of three foods: cabbage, sugar beet and swede and recorded the number of individuals that chose each food. The data are shown in <a href="#tbl-food-pref" class="quarto-xref">Table&nbsp;<span>18.1</span></a>.</p>
<div class="cell">
<div id="tbl-food-pref" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-food-pref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;18.1: Food preferences of three pig breeds
</figcaption><div aria-describedby="tbl-food-pref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Food preferences of three pig breeds</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">welsh</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tamworth</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">essex</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cabbage</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">sugarbeet</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">swede</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We don’t know what proportion of food are expected to be preferred but do expect it to be same for each breed if there is no association between breed and food preference. The null hypothesis is that the proportion of foods taken by each breed is the same.</p>
<p>For a contingency chi squared test, the inbuilt chi-squared test can be used but we need to to structure our data as a 3 x 3 table. The <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> function is useful here and we can label the rows and columns to help us interpret the results.</p>
<p>Put the data into a matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create the data</span></span>
<span><span class="va">food_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">19</span>, <span class="fl">22</span>,</span>
<span>                      <span class="fl">21</span>, <span class="fl">16</span>, <span class="fl">8</span>,</span>
<span>                      <span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>                    nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">food_pref</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   11   19   22</span></span>
<span><span class="co">## [2,]   21   16    8</span></span>
<span><span class="co">## [3,]    7   12   11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>byrow</code> and <code>nrow</code> arguments allow us to lay out the data in the matrix as we need. To name the rows and columns we can use the <code><a href="https://rdrr.io/r/base/dimnames.html">dimnames()</a></code> function. We need to create a “list” object to hold the names of the rows and columns and then assign this to the matrix object. The names of rows are columns are called the “dimension names” in a matrix.</p>
<p>Make a list for the two vectors of names:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># </span></span>
<span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>food <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cabbage"</span>,</span>
<span>                      <span class="st">"sugarbeet"</span>,</span>
<span>                      <span class="st">"swede"</span><span class="op">)</span>,</span>
<span>             breed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"welsh"</span>,</span>
<span>                       <span class="st">"tamworth"</span>,</span>
<span>                       <span class="st">"essex"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The vectors can be of different lengths in a list which would be important if we had four breeds and only two foods, for example.</p>
<p>Now assign the list to the dimension names in the matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">vars</span></span>
<span></span>
<span><span class="va">food_pref</span></span>
<span><span class="co">##            breed</span></span>
<span><span class="co">## food        welsh tamworth essex</span></span>
<span><span class="co">##   cabbage      11       19    22</span></span>
<span><span class="co">##   sugarbeet    21       16     8</span></span>
<span><span class="co">##   swede         7       12    11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data are now in a form that can be used in the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  food_pref</span></span>
<span><span class="co">## X-squared = 10.64, df = 4, p-value = 0.03092</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The test is significant since the <em>p</em>-value is less than 0.05. We have evidence of a preference for particular foods by different breeds. But in what way? We need to know the “direction of the effect” <em>i.e.,</em> Who likes what?</p>
<p>The <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function has a <code>residuals</code> argument that can be used to calculate the residuals. These are the differences between the observed and expected values. The expected values are the values that would be expected if there was no association between the rows and columns. The residuals are standardised.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="co">##            breed</span></span>
<span><span class="co">## food             welsh    tamworth      essex</span></span>
<span><span class="co">##   cabbage   -1.2433504 -0.05564283  1.2722209</span></span>
<span><span class="co">##   sugarbeet  1.9317656 -0.16014783 -1.7125943</span></span>
<span><span class="co">##   swede     -0.7289731  0.26939742  0.4225344</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where the residuals are positive, the observed value is greater than the expected value and where they are negative, the observed value is less than the expected value. Our results show the Welsh pigs much prefer sugarbeet and strongly dislike cabbage. The Essex pigs prefer cabbage and dislike sugarbeet and the Essex pigs slightly prefer swede but have less strong likes and dislikes.</p>
<p>The degrees of freedom are: (rows - 1)(cols - 1) = 2 * 2 = 4.</p>
<section id="report-2" class="level3" data-number="18.5.1"><h3 data-number="18.5.1" class="anchored" data-anchor-id="report-2">
<span class="header-section-number">18.5.1</span> Report</h3>
<p>Different pig breeds showed a significant preference for the different food types (<span class="math inline">\(\chi^2\)</span> = 10.64; <em>df</em> = 4; <em>p</em> = 0.031) with Essex much preferring cabbage and disliking sugarbeet, Welsh showing a strong preference for sugarbeet and a dislike of cabbage and Tamworth showing no clear preference.</p>
</section></section><section id="summary" class="level2" data-number="18.6"><h2 data-number="18.6" class="anchored" data-anchor-id="summary">
<span class="header-section-number">18.6</span> Summary</h2>
<ol type="1">
<li><p>Unlike regression, correlation and chi-square contingency tests assess association between variable without implying causality.</p></li>
<li><p>Pearson’s Correlation measures the linear association between two continuous variables (range: -1 to 1). Assumes normality.</p></li>
<li><p>Scatter plots help identify the strength and direction of relationships and should not include a best-fit line.</p></li>
<li><p>Before using Pearson’s correlation, we check the normality assumptions using histograms and the Shapiro-Wilk test.</p></li>
<li><p>Spearman’s rannk Correlation is a non-parametric alternative that does not require normality and is less sensitive to outliers.</p></li>
<li><p>Chi-Square Contingency tests allow us to test for an association between categorical variables.</p></li>
<li><p>We report the statistical significance, the direction of the association and the magnitude of the association.</p></li>
<li><p>In R we use <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> is used for correlation tests and <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> for chi-squared contingency tests</p></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-R-core" class="csl-entry" role="listitem">
R Core Team. 2025. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, and Jennifer Bryan. 2025. <em>Readxl: Read Excel Files</em>. <a href="https://doi.org/10.32614/CRAN.package.readxl">https://doi.org/10.32614/CRAN.package.readxl</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./two-way-anova.html" class="pagination-link" aria-label="Two-way ANOVA">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Two-way ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./goodness-of-fit.html" class="pagination-link" aria-label="Goodness of fit">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Goodness of fit</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Rand, E. (2025). Computational Analysis for Bioscientists<br>
(Version 0.2) https://3mmarand.github.io/comp4biosci/</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/association.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>