<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Computational Analysis for Bioscientists - 16&nbsp; Association: Correlation and Contingency</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./goodness_of_fit.html" rel="next">
<link href="./two_way_anova.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical_analysis_1.html">Statistical Analysis - Part 1</a></li><li class="breadcrumb-item"><a href="./association.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Analysis for Bioscientists</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/3mmaRand/comp4biosci" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About this book</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./what_they_forgot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What they forgot to teach you about computers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_and_os.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Machines and operating systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./file_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding file systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organising_work.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Organising your work</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./getting_started_with_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ideas_about_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ideas about data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first_steps_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">First Steps in RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Workflow in RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import_to_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">From importing to reporting</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistical_analysis_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Analysis - Part 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logic_hyopthesis_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The logic of hyothesis testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence_intervals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what_statistical_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">What is a statistical model?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./single_linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Single linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two_sample_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Two-Sample tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one_way_anova_and_kw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">One-way ANOVA and Kruskal-Wallis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two_way_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Two-way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./association.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goodness_of_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Goodness of fit</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./keyboard_shortcuts_tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Keyboard short cuts and other tips</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">16.1</span> Overview</a>
  <ul class="collapse">
<li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">16.1.1</span> Correlation</a></li>
  <li><a href="#contingency-chi-squared" id="toc-contingency-chi-squared" class="nav-link" data-scroll-target="#contingency-chi-squared"><span class="header-section-number">16.1.2</span> Contingency Chi-squared</a></li>
  <li><a href="#reporting" id="toc-reporting" class="nav-link" data-scroll-target="#reporting"><span class="header-section-number">16.1.3</span> Reporting</a></li>
  </ul>
</li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn"><span class="header-section-number">16.2</span> ðŸŽ¬ Your turn!</a></li>
  <li>
<a href="#correlation-1" id="toc-correlation-1" class="nav-link" data-scroll-target="#correlation-1"><span class="header-section-number">16.3</span> Correlation</a>
  <ul class="collapse">
<li><a href="#import-and-explore" id="toc-import-and-explore" class="nav-link" data-scroll-target="#import-and-explore"><span class="header-section-number">16.3.1</span> Import and explore</a></li>
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">16.3.2</span> Check assumptions</a></li>
  <li><a href="#do-a-pearsons-correlation-test-with-cor.test" id="toc-do-a-pearsons-correlation-test-with-cor.test" class="nav-link" data-scroll-target="#do-a-pearsons-correlation-test-with-cor.test"><span class="header-section-number">16.3.3</span> Do a Pearsonâ€™s correlation test with <code>cor.test()</code></a></li>
  <li><a href="#report" id="toc-report" class="nav-link" data-scroll-target="#report"><span class="header-section-number">16.3.4</span> Report</a></li>
  <li><a href="#spearmans-rank-correlation-coefficient" id="toc-spearmans-rank-correlation-coefficient" class="nav-link" data-scroll-target="#spearmans-rank-correlation-coefficient"><span class="header-section-number">16.3.5</span> Spearmanâ€™s rank correlation coefficient</a></li>
  </ul>
</li>
  <li>
<a href="#contingency-chi-squared-test" id="toc-contingency-chi-squared-test" class="nav-link" data-scroll-target="#contingency-chi-squared-test"><span class="header-section-number">16.4</span> Contingency Chi-squared test</a>
  <ul class="collapse">
<li><a href="#report-1" id="toc-report-1" class="nav-link" data-scroll-target="#report-1"><span class="header-section-number">16.4.1</span> Report</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">16.5</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/association.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/3mmaRand/comp4biosci/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical_analysis_1.html">Statistical Analysis - Part 1</a></li><li class="breadcrumb-item"><a href="./association.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Association: Correlation and Contingency</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Incomplete
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are reading a work in progress. This page is a dumping ground for ideas. Sections maybe missing, or contain a list of points to include.</p>
</div>
</div>
<section id="overview" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">16.1</span> Overview</h2>
<p>no explanatory variables</p>
<section id="correlation" class="level3" data-number="16.1.1"><h3 data-number="16.1.1" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">16.1.1</span> Correlation</h3>
<ul>
<li><p>two continuous variables</p></li>
<li><p>neither is an explanatory variable, i.e., there is not a causal relationship between the two variables</p></li>
<li><p>you want to know if there is a correlation between the two variables</p></li>
<li><p>the correlation coefficient is a measure of the strength and direction of the linear association between two variables and ranges from -1 to 1</p></li>
<li><p>A correlation coefficient of 1 indicates a perfect positive association between the variables meaning the highest score in one variable are associated with the <em>highest</em> scores in the other.</p></li>
<li><p>A correlation coefficient of -1 indicates a perfect negative association between the variables meaning the highest scores in one variable are associated with the <em>lowest</em> scores in the other.</p></li>
</ul>
<p>TODO Add a figure of the different correlation coefficients</p>
<ul>
<li><p>we estimate the population correlation coefficient, <span class="math inline">\(\rho\)</span> (pronounced rho), with the sample correlation coefficient, <span class="math inline">\(r\)</span> and test whether it is significantly different from zero because a correlation coefficient of 0 means association.</p></li>
<li><p>Pearsonâ€™s correlation coefficient, is a parametric measure which assumes the variables are normally distributed and that any correlation is linear.</p></li>
<li><p>Spearmanâ€™s rank correlation coefficient, is a non-parametric measure which does not assume the variables are normally distributed</p></li>
<li><p>we use <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> in R.</p></li>
</ul></section><section id="contingency-chi-squared" class="level3" data-number="16.1.2"><h3 data-number="16.1.2" class="anchored" data-anchor-id="contingency-chi-squared">
<span class="header-section-number">16.1.2</span> Contingency Chi-squared</h3>
<ul>
<li><p>two categorical variables</p></li>
<li><p>neither is an explanatory variable, i.e., there is not a causal relationship between the two variables</p></li>
<li><p>we count the number of observations in each caetory of each variable</p></li>
<li><p>you want to know if there is an association between the two variables</p></li>
<li><p>another way of describing this is that we test whether the proportion of observations falling in to each category of one variable is the same for each category of the other variable.</p></li>
<li><p>we use a chi-squared test to test whether the observed counts are significantly different from the expected counts if there was no association between the variables.</p></li>
</ul></section><section id="reporting" class="level3" data-number="16.1.3"><h3 data-number="16.1.3" class="anchored" data-anchor-id="reporting">
<span class="header-section-number">16.1.3</span> Reporting</h3>
<ol type="1">
<li><p>the significance of effect - whether the association is significant different from zero</p></li>
<li>
<p>the direction of effect</p>
<ul>
<li>correlation whether <span class="math inline">\(r\)</span> is positive or negative</li>
<li>which categories have higher than expected values</li>
</ul>
</li>
<li><p>the magnitude of effect</p></li>
</ol>
<p>We do not put a line of best fit on a scatter plot accompanying a correlation because such a line implies a causal relationship.</p>
<p>We will explore all of these ideas with an examples.</p>
</section></section><section id="your-turn" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="your-turn">
<span class="header-section-number">16.2</span> ðŸŽ¬ Your turn!</h2>
<p>If you want to code along you will need to start a new <a href="workflow_rstudio.html#rstudio-projects">RStudio project</a>, add a <code>data-raw</code> folder and open a new script. You will also need to load the <strong><code>tidyverse</code></strong> package <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>.</p>
</section><section id="correlation-1" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="correlation-1">
<span class="header-section-number">16.3</span> Correlation</h2>
<p>High quality images of the internal structure of wheat seeds were taken with a soft X-ray technique. Seven measurements determined from the images:</p>
<ul>
<li>Area</li>
<li>Perimeter</li>
<li>Compactness</li>
<li>Kernel length</li>
<li>Kernel width</li>
<li>Asymmetry coefficient</li>
<li>Length of kernel groove</li>
</ul>
<p>Research were interested in the correlation between compactness and kernel width</p>
<p>The data are in <a href="data-raw/seeds-dataset.xlsx">seeds-dataset.xlsx</a>.</p>
<section id="import-and-explore" class="level3" data-number="16.3.1"><h3 data-number="16.3.1" class="anchored" data-anchor-id="import-and-explore">
<span class="header-section-number">16.3.1</span> Import and explore</h3>
<p>The data are in an excel file so we will need the <strong><code>readxl</code></strong> <span class="citation" data-cites="readxl">(<a href="references.html#ref-readxl" role="doc-biblioref">Wickham and Bryan 2023</a>)</span> package.</p>
<p>Load the package:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find out the names of the sheets in the excel file:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">"data-raw/seeds-dataset.xlsx"</span><span class="op">)</span></span>
<span><span class="co">## [1] "seeds_dataset"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is only one sheet called <code>seeds_dataset</code>.</p>
<p>Import the data:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data-raw/seeds-dataset.xlsx"</span>,</span>
<span>                    sheet <span class="op">=</span> <span class="st">"seeds_dataset"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that we could have omitted the <code>sheet</code> argument because there is only one sheet in the Excel file. However, it is good practice to be explicit.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">area</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perimeter</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">compactness</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">kernal_length</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">kernel_width</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">asymmetry_coef</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">groove_length</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">15.26</td>
<td style="text-align: right;">14.84</td>
<td style="text-align: right;">0.8710</td>
<td style="text-align: right;">5.763</td>
<td style="text-align: right;">3.312</td>
<td style="text-align: right;">2.2210</td>
<td style="text-align: right;">5.220</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.88</td>
<td style="text-align: right;">14.57</td>
<td style="text-align: right;">0.8811</td>
<td style="text-align: right;">5.554</td>
<td style="text-align: right;">3.333</td>
<td style="text-align: right;">1.0180</td>
<td style="text-align: right;">4.956</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.29</td>
<td style="text-align: right;">14.09</td>
<td style="text-align: right;">0.9050</td>
<td style="text-align: right;">5.291</td>
<td style="text-align: right;">3.337</td>
<td style="text-align: right;">2.6990</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">13.94</td>
<td style="text-align: right;">0.8955</td>
<td style="text-align: right;">5.324</td>
<td style="text-align: right;">3.379</td>
<td style="text-align: right;">2.2590</td>
<td style="text-align: right;">4.805</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.14</td>
<td style="text-align: right;">14.99</td>
<td style="text-align: right;">0.9034</td>
<td style="text-align: right;">5.658</td>
<td style="text-align: right;">3.562</td>
<td style="text-align: right;">1.3550</td>
<td style="text-align: right;">5.175</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.38</td>
<td style="text-align: right;">14.21</td>
<td style="text-align: right;">0.8951</td>
<td style="text-align: right;">5.386</td>
<td style="text-align: right;">3.312</td>
<td style="text-align: right;">2.4620</td>
<td style="text-align: right;">4.956</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.69</td>
<td style="text-align: right;">14.49</td>
<td style="text-align: right;">0.8799</td>
<td style="text-align: right;">5.563</td>
<td style="text-align: right;">3.259</td>
<td style="text-align: right;">3.5860</td>
<td style="text-align: right;">5.219</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.10</td>
<td style="text-align: right;">0.8911</td>
<td style="text-align: right;">5.420</td>
<td style="text-align: right;">3.302</td>
<td style="text-align: right;">2.7000</td>
<td style="text-align: right;">5.000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.63</td>
<td style="text-align: right;">15.46</td>
<td style="text-align: right;">0.8747</td>
<td style="text-align: right;">6.053</td>
<td style="text-align: right;">3.465</td>
<td style="text-align: right;">2.0400</td>
<td style="text-align: right;">5.877</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.44</td>
<td style="text-align: right;">15.25</td>
<td style="text-align: right;">0.8880</td>
<td style="text-align: right;">5.884</td>
<td style="text-align: right;">3.505</td>
<td style="text-align: right;">1.9690</td>
<td style="text-align: right;">5.533</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.26</td>
<td style="text-align: right;">14.85</td>
<td style="text-align: right;">0.8696</td>
<td style="text-align: right;">5.714</td>
<td style="text-align: right;">3.242</td>
<td style="text-align: right;">4.5430</td>
<td style="text-align: right;">5.314</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.03</td>
<td style="text-align: right;">14.16</td>
<td style="text-align: right;">0.8796</td>
<td style="text-align: right;">5.438</td>
<td style="text-align: right;">3.201</td>
<td style="text-align: right;">1.7170</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.89</td>
<td style="text-align: right;">14.02</td>
<td style="text-align: right;">0.8880</td>
<td style="text-align: right;">5.439</td>
<td style="text-align: right;">3.199</td>
<td style="text-align: right;">3.9860</td>
<td style="text-align: right;">4.738</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.78</td>
<td style="text-align: right;">14.06</td>
<td style="text-align: right;">0.8759</td>
<td style="text-align: right;">5.479</td>
<td style="text-align: right;">3.156</td>
<td style="text-align: right;">3.1360</td>
<td style="text-align: right;">4.872</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.74</td>
<td style="text-align: right;">14.05</td>
<td style="text-align: right;">0.8744</td>
<td style="text-align: right;">5.482</td>
<td style="text-align: right;">3.114</td>
<td style="text-align: right;">2.9320</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.59</td>
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">0.8993</td>
<td style="text-align: right;">5.351</td>
<td style="text-align: right;">3.333</td>
<td style="text-align: right;">4.1850</td>
<td style="text-align: right;">4.781</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.99</td>
<td style="text-align: right;">13.83</td>
<td style="text-align: right;">0.9183</td>
<td style="text-align: right;">5.119</td>
<td style="text-align: right;">3.383</td>
<td style="text-align: right;">5.2340</td>
<td style="text-align: right;">4.781</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.69</td>
<td style="text-align: right;">14.75</td>
<td style="text-align: right;">0.9058</td>
<td style="text-align: right;">5.527</td>
<td style="text-align: right;">3.514</td>
<td style="text-align: right;">1.5990</td>
<td style="text-align: right;">5.046</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.70</td>
<td style="text-align: right;">14.21</td>
<td style="text-align: right;">0.9153</td>
<td style="text-align: right;">5.205</td>
<td style="text-align: right;">3.466</td>
<td style="text-align: right;">1.7670</td>
<td style="text-align: right;">4.649</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.72</td>
<td style="text-align: right;">13.57</td>
<td style="text-align: right;">0.8686</td>
<td style="text-align: right;">5.226</td>
<td style="text-align: right;">3.049</td>
<td style="text-align: right;">4.1020</td>
<td style="text-align: right;">4.914</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.16</td>
<td style="text-align: right;">14.40</td>
<td style="text-align: right;">0.8584</td>
<td style="text-align: right;">5.658</td>
<td style="text-align: right;">3.129</td>
<td style="text-align: right;">3.0720</td>
<td style="text-align: right;">5.176</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.26</td>
<td style="text-align: right;">0.8722</td>
<td style="text-align: right;">5.520</td>
<td style="text-align: right;">3.168</td>
<td style="text-align: right;">2.6880</td>
<td style="text-align: right;">5.219</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.88</td>
<td style="text-align: right;">14.90</td>
<td style="text-align: right;">0.8988</td>
<td style="text-align: right;">5.618</td>
<td style="text-align: right;">3.507</td>
<td style="text-align: right;">0.7651</td>
<td style="text-align: right;">5.091</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.08</td>
<td style="text-align: right;">13.23</td>
<td style="text-align: right;">0.8664</td>
<td style="text-align: right;">5.099</td>
<td style="text-align: right;">2.936</td>
<td style="text-align: right;">1.4150</td>
<td style="text-align: right;">4.961</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.01</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">0.8657</td>
<td style="text-align: right;">5.789</td>
<td style="text-align: right;">3.245</td>
<td style="text-align: right;">1.7910</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.19</td>
<td style="text-align: right;">15.16</td>
<td style="text-align: right;">0.8849</td>
<td style="text-align: right;">5.833</td>
<td style="text-align: right;">3.421</td>
<td style="text-align: right;">0.9030</td>
<td style="text-align: right;">5.307</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.02</td>
<td style="text-align: right;">13.76</td>
<td style="text-align: right;">0.8641</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">3.026</td>
<td style="text-align: right;">3.3730</td>
<td style="text-align: right;">4.825</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.74</td>
<td style="text-align: right;">13.67</td>
<td style="text-align: right;">0.8564</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">2.956</td>
<td style="text-align: right;">2.5040</td>
<td style="text-align: right;">4.869</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.11</td>
<td style="text-align: right;">14.18</td>
<td style="text-align: right;">0.8820</td>
<td style="text-align: right;">5.541</td>
<td style="text-align: right;">3.221</td>
<td style="text-align: right;">2.7540</td>
<td style="text-align: right;">5.038</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.45</td>
<td style="text-align: right;">14.02</td>
<td style="text-align: right;">0.8604</td>
<td style="text-align: right;">5.516</td>
<td style="text-align: right;">3.065</td>
<td style="text-align: right;">3.5310</td>
<td style="text-align: right;">5.097</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.16</td>
<td style="text-align: right;">13.82</td>
<td style="text-align: right;">0.8662</td>
<td style="text-align: right;">5.454</td>
<td style="text-align: right;">2.975</td>
<td style="text-align: right;">0.8551</td>
<td style="text-align: right;">5.056</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.49</td>
<td style="text-align: right;">14.94</td>
<td style="text-align: right;">0.8724</td>
<td style="text-align: right;">5.757</td>
<td style="text-align: right;">3.371</td>
<td style="text-align: right;">3.4120</td>
<td style="text-align: right;">5.228</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.09</td>
<td style="text-align: right;">14.41</td>
<td style="text-align: right;">0.8529</td>
<td style="text-align: right;">5.717</td>
<td style="text-align: right;">3.186</td>
<td style="text-align: right;">3.9200</td>
<td style="text-align: right;">5.299</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.94</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">0.8728</td>
<td style="text-align: right;">5.585</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">2.1240</td>
<td style="text-align: right;">5.012</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.05</td>
<td style="text-align: right;">14.68</td>
<td style="text-align: right;">0.8779</td>
<td style="text-align: right;">5.712</td>
<td style="text-align: right;">3.328</td>
<td style="text-align: right;">2.1290</td>
<td style="text-align: right;">5.360</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.12</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">0.9000</td>
<td style="text-align: right;">5.709</td>
<td style="text-align: right;">3.485</td>
<td style="text-align: right;">2.2700</td>
<td style="text-align: right;">5.443</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.20</td>
<td style="text-align: right;">15.27</td>
<td style="text-align: right;">0.8734</td>
<td style="text-align: right;">5.826</td>
<td style="text-align: right;">3.464</td>
<td style="text-align: right;">2.8230</td>
<td style="text-align: right;">5.527</td>
</tr>
<tr class="even">
<td style="text-align: right;">17.08</td>
<td style="text-align: right;">15.38</td>
<td style="text-align: right;">0.9079</td>
<td style="text-align: right;">5.832</td>
<td style="text-align: right;">3.683</td>
<td style="text-align: right;">2.9560</td>
<td style="text-align: right;">5.484</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.80</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">0.8823</td>
<td style="text-align: right;">5.656</td>
<td style="text-align: right;">3.288</td>
<td style="text-align: right;">3.1120</td>
<td style="text-align: right;">5.309</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">14.17</td>
<td style="text-align: right;">0.8944</td>
<td style="text-align: right;">5.397</td>
<td style="text-align: right;">3.298</td>
<td style="text-align: right;">6.6850</td>
<td style="text-align: right;">5.001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.54</td>
<td style="text-align: right;">13.85</td>
<td style="text-align: right;">0.8871</td>
<td style="text-align: right;">5.348</td>
<td style="text-align: right;">3.156</td>
<td style="text-align: right;">2.5870</td>
<td style="text-align: right;">5.178</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">13.85</td>
<td style="text-align: right;">0.8852</td>
<td style="text-align: right;">5.351</td>
<td style="text-align: right;">3.158</td>
<td style="text-align: right;">2.2490</td>
<td style="text-align: right;">5.176</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.16</td>
<td style="text-align: right;">13.55</td>
<td style="text-align: right;">0.9009</td>
<td style="text-align: right;">5.138</td>
<td style="text-align: right;">3.201</td>
<td style="text-align: right;">2.4610</td>
<td style="text-align: right;">4.783</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">14.86</td>
<td style="text-align: right;">0.8820</td>
<td style="text-align: right;">5.877</td>
<td style="text-align: right;">3.396</td>
<td style="text-align: right;">4.7110</td>
<td style="text-align: right;">5.528</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.11</td>
<td style="text-align: right;">14.54</td>
<td style="text-align: right;">0.8986</td>
<td style="text-align: right;">5.579</td>
<td style="text-align: right;">3.462</td>
<td style="text-align: right;">3.1280</td>
<td style="text-align: right;">5.180</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.80</td>
<td style="text-align: right;">14.04</td>
<td style="text-align: right;">0.8794</td>
<td style="text-align: right;">5.376</td>
<td style="text-align: right;">3.155</td>
<td style="text-align: right;">1.5600</td>
<td style="text-align: right;">4.961</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.36</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">0.8861</td>
<td style="text-align: right;">5.701</td>
<td style="text-align: right;">3.393</td>
<td style="text-align: right;">1.3670</td>
<td style="text-align: right;">5.132</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.99</td>
<td style="text-align: right;">14.56</td>
<td style="text-align: right;">0.8883</td>
<td style="text-align: right;">5.570</td>
<td style="text-align: right;">3.377</td>
<td style="text-align: right;">2.9580</td>
<td style="text-align: right;">5.175</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.79</td>
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">0.8819</td>
<td style="text-align: right;">5.545</td>
<td style="text-align: right;">3.291</td>
<td style="text-align: right;">2.7040</td>
<td style="text-align: right;">5.111</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.86</td>
<td style="text-align: right;">14.67</td>
<td style="text-align: right;">0.8676</td>
<td style="text-align: right;">5.678</td>
<td style="text-align: right;">3.258</td>
<td style="text-align: right;">2.1290</td>
<td style="text-align: right;">5.351</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">14.40</td>
<td style="text-align: right;">0.8751</td>
<td style="text-align: right;">5.585</td>
<td style="text-align: right;">3.272</td>
<td style="text-align: right;">3.9750</td>
<td style="text-align: right;">5.144</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.78</td>
<td style="text-align: right;">14.91</td>
<td style="text-align: right;">0.8923</td>
<td style="text-align: right;">5.674</td>
<td style="text-align: right;">3.434</td>
<td style="text-align: right;">5.5930</td>
<td style="text-align: right;">5.136</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.49</td>
<td style="text-align: right;">14.61</td>
<td style="text-align: right;">0.8538</td>
<td style="text-align: right;">5.715</td>
<td style="text-align: right;">3.113</td>
<td style="text-align: right;">4.1160</td>
<td style="text-align: right;">5.396</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.33</td>
<td style="text-align: right;">14.28</td>
<td style="text-align: right;">0.8831</td>
<td style="text-align: right;">5.504</td>
<td style="text-align: right;">3.199</td>
<td style="text-align: right;">3.3280</td>
<td style="text-align: right;">5.224</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.52</td>
<td style="text-align: right;">14.60</td>
<td style="text-align: right;">0.8557</td>
<td style="text-align: right;">5.741</td>
<td style="text-align: right;">3.113</td>
<td style="text-align: right;">1.4810</td>
<td style="text-align: right;">5.487</td>
</tr>
<tr class="even">
<td style="text-align: right;">15.03</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">0.8658</td>
<td style="text-align: right;">5.702</td>
<td style="text-align: right;">3.212</td>
<td style="text-align: right;">1.9330</td>
<td style="text-align: right;">5.439</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.46</td>
<td style="text-align: right;">14.35</td>
<td style="text-align: right;">0.8818</td>
<td style="text-align: right;">5.388</td>
<td style="text-align: right;">3.377</td>
<td style="text-align: right;">2.8020</td>
<td style="text-align: right;">5.044</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.92</td>
<td style="text-align: right;">14.43</td>
<td style="text-align: right;">0.9006</td>
<td style="text-align: right;">5.384</td>
<td style="text-align: right;">3.412</td>
<td style="text-align: right;">1.1420</td>
<td style="text-align: right;">5.088</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.38</td>
<td style="text-align: right;">14.77</td>
<td style="text-align: right;">0.8857</td>
<td style="text-align: right;">5.662</td>
<td style="text-align: right;">3.419</td>
<td style="text-align: right;">1.9990</td>
<td style="text-align: right;">5.222</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.11</td>
<td style="text-align: right;">13.47</td>
<td style="text-align: right;">0.8392</td>
<td style="text-align: right;">5.159</td>
<td style="text-align: right;">3.032</td>
<td style="text-align: right;">1.5020</td>
<td style="text-align: right;">4.519</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.42</td>
<td style="text-align: right;">12.86</td>
<td style="text-align: right;">0.8683</td>
<td style="text-align: right;">5.008</td>
<td style="text-align: right;">2.850</td>
<td style="text-align: right;">2.7000</td>
<td style="text-align: right;">4.607</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.23</td>
<td style="text-align: right;">12.63</td>
<td style="text-align: right;">0.8840</td>
<td style="text-align: right;">4.902</td>
<td style="text-align: right;">2.879</td>
<td style="text-align: right;">2.2690</td>
<td style="text-align: right;">4.703</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.36</td>
<td style="text-align: right;">13.19</td>
<td style="text-align: right;">0.8923</td>
<td style="text-align: right;">5.076</td>
<td style="text-align: right;">3.042</td>
<td style="text-align: right;">3.2200</td>
<td style="text-align: right;">4.605</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.22</td>
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">0.8680</td>
<td style="text-align: right;">5.395</td>
<td style="text-align: right;">3.070</td>
<td style="text-align: right;">4.1570</td>
<td style="text-align: right;">5.088</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.78</td>
<td style="text-align: right;">13.57</td>
<td style="text-align: right;">0.8716</td>
<td style="text-align: right;">5.262</td>
<td style="text-align: right;">3.026</td>
<td style="text-align: right;">1.1760</td>
<td style="text-align: right;">4.782</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.88</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">0.8879</td>
<td style="text-align: right;">5.139</td>
<td style="text-align: right;">3.119</td>
<td style="text-align: right;">2.3520</td>
<td style="text-align: right;">4.607</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.34</td>
<td style="text-align: right;">14.37</td>
<td style="text-align: right;">0.8726</td>
<td style="text-align: right;">5.630</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">1.3130</td>
<td style="text-align: right;">5.150</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.01</td>
<td style="text-align: right;">14.29</td>
<td style="text-align: right;">0.8625</td>
<td style="text-align: right;">5.609</td>
<td style="text-align: right;">3.158</td>
<td style="text-align: right;">2.2170</td>
<td style="text-align: right;">5.132</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.37</td>
<td style="text-align: right;">14.39</td>
<td style="text-align: right;">0.8726</td>
<td style="text-align: right;">5.569</td>
<td style="text-align: right;">3.153</td>
<td style="text-align: right;">1.4640</td>
<td style="text-align: right;">5.300</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.73</td>
<td style="text-align: right;">13.75</td>
<td style="text-align: right;">0.8458</td>
<td style="text-align: right;">5.412</td>
<td style="text-align: right;">2.882</td>
<td style="text-align: right;">3.5330</td>
<td style="text-align: right;">5.067</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>These data are formatted usefully for analysis using correlation and plotting. Each row is a different seed and the columns are the variables we are interested. This means that the first values in each column are related - they are all from the same seed</p>
<p>In the first instance, it is sensible to create a rough plot of our data (See <a href="#fig-seeds-rough" class="quarto-xref">Figure&nbsp;<span>16.1</span></a>). Plotting data early helps us in multiple ways:</p>
<ul>
<li>it helps identify whether there extreme values</li>
<li>it allows us to see if the association is roughly linear</li>
<li>it tells us whether any association positive or negative</li>
</ul>
<p>Scatter plots (<code>geom_point()</code>) are a good choice for exploratory plotting with data like these.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span>, y <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-seeds-rough" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-seeds-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="association_files/figure-html/fig-seeds-rough-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-seeds-rough-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: A default scatter plot of compactness and kernel width in seeds demonstrates an approximately linear positive association them the variables.
</figcaption></figure>
</div>
</div>
</div>
<p>The figure suggests that there is a positive correlation between <code>compactness</code> and <code>kernel_width</code> and that correlation is roughly linear.</p>
</section><section id="check-assumptions" class="level3" data-number="16.3.2"><h3 data-number="16.3.2" class="anchored" data-anchor-id="check-assumptions">
<span class="header-section-number">16.3.2</span> Check assumptions</h3>
<p>We can see from <a href="#fig-seeds-rough" class="quarto-xref">Figure&nbsp;<span>16.1</span></a> that the relationship between <code>compactness</code> and <code>kernel_width</code> is roughly linear. This is a good sign for using Pearsonâ€™s correlation coefficient.</p>
<p>Our next check is to use common sense: both variables are continuous and we would expect them to be normally distributed. We can then plot histograms to examine the distributions (See <a href="#fig-hist" class="quarto-xref">Figure&nbsp;<span>16.2</span></a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hist" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-hist-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="association_files/figure-html/fig-hist-1.png" class="img-fluid figure-img" data-ref-parent="fig-hist" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Compactness
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-hist" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-hist-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-hist-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="association_files/figure-html/fig-hist-2.png" class="img-fluid figure-img" data-ref-parent="fig-hist" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Kernel width
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: The distributions of the two variables are slightly skewed but do not seem too different from a normal distribution. We will continue with the Pearsonâ€™s correlation coefficient.
</figcaption></figure>
</div>
<p>The distributions of the two variables are slightly skewed but do not seem too different from a normal distribution.</p>
<p>Finally, we can use the Shapiro-Wilk test to test for normality.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">$</span><span class="va">compactness</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  seeds$compactness</span></span>
<span><span class="co">## W = 0.99484, p-value = 0.9937</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">$</span><span class="va">kernel_width</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  seeds$kernel_width</span></span>
<span><span class="co">## W = 0.98989, p-value = 0.8486</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>p</em>-values are greater than 0.05 so these tests of the normality assumption are not significant. Note that â€œnot significantâ€ means not significantly different from a normal distribution. It does not mean definitely normally distributed.</p>
<p>It is not unreasonable to continue with the Pearsonâ€™s correlation coefficient. However, later we will also use the Spearmanâ€™s rank correlation coefficient, a non-parametric method which has fewer assumptions. Spearmanâ€™s rank correlation is a more conservative approach.</p>
</section><section id="do-a-pearsons-correlation-test-with-cor.test" class="level3" data-number="16.3.3"><h3 data-number="16.3.3" class="anchored" data-anchor-id="do-a-pearsons-correlation-test-with-cor.test">
<span class="header-section-number">16.3.3</span> Do a Pearsonâ€™s correlation test with <code>cor.test()</code>
</h3>
<p>We can carry out a Pearsonâ€™s correlation test with <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> like this:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>, <span class="op">~</span> <span class="va">compactness</span> <span class="op">+</span> <span class="va">kernel_width</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's product-moment correlation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  compactness and kernel_width</span></span>
<span><span class="co">## t = 7.3738, df = 68, p-value = 2.998e-10</span></span>
<span><span class="co">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.5117537 0.7794620</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##       cor </span></span>
<span><span class="co">## 0.6665731</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A variable is not being explained in this case so we do not need to include a response variable. Pearsonâ€™s is the default test so we do not need to specify it.</p>
<p>What do all these results mean?</p>
<p>The last line gives the correlation coefficient, <span class="math inline">\(r\)</span>, that has been estimated from the data. Here, <span class="math inline">\(r\)</span> = 0.67 which is a moderate positive correlation.</p>
<p>The fifth line tells you what test has been done: <code>alternative hypothesis: true correlation is not equal to 0</code>. That is <span class="math inline">\(H_0\)</span> is that <span class="math inline">\(\rho = 0\)</span></p>
<p>The forth line gives the test result: <code>t = 7.3738, df = 68, p-value = 2.998e-10</code></p>
<p>The <span class="math inline">\(p\)</span>-value is very much less than 0.05 so we can reject the null hypothesis and conclude there is a significant positive correlation between <code>compactness</code> and <code>kernel_width</code>.</p>
</section><section id="report" class="level3" data-number="16.3.4"><h3 data-number="16.3.4" class="anchored" data-anchor-id="report">
<span class="header-section-number">16.3.4</span> Report</h3>
<p>There was a significant positive correlation (<span class="math inline">\(r\)</span> = 0.67) between compactness and kernel width (Pearsonâ€™s: <em>t</em> = 7.374; <em>df</em> = 68; <em>p</em>-value &lt; 0.0001). See <a href="#fig-correlation-pears" class="quarto-xref">Figure&nbsp;<span>16.3</span></a>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">seeds</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">compactness</span>, y <span class="op">=</span> <span class="va">kernel_width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Diameter (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Compactness"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.85</span>,  y <span class="op">=</span> <span class="fl">3.6</span>, </span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">~</span><span class="st">"= 0.67; "</span><span class="op">~</span><span class="fu">italic</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">~</span><span class="st">"&lt; 0.001"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-correlation-pears" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-pears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="association_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-pears-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: <strong>Correlation between compactness and kernel width of wheat seeds</strong>. High quality images of the internal structure of wheat seeds were taken with a soft X-ray technique and the compactness and kernel width of the seeds were determined. There was a significant positive correlation (<span class="math inline">\(r\)</span> = 0.67) between compactness and kernel width (Pearsonâ€™s: <em>t</em> = 7.374; <em>df</em> = 68; <em>p</em>-value &lt; 0.0001). Note: axes do not start at 0. Data analysis was conducted in R <span class="citation" data-cites="R-core">(<a href="references.html#ref-R-core" role="doc-biblioref">R Core Team 2023</a>)</span> with tidyverse packages <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>.
</figcaption></figure>
</div>
</section><section id="spearmans-rank-correlation-coefficient" class="level3" data-number="16.3.5"><h3 data-number="16.3.5" class="anchored" data-anchor-id="spearmans-rank-correlation-coefficient">
<span class="header-section-number">16.3.5</span> Spearmanâ€™s rank correlation coefficient</h3>
<p>TODO</p>
</section></section><section id="contingency-chi-squared-test" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="contingency-chi-squared-test">
<span class="header-section-number">16.4</span> Contingency Chi-squared test</h2>
<p>Researchers were interested in whether different pig breeds had the same food preferences. They offered individuals of three breads, Welsh, Tamworth and Essex a choice of three foods: cabbage, sugar beet and swede and recorded the number of individuals that chose each food. The data are shown in <a href="#tbl-food-pref" class="quarto-xref">Table&nbsp;<span>16.1</span></a>.</p>
<div class="cell">
<div id="tbl-food-pref" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-food-pref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.1: Food preferences of three pig breeds
</figcaption><div aria-describedby="tbl-food-pref-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">welsh</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tamworth</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">essex</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cabbage</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">sugarbeet</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">swede</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We donâ€™t know what proportion of food are expected to be preferred but do expect it to be same for each breed if there is no association between breed and food preference. The null hypothesis is that the proportion of foods taken by each breed is the same.</p>
<p>For a contingency chi squared test, the inbuilt chi-squared test can be used but we need to to structure our data as a 3 x 3 table. The <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> function is useful here and we can label the rows and columns to help us interpret the results.</p>
<p>Put the data into a matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create the data</span></span>
<span><span class="va">food_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">19</span>, <span class="fl">22</span>,</span>
<span>                      <span class="fl">21</span>, <span class="fl">16</span>, <span class="fl">8</span>,</span>
<span>                      <span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>                    nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">food_pref</span></span>
<span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,]   11   19   22</span></span>
<span><span class="co">## [2,]   21   16    8</span></span>
<span><span class="co">## [3,]    7   12   11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>byrow</code> and <code>nrow</code> arguments allow us to lay out the data in the matrix as we need. To name the rows and columns we can use the <code><a href="https://rdrr.io/r/base/dimnames.html">dimnames()</a></code> function. We need to create a â€œlistâ€ object to hold the names of the rows and columns and then assign this to the matrix object. The names of rows are columns are called the â€œdimension namesâ€ in a matrix.</p>
<p>Make a list for the two vectors of names:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># </span></span>
<span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>food <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cabbage"</span>,</span>
<span>                      <span class="st">"sugarbeet"</span>,</span>
<span>                      <span class="st">"swede"</span><span class="op">)</span>,</span>
<span>             breed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"welsh"</span>,</span>
<span>                       <span class="st">"tamworth"</span>,</span>
<span>                       <span class="st">"essex"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The vectors can be of different lengths in a list which would be important if we had four breeds and only two foods, for example.</p>
<p>Now assign the list to the dimension names in the matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">vars</span></span>
<span></span>
<span><span class="va">food_pref</span></span>
<span><span class="co">##            breed</span></span>
<span><span class="co">## food        welsh tamworth essex</span></span>
<span><span class="co">##   cabbage      11       19    22</span></span>
<span><span class="co">##   sugarbeet    21       16     8</span></span>
<span><span class="co">##   swede         7       12    11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data are now in a form that can be used in the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  food_pref</span></span>
<span><span class="co">## X-squared = 10.64, df = 4, p-value = 0.03092</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The test is significant since the <em>p</em>-value is less than 0.05. We have evidence of a preference for particular foods by different breeds. But in what way? We need to know the â€œdirection of the effectâ€ <em>i.e.,</em> Who likes what?</p>
<p>The <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function has a <code>residuals</code> argument that can be used to calculate the residuals. These are the differences between the observed and expected values. The expected values are the values that would be expected if there was no association between the rows and columns. The residuals are standardised.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">food_pref</span><span class="op">)</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="co">##            breed</span></span>
<span><span class="co">## food             welsh    tamworth      essex</span></span>
<span><span class="co">##   cabbage   -1.2433504 -0.05564283  1.2722209</span></span>
<span><span class="co">##   sugarbeet  1.9317656 -0.16014783 -1.7125943</span></span>
<span><span class="co">##   swede     -0.7289731  0.26939742  0.4225344</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Where the residuals are positive, the observed value is greater than the expected value and where they are negative, the observed value is less than the expected value. Our results show the Welsh pigs much prefer sugarbeet and strongly dislike cabbage. The Essex pigs prefer cabbage and dislike sugarbeet and the Essex pigs slightly prefer swede but have less strong likes and dislikes.</p>
<p>The degrees of freedom are: (rows - 1)(cols - 1) = 2 * 2 = 4.</p>
<section id="report-1" class="level3" data-number="16.4.1"><h3 data-number="16.4.1" class="anchored" data-anchor-id="report-1">
<span class="header-section-number">16.4.1</span> Report</h3>
<p>Different pig breeds showed a significant preference for the different food types (<span class="math inline">\(\chi^2\)</span> = 10.64; <em>df</em> = 4; <em>p</em> = 0.031) with Essex much preferring cabbage and disliking sugarbeet, Welsh showing a strong preference for sugarbeet and a dislike of cabbage and Tamworth showing no clear preference.</p>
</section></section><section id="summary" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="summary">
<span class="header-section-number">16.5</span> Summary</h2>
<p>TODO</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-R-core" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy Dâ€™Agostino McGowan, Romain FranÃ§ois, Garrett Grolemund, et al. 2019. <span>â€œWelcome to the <span></span>Tidyverse<span></span>â€</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, and Jennifer Bryan. 2023. <span>â€œReadxl: Read Excel Files.â€</span> <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/3mmarand\.github\.io\/comp4biosci\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./two_way_anova.html" class="pagination-link  aria-label=" anova="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Two-way ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./goodness_of_fit.html" class="pagination-link" aria-label="<span class='chapter-number'>17</span>&nbsp; <span class='chapter-title'>Goodness of fit</span>">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Goodness of fit</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Rand, E. (2023). Computational Analysis for Bioscientists (Version 0.1) <a href="https://3mmarand.github.io/comp4biosci/" class="uri">https://3mmarand.github.io/comp4biosci/</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/association.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/3mmaRand/comp4biosci/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>