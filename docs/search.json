[
  {
    "objectID": "two_sample_tests.html#overview",
    "href": "two_sample_tests.html#overview",
    "title": "\n13¬† Two-Sample tests\n",
    "section": "\n13.1 Overview",
    "text": "13.1 Overview\nIn the last chapter learned how to about single linear regression, a technique used when the explanatory variable is continuous. We now turn our attention to cases where our explanatory variable is categorical and has two groups. For example, we might want to know if there is a difference in mass between two subspecies of chaffinch, or if marks in two subjects are the same.\nWe use lm() or wilcox.test() to carry out a two-sample test depending on whether the assumptions of lm() are met. The general linear models applied with lm() are based on the normal distribution and known as parametric tests because they use the parameters of the normal distribution (the mean and standard deviation) to determine if an effect is significant. Null hypotheses are about a mean or difference between means. The assumptions need to be met for the p-values generated to be accurate.\nIf the assumptions are not met, we can use alternatives known as non-parametric tests. Non-parametric tests are based on the ranks of values rather than the actual values themselves. Null hypotheses are about the mean rank rather than he mean. These tests have fewer assumptions and can be used in more situations but the downside is they tend to be less powerful. This means they are less able to detect a difference where one exists.\n\n13.1.1 General linear model assumptions\nThe assumptions of the general linear model are that the residuals are normally distributed and have homogeneity of variance. A residual is the difference between the predicted and observed value\nIf we have a continuous response and a categotical explanatory variable with two groups, we usually apply the general linear model with lm() and then check the assumptions, however, we can sometimes tell when a non-parametric test would be more appropriate before that:\n\nUse common sense - the response should be continuous (or nearly continuous, see Ideas about data: Theory and practice). Consider whether you would expect the reponse to be continuous\nThere should decimal places and few repeated values.\n\nTo examine the assumptions after fitting the linear model, we plot the residuals and test them against the normal distribution\n\n13.1.2 Independent samples and paired samples.\nAn important consideration in conducting tests is whether the values in one groups are independent of the values in another group. Non-independence occurs when the two measures are linked. They could be the same individual, the same time time or the same location. For example, if we want to evaluate a treatment for high blood pressure we might measure blood pressure before and after the treatment on the same individuals. The key consideration is whether pairs of observations in different groups have something in common that make them more similar to each other than to other observations.\n\n13.1.3 Reporting\nIn reporting the result of two-sample test we give:\n\n\nthe significance of effect - whether there is there a difference between the groups\n\nparametric: whether there is there a difference between the groups means\nnon-parametric: whether there is there a difference between the group medians\n\n\nthe direction of effect - which of the means/medians is greater\n\nthe magnitude of effect -\n\nparametric: the means and standard errors for each group or the mean difference for paired samples\nnon-parametric: the medians for each group or the median difference for paired samples\n\n\n\nFigures should reflect what you have said in the statements. Ideally they should show both the raw data and the statistical model:\n-   parametric: means and standard errors \n-   non-parametric: boxplots with medians and interquartile range\nWe will explore all of these ideas with some examples."
  },
  {
    "objectID": "two_sample_tests.html#examples",
    "href": "two_sample_tests.html#examples",
    "title": "\n13¬† Two-Sample tests\n",
    "section": "\n13.2 Examples",
    "text": "13.2 Examples\nüé¨ Your turn! If you want to code along you will need to start a new RStudio project then a new script.\n\n13.2.1 Two independent samples example parametric\nA number of subspecies of the common chaffinch have been described, based principally on the differences in the pattern and colour of the adult male plumage. Two of groups of these subspecies are:\n\n‚Äúcoelebs group‚Äù that occurs in Europe and Asia\n‚Äúcanariensis group‚Äù that occurs on the Canary Islands\n\nThe data in chaff.txt give the masses of twenty individuals from each subspecies. We want to know if the subspecies differ in mass. These groups are independent - there is no link between values in one group and any value in the other group.\n\n13.2.1.1 Import and explore\nImport the data:\n\nchaff &lt;- read_table(\"data-raw/chaff.txt\")\n\n\n\n\n\n\nsubspecies\nmass\n\n\n\ncoelebs\n18.3\n\n\ncoelebs\n22.1\n\n\ncoelebs\n22.4\n\n\ncoelebs\n18.5\n\n\ncoelebs\n22.2\n\n\ncoelebs\n19.3\n\n\ncoelebs\n17.8\n\n\ncoelebs\n20.2\n\n\ncoelebs\n22.1\n\n\ncoelebs\n16.6\n\n\ncoelebs\n20.7\n\n\ncoelebs\n18.7\n\n\ncoelebs\n22.6\n\n\ncoelebs\n21.5\n\n\ncoelebs\n21.7\n\n\ncoelebs\n19.9\n\n\ncoelebs\n23.1\n\n\ncoelebs\n17.8\n\n\ncoelebs\n19.5\n\n\ncoelebs\n24.6\n\n\ncanariensis\n22.7\n\n\ncanariensis\n20.6\n\n\ncanariensis\n25.4\n\n\ncanariensis\n20.4\n\n\ncanariensis\n21.6\n\n\ncanariensis\n17.0\n\n\ncanariensis\n26.4\n\n\ncanariensis\n20.4\n\n\ncanariensis\n24.7\n\n\ncanariensis\n21.8\n\n\ncanariensis\n23.4\n\n\ncanariensis\n24.4\n\n\ncanariensis\n21.0\n\n\ncanariensis\n23.4\n\n\ncanariensis\n20.5\n\n\ncanariensis\n21.4\n\n\ncanariensis\n21.5\n\n\ncanariensis\n23.7\n\n\ncanariensis\n23.4\n\n\ncanariensis\n21.8\n\n\n\n\n\n\n\nThese data are in tidy format (Wickham 2014) - all the mass values mass are in one column with another column indicating the subspecies. This means they are well formatted for analysis and plotting.\nIn the first instance it is sensible to create a rough plot of our data. This is to give us an overview and help identify if there are any issues like missing or extreme values. It also gives us idea what we are expecting from the analysis which will make it easier for us to identify if we make some mistake in applying that analysis.\nViolin plots(geom_violin()), box plots (geom_boxplot()) or scatter plots (geom_point()) all make good choices for exploratory plotting and it does not matter which of these you choose.\n\nggplot(data = chaff,\n       aes(x = subspecies, y = mass)) +\n  geom_boxplot()\n\n\n\n\nR will order the groups alphabetically by default.\nThe figure suggests that the canariensis group is heavier than the coelebs group.\nSummarising the data for each subspecies group is the next sensible step. The most useful summary statistics are the means, standard deviations, sample sizes and standard errors. I recommend the the group_by() and summarise() approach:\n\nchaff_summary &lt;- chaff |&gt; \n  group_by(subspecies) |&gt; \n  summarise(mean = mean(mass),\n            std = sd(mass),\n            n = length(mass),\n            se = std/sqrt(n))\n\nWe have save the results to chaff_summary so that we can use the means and standard errors in our plot later.\n\nchaff_summary\n## # A tibble: 2 √ó 5\n##   subspecies   mean   std     n    se\n##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;\n## 1 canariensis  22.3  2.15    20 0.481\n## 2 coelebs      20.5  2.14    20 0.478\n\n\n13.2.1.2 Apply lm()\n\nWe can create a two-sample model like this:\n\nmod &lt;- lm(data = chaff, mass ~ subspecies)\n\nAnd examine the model with:\n\nsummary(mod)\n## \n## Call:\n## lm(formula = mass ~ subspecies, data = chaff)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -5.2750 -1.7000 -0.3775  1.6200  4.1250 \n## \n## Coefficients:\n##                   Estimate Std. Error t value Pr(&gt;|t|)    \n## (Intercept)        22.2750     0.4795  46.456   &lt;2e-16 ***\n## subspeciescoelebs  -1.7950     0.6781  -2.647   0.0118 *  \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 2.144 on 38 degrees of freedom\n## Multiple R-squared:  0.1557, Adjusted R-squared:  0.1335 \n## F-statistic: 7.007 on 1 and 38 DF,  p-value: 0.01175\n\nThe Estimates in the Coefficients table give:\n\n(Intercept) which is the mean of the canariensis group (Figure¬†13.1). Just as the intercept is the value of the y (the response) when the value of x (the explanatory) is zero in a simple linear regression, this is the value of mass when the subspecies is at its first level. The order of the levels is alphabetical by default.\nsubspeciescoelebs is what needs to be added to the mean of the canariensis group to get the mean of the coelebs group (Figure¬†13.1). Just as the slope is amount of y you add for each unit of x in a simple linear regression, this is the amount of mass that needs to be added when the subspecies goes from its first level to its second level (i.e., one unit). subspeciescoelebs is negative so the the coelebs group mean is lower than the canariensis group mean\n\nThe p-values on each line are tests of whether that coefficient is different from zero. Thus it is:\nsubspeciescoelebs  -1.7950     0.6781  -2.647   0.0118 *\nthat tells us the difference between the means is significant.\nThe F value and p-value in the last line are a test of whether the model as a whole explains a significant amount of variation in the response variable. For a two-sample test, just like a regression this is exactly equivalent to the test of the slope against zero and the two p-values will be the same.\n\n\n\n\nFigure¬†13.1: Note that y axis starts at 15 to create more space for the annotations.\n\n\n\n\n13.2.2 Check assumptions\nCheck the assumptions: All t-tests assume the ‚Äúresiduals‚Äù are normally distributed and have homogeneity of variance.\nFirst use common sense: mass is a continuous and we would expect it to be normally distributed thus we would expect the residuals to be normally distributed\nSecond by plotting residuals:\n\nplot(mod, which = 1)\n\n\n\n\n\nggplot(mapping = aes(x = mod$residuals)) + \n  geom_histogram(bins = 10)\n\n\n\n\n\nshapiro.test(mod$residuals)\n## \n##  Shapiro-Wilk normality test\n## \n## data:  mod$residuals\n## W = 0.98046, p-value = 0.7067\n\nChecking the assumptions: normally distributed residuals\n\nVariance is about the same for all values of x\nLooks roughly normal, symmetrical\ntest with shapiro. is NS. note that not significant means not significantly different from a normal distribution. It does not mean definitely normally distributed\n\n13.2.3 Report\nCanariensis chaffinches (\\(\\bar{x} \\pm s.e: 22.48 \\pm 0.48\\)) are significantly heavier than Coelebs (\\(20.28 \\pm 0.48\\) ) (t = 2.65; d.f. = 38; p = 0.012). See Figure¬†13.2.\n\nggplot() +\n  geom_point(data = chaff, aes(x = subspecies, y = mass),\n             position = position_jitter(width = 0.1, height = 0),\n             colour = \"gray50\") +\n  geom_errorbar(data = chaff_summary, \n                aes(x = subspecies, ymin = mean - se, ymax = mean + se),\n                width = 0.3) +\n  geom_errorbar(data = chaff_summary, \n                aes(x = subspecies, ymin = mean, ymax = mean),\n                width = 0.2) +\n  scale_y_continuous(name = \"Mass (g)\", \n                     limits = c(0, 30), \n                     expand = c(0, 0)) +\n  scale_x_discrete(name = \"Subspecies\", \n                   labels = c(\"Canariensis\", \"Coelebs\")) +\n  theme_classic()\n\n\n\nFigure¬†13.2: Mass of two subspecies of chaffinch. Errors bars are ¬± 1 s.e.\n\n\n\n\n13.2.4 Two independent samples example non-parametric\nThe two sample Wilcoxon also known as the Mann-Whitney. the type of question is the same but the response variable is not continuous or the residuals are not normally distributed or the sample size is too small to tell if they are normally distributed.\nExample: comparing the number of leaves on 8 mutant and wild type arabidopsis plants (small samples, counts)\n\n13.2.5 import and explore\n\narabidopsis &lt;- read_table(\"data-raw/arabidopsis.txt\")\n\nPlot your data roughly - violin, points, boxplot\n\nggplot(data = arabidopsis, \n       aes(x = type, y = leaves)) +\n  geom_boxplot()\n\n\n\n\nSummarise\n\narabidopsis_summary &lt;- arabidopsis |&gt; \n  group_by(type) |&gt; \n  summarise(median = median(leaves),\n            n = length(leaves))\n\n\n13.2.6 test\n\nwilcox.test(data = arabidopsis, leaves ~ type)\n## \n##  Wilcoxon rank sum test with continuity correction\n## \n## data:  leaves by type\n## W = 5, p-value = 0.005051\n## alternative hypothesis: true location shift is not equal to 0\n\nWarning message: In wilcox.test.default(x = c(3, 5, 6, 7, 3, 4, 5, 8), y = c(8, 9, :cannot compute exact p-value with ties\n\n13.2.7 report\nThere are significantly more leaves on wild-type (median = 8.5) than mutant (median = 5) plants (Mann-Whitney: W=5, n1 = 8, n2 = 8, p = 0.005)\nillustrate\nbox plot"
  },
  {
    "objectID": "two_sample_tests.html#two-paired-samples-example-parametric",
    "href": "two_sample_tests.html#two-paired-samples-example-parametric",
    "title": "\n13¬† Two-Sample tests\n",
    "section": "\n13.3 Two paired samples example parametric",
    "text": "13.3 Two paired samples example parametric\nIs there a difference between the maths and stats marks of 10 students?\n\n13.3.1 import and explore\n\nmarks &lt;- read_table(\"data-raw/marks.txt\")\n\nPlot your data roughly\n\nggplot(data = marks, aes(x = subject, y = mark)) +\n  geom_point() +\n  geom_line(aes(group = student))\n\n\n\n\n\nmarks_wide &lt;- marks |&gt; \n  pivot_wider(id_cols = student,\n              names_from = subject,\n              values_from = mark)\n\nSummarise\ncalculate the mean differnce and se of mean diff\n\n13.3.2 test\nhttps://steverxd.github.io/Stat_tests/one-mean.html#one-sample\n\nmod &lt;- lm(data = marks_wide, maths - stats ~ 1)\n\n\nsummary(mod)\n## \n## Call:\n## lm(formula = maths - stats ~ 1, data = marks_wide)\n## \n## Residuals:\n##    Min     1Q Median     3Q    Max \n## -12.50  -7.25   1.00   5.50  11.50 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(&gt;|t|)  \n## (Intercept)    6.500      2.778    2.34    0.044 *\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 8.784 on 9 degrees of freedom\n\n\n13.3.3 check assumptions\nnormally and homogenously distributed residuals differences\n\nggplot(marks_wide, aes(x = maths - stats)) +\n  geom_histogram(bins = 5)\n\n\n\n\n\n13.3.4 report\nIndividual students score significantly higher in maths than in statistics (t = 2.34; d.f. = 9; p = 0.044) with an average difference of 6.5%.\nspaghetti plot"
  },
  {
    "objectID": "two_sample_tests.html#two-paired-samples-example-non-parametric",
    "href": "two_sample_tests.html#two-paired-samples-example-non-parametric",
    "title": "\n13¬† Two-Sample tests\n",
    "section": "\n13.4 Two paired samples example non-parametric",
    "text": "13.4 Two paired samples example non-parametric\nmaths and stats marks\n\n13.4.1 test\n\n13.4.2 report\n\n13.4.3 illustrate\n\n\n\n\nWickham, Hadley. 2014. ‚ÄúTidy Data.‚Äù Journal of Statistical Software, Articles 59 (10): 1‚Äì23. https://vita.had.co.nz/papers/tidy-data.pdf."
  }
]