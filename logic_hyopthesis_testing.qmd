# The logic of hyothesis testing
```{r}
#| results: "asis"
#| echo: false

source("_common.R")
status("drafting")
```

## Why do we do statistical testing?


## Samples and populations


## Sampling distributions


## Logic of hypothesis testing

null hypothesis What you expect to happen if nothing
interesting biologically is occurring.
Hypothesis testing is a statistical technique used to make inferences or draw conclusions about a population based on sample data. The process involves formulating two competing hypotheses, the null hypothesis (H0) and the alternative hypothesis (H1), and evaluating the evidence in the sample data to determine which hypothesis is more likely.

The logic behind hypothesis testing follows these general steps:

Formulating the hypotheses:

Null Hypothesis (H0): It represents the default assumption or the status quo. It states that there is no significant difference or relationship between variables or no effect of a treatment.
Alternative Hypothesis (H1): It contradicts the null hypothesis and states that there is a significant difference or relationship between variables or an effect of a treatment.
Choosing a significance level (α):

The significance level, denoted by α, is the probability of rejecting the null hypothesis when it is actually true. It determines the threshold for accepting or rejecting the null hypothesis.
Commonly used significance levels are 0.05 (5%) or 0.01 (1%). A lower significance level implies stronger evidence required to reject the null hypothesis.
Collecting and analyzing sample data:

Data is collected through experiments or sampling methods.
Descriptive statistics are computed to summarize the sample data, such as means, standard deviations, etc.
Applying a statistical test:

A specific statistical test is selected based on the nature of the data and the research question.
The choice of test depends on factors like the type of data (continuous or categorical), number of groups being compared, and assumptions about the data distribution.
Calculating test statistics and p-value:

The test statistic is calculated based on the sample data and the chosen statistical test.
The p-value is the probability of observing a test statistic as extreme as, or more extreme than, the one calculated, assuming the null hypothesis is true.
The p-value quantifies the strength of evidence against the null hypothesis. A smaller p-value suggests stronger evidence against the null hypothesis.
Comparing p-value to the significance level:

If the p-value is less than the chosen significance level (p-value < α), it is considered statistically significant.
In such cases, the null hypothesis is rejected in favor of the alternative hypothesis. It suggests that the observed effect or difference is unlikely to be due to random chance.
Interpreting the results:

If the null hypothesis is rejected, it implies that there is evidence to support the alternative hypothesis.
If the null hypothesis is not rejected, it means there is insufficient evidence to support the alternative hypothesis, and we fail to reject the null hypothesis.
It's important to note that hypothesis testing does not prove the truth of a hypothesis, but rather provides evidence either supporting or contradicting it based on the available data. The process helps in making informed decisions and drawing conclusions about populations based on sample information.

$H_0$

alternative hypothesis $H_1$

reject or not reject


### Hypothesis Testing: steps

1.  Set up H0 “no effect”

2.  Design experiment to test null hypothesis and collect data

3.  Determine the probability of our data if H0 is true

4.  Decide whether to reject or not reject the H0 based on that probability p ≤ 0.05 reject H0; p > 0.05 do not reject H0


### Example

Question: Does this fertiliser increase the crop yield?

1.  Set up the null hypothesis
    There is no difference between the mass of plants grown with fertiliser, $\bar{x_f}$, and the mass of the plants grown without fertiliser, $\bar{x_c}$.


```{r}
#| echo: false
#| label: fig-null-hyp-crop-fert
#| fig-cap: "The null hypothesis is that the mean of the plants grown with fertiliser is the same as those grown without fertiliser (the control)."

m <- 250
sd <- 40
ggplot(data = data.frame(mass = rep(c(m - 3 * sd, m + 3 * sd), times = 2),
                         treatment = c("control", "control", "fertiliser", "fertiliser")),
       aes(mass)) +
  stat_function(fun = dnorm, n = 101, 
                args = list(mean = m, sd = sd)) +
  geom_vline(xintercept = m) +
  scale_y_continuous(breaks = NULL, name = "",
                     expand = c(0, 0)) +
  scale_x_continuous(breaks = c(50, 100, 150, 200, 250, 300, 350, 400),
                     expand = c(0, 0)) + 
  annotate("text", x = 175, y = 0.0075, label = glue::glue("mean = {m}")) +
  facet_wrap(. ~ treatment, nrow = 2, scales = "free") +
  theme_classic() +
  theme(strip.background = element_blank(),
        strip.text = element_text(size = 14))
```


$H_0 : \bar{x_f} -\bar{x_c} = 0$.


### Type 1 and type 2 errors